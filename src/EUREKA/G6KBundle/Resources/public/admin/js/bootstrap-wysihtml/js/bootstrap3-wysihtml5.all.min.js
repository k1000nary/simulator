/*
 wysihtml v0.6.0-beta1
 https://github.com/Voog/wysihtml

 Author: Christopher Blum (https://github.com/tiff)
 Secondary author of extended features: Oliver Pulges (https://github.com/pulges)

 Copyright (C) 2012 XING AG
 Licensed under the MIT license (MIT)

*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,b){a instanceof String&&(a=String(a));for(var g=a.length,h=0;h<g;h++){var f=a[h];if(e.call(b,f,h,a))return{i:h,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,b){a!=Array.prototype&&a!=Object.prototype&&(a[e]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,b,g){if(e){b=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var h=a[g];h in b||(b[h]={});b=b[h]}a=a[a.length-1];g=b[a];e=e(g);e!=g&&null!=e&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var e=0;return $jscomp.iteratorPrototype(function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,e){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,g={next:function(){if(b<a.length){var h=b++;return{value:e(h,a[h]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var wysihtml={version:"0.6.0-beta1",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},editorExtenders:[],extendEditor:function(a){this.editorExtenders.push(a)},INVISIBLE_SPACE:"\ufeff",INVISIBLE_SPACE_REG_EXP:/\uFEFF/g,VOID_ELEMENTS:"area, base, br, col, embed, hr, img, input, keygen, link, meta, param, source, track, wbr",PERMITTED_PHRASING_CONTENT_ONLY:"h1, h2, h3, h4, h5, h6, p, pre",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,
SPACE_KEY:32,TAB_KEY:9,DELETE_KEY:46,polyfills:function(a,e){var b={normalizeHasCaretError:function(){if("createRange"in e&&"getSelection"in a){var b=window.pageYOffset,h=window.pageXOffset,f=e.createElement("div"),d=e.createTextNode("a"),k=e.createTextNode("a"),l=e.createTextNode("a"),n=e.createRange(),m;if(document.activeElement)if(1===document.activeElement.nodeType&&-1<["INPUT","TEXTAREA","SELECT","BUTTON"].indexOf(document.activeElement.nodeName))var p={type:"form",node:document.activeElement,
start:document.activeElement.selectionStart,end:document.activeElement.selectionEnd};else(m=a.getSelection())&&m.anchorNode&&(p={type:"range",anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset});f.setAttribute("contenteditable","true");f.appendChild(d);f.appendChild(k);f.appendChild(l);e.body.appendChild(f);n.setStart(k,1);n.setEnd(k,1);m=a.getSelection();m.removeAllRanges();m.addRange(n);f.normalize();m=a.getSelection();d=1!==f.childNodes.length||
m.anchorNode!==f.firstChild||2!==m.anchorOffset;f.parentNode.removeChild(f);m.removeAllRanges();p&&("form"===p.type?("undefined"!==typeof p.start&&"undefined"!==typeof p.end&&p.node.setSelectionRange(p.start,p.end),p.node.focus()):"range"===p.type&&(n=e.createRange(),n.setStart(p.anchorNode,p.anchorOffset),n.setEnd(p.focusNode,p.focusOffset),m.addRange(n)));b===window.pageYOffset&&h===window.pageXOffset||a.scrollTo(h,b);return d}},apply:function(){function g(){try{var d=new a.CustomEvent("cat",{detail:{foo:"bar"}});
return"cat"===d.type&&"bar"===d.detail.foo}catch(l){}return!1}(function(a){a.matches=a.matches||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var d=0;a[d]&&a[d]!==this;)++d;return a[d]?!0:!1};a.closest=a.closest||function(a){for(var d=this;d&&!d.matches(a);)d=d.parentElement;return d};a.remove=a.remove||function(){this.parentNode&&this.parentNode.removeChild(this)}})(a.Element.prototype);
"classList"in e.documentElement||!a.Object.defineProperty||"undefined"===typeof a.HTMLElement||a.Object.defineProperty(a.HTMLElement.prototype,"classList",{get:function(){function d(a){return function(d){var f=b.className.split(/\s+/),k=f.indexOf(d);a(f,k,d);b.className=f.join(" ")}}var b=this,f={add:d(function(a,d,b){~d||a.push(b)}),remove:d(function(a,d){~d&&a.splice(d,1)}),toggle:d(function(a,d,b){~d?a.splice(d,1):a.push(b)}),contains:function(a){return!!~b.className.split(/\s+/).indexOf(a)},item:function(a){return b.className.split(/\s+/)[a]||
null}};a.Object.defineProperty(f,"length",{get:function(){return b.className.split(/\s+/).length}});return f}});var h=function(a){var d=[];for(a=a.firstChild;a;a=a.nextSibling)3==a.nodeType?d.push(a):d=d.concat(h(a));return d},f=function(){a.Node.prototype.normalize=function(){var d=h(this),b=this.ownerDocument.defaultView.getSelection(),f=b.anchorNode,e=b.anchorOffset,g=f&&1===f.nodeType&&0<f.childNodes.length?f.childNodes[e]:void 0,q=b.focusNode,x=b.focusOffset,y=q&&1===q.nodeType&&0<x?q.childNodes[x-
1]:void 0,w=this.ownerDocument.createRange(),B=d.shift(),C=B?d.shift():null;y&&3===y.nodeType&&(q=y,x=y.nodeValue.length,y=void 0);g&&3===g.nodeType&&(f=g,e=0,g=void 0);if(f===q&&x<e||f!==q&&f.compareDocumentPosition(q)&a.Node.DOCUMENT_POSITION_PRECEDING&&!(f.compareDocumentPosition(q)&a.Node.DOCUMENT_POSITION_CONTAINS))q=[f,f=q][0],x=[e,e=x][0];for(;B&&C;)C.previousSibling&&C.previousSibling===B?(f===C&&(f=B,e=B.nodeValue.length+e),q===C&&(q=B,x=B.nodeValue.length+x),B.nodeValue+=C.nodeValue,C.parentNode.removeChild(C)):
B=C,C=d.shift();y&&(x=Array.prototype.indexOf.call(y.parentNode.childNodes,y)+1);g&&(e=Array.prototype.indexOf.call(g.parentNode.childNodes,g));a:{d=this.ownerDocument;g=this;do{if(g===d){d=!0;break a}g=g.parentNode}while(g);d=!1}d&&f&&f.parentNode&&q&&q.parentNode&&(w.setStart(f,e),w.setEnd(q,x),b.removeAllRanges(),b.addRange(w))}},d=function(){a.removeEventListener("load",d);"Node"in a&&"normalize"in a.Node.prototype&&b.normalizeHasCaretError()&&f()};"complete"!==e.readyState?a.addEventListener("load",
d):d();(function(){if(!g()&&"CustomEvent"in a){var d=function(a,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var b=e.createEvent("CustomEvent");b.initCustomEvent(a,d.bubbles,d.cancelable,d.detail);return b};d.prototype=a.Event.prototype;a.CustomEvent=d}})()}};return b}};wysihtml.polyfills(window,document).apply();var Base=function(){};
Base.extend=function(a,e){var b=Base.prototype.extend;Base._prototyping=!0;var g=new this;b.call(g,a);g.base=function(){};delete Base._prototyping;var h=g.constructor,f=g.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==f)this._constructing=!0,h.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||b).call(arguments[0],g)};f.ancestor=this;f.extend=this.extend;f.forEach=this.forEach;f.implement=this.implement;f.prototype=
g;f.toString=this.toString;f.valueOf=function(a){return"object"==a?f:h.valueOf()};b.call(f,e);"function"==typeof f.init&&f.init();return f};
Base.prototype={extend:function(a,e){if(1<arguments.length){var b=this[a];if(b&&"function"==typeof e&&(!b.valueOf||b.valueOf()!=e.valueOf())&&/\bbase\b/.test(e)){var g=e.valueOf();e=function(){var a=this.base||Base.prototype.base;this.base=b;var d=g.apply(this,arguments);this.base=a;return d};e.valueOf=function(a){return"object"==a?e:g};e.toString=Base.toString}this[a]=e}else if(a){var h=Base.prototype.extend;Base._prototyping||"function"==typeof this||(h=this.extend||h);for(var f={toSource:null},
d=["constructor","toString","valueOf"],k=Base._prototyping?0:1;l=d[k++];)a[l]!=f[l]&&h.call(this,l,a[l]);for(var l in a)f[l]||h.call(this,l,a[l])}return this}};
Base=Base.extend({constructor:function(a){this.extend(a)}},{ancestor:Object,version:"1.1",forEach:function(a,e,b){for(var g in a)void 0===this.prototype[g]&&e.call(b,a[g],g,a)},implement:function(){for(var a=0;a<arguments.length;a++)if("function"==typeof arguments[a])arguments[a](this.prototype);else this.prototype.extend(arguments[a]);return this},toString:function(){return String(this.valueOf())}});var rangy;
(function(){function a(a,d){var b=typeof a[d];return"function"==b||!("object"!=b||!a[d])||"unknown"==b}function e(a,d){return!("object"!=typeof a[d]||!a[d])}function b(a,d){return"undefined"!=typeof a[d]}function g(a){return function(d,b){for(var f=b.length;f--;)if(!a(d,b[f]))return!1;return!0}}function h(a){return a&&D(a,H)&&z(a,C)}function f(a){return e(a,"body")?a.body:a.getElementsByTagName("body")[0]}function d(d){"undefined"!=typeof console&&a(console,"log")&&console.log(d)}function k(a){v.initialized=
!0;v.supported=!1;a="Rangy is not supported in this environment. Reason: "+a;K&&v.config.alertOnFail?alert(a):d(a)}function l(){if(K&&!v.initialized){var b=!1,e=!1;if(a(document,"createRange")){var g=document.createRange();D(g,B)&&z(g,w)&&(b=!0)}if((g=f(document))&&"body"==g.nodeName.toLowerCase())if(g&&a(g,"createTextRange")&&(g=g.createTextRange(),h(g)&&(e=!0)),b||e){v.initialized=!0;v.features={implementsDomRange:b,implementsTextRange:e};var l,n;for(n in A)(l=A[n])instanceof q&&l.init(l,v);e=0;
for(l=r.length;e<l;++e)try{r[e](v)}catch(X){b="Rangy init listener threw an exception. Continuing. Detail: "+(X.message||X.description||String(X)),d(b)}}else k("Neither Range nor TextRange are available");else k("No body element found")}}function n(a,d,b){b&&(a+=" in module "+b.name);v.warn("DEPRECATED: "+a+" is deprecated. Please use "+d+" instead.")}function m(a,d,b,f){a[d]=function(){n(d,b,f);return a[b].apply(a,E.toArray(arguments))}}function p(a){a=a||window;l();for(var d=0,b=L.length;d<b;++d)L[d](a)}
function q(a,d,b){this.name=a;this.dependencies=d;this.supported=this.initialized=!1;this.initializer=b}function x(a,b,f){b=new q(a,b,function(b){if(!b.initialized){b.initialized=!0;try{f(v,b),b.supported=!0}catch(W){d("Module '"+a+"' failed to load: "+(W.message||W.description||String(W))),W.stack&&d(W.stack)}}});return A[a]=b}function y(){}var w="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),B="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
C="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),H="collapse compareEndPoints duplicate moveToElementText parentElement select setEndPoint getBoundingClientRect".split(" "),D=g(a),t=g(e),z=g(b),A={},K="undefined"!=typeof window&&"undefined"!=typeof document,E={isHostMethod:a,isHostObject:e,isHostProperty:b,areHostMethods:D,areHostObjects:t,areHostProperties:z,isTextRange:h,getBody:f,forEach:[].forEach?function(a,d){a.forEach(d)}:function(a,d){for(var b=0,f=a.length;b<
f;++b)d(a[b],b)}},v={version:"1.3.1-dev",initialized:!1,isBrowser:K,supported:!0,util:E,features:{},modules:A,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:"undefined"==typeof rangyAutoInitialize?!0:rangyAutoInitialize}};v.fail=k;v.warn=function(a){a="Rangy warning: "+a;K&&v.config.alertOnWarn?alert(a):d(a)};var I;({}).hasOwnProperty?(E.extend=I=function(a,d,b){var f;for(f in d)if(d.hasOwnProperty(f)){var e=a[f];var k=d[f];b&&null!==e&&"object"==typeof e&&null!==k&&"object"==
typeof k&&I(e,k,!0);a[f]=k}d.hasOwnProperty("toString")&&(a.toString=d.toString);return a},E.createOptions=function(a,d){var b={};I(b,d);a&&I(b,a);return b}):k("hasOwnProperty not supported");K||k("Rangy can only run in a browser");(function(){var a;if(K){var d=document.createElement("div");d.appendChild(document.createElement("span"));var b=[].slice;try{1==b.call(d.childNodes,0)[0].nodeType&&(a=function(a){return b.call(a,0)})}catch(la){}}a||(a=function(a){for(var d=[],b=0,f=a.length;b<f;++b)d[b]=
a[b];return d});E.toArray=a})();var G;K&&(a(document,"addEventListener")?G=function(a,d,b){a.addEventListener(d,b,!1)}:a(document,"attachEvent")?G=function(a,d,b){a.attachEvent("on"+d,b)}:k("Document does not have required addEventListener or attachEvent method"),E.addListener=G);var r=[];E.deprecationNotice=n;E.createAliasForDeprecatedMethod=m;v.init=l;v.addInitListener=function(a){v.initialized?a(v):r.push(a)};var L=[];v.addShimListener=function(a){L.push(a)};K&&(v.shim=v.createMissingNativeApi=
p,m(v,"createMissingNativeApi","shim"));q.prototype={init:function(){for(var a=this.dependencies||[],d=0,b=a.length,f,e;d<b;++d){e=a[d];f=A[e];if(!(f&&f instanceof q))throw Error("required module '"+e+"' not found");f.init();if(!f.supported)throw Error("required module '"+e+"' not supported");}this.initializer(this)},fail:function(a){this.initialized=!0;this.supported=!1;throw Error(a);},warn:function(a){v.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,d){v.warn("DEPRECATED: "+a+" in module "+
this.name+" is deprecated. Please use "+d+" instead")},createError:function(a){return Error("Error in Rangy "+this.name+" module: "+a)}};v.createModule=function(a){if(2==arguments.length){var d=arguments[1];var b=[]}else d=arguments[2],b=arguments[1];d=x(a,b,d);v.initialized&&v.supported&&d.init()};v.createCoreModule=function(a,d,b){x(a,d,b)};v.RangePrototype=y;v.rangePrototype=new y;v.selectionPrototype=new function(){};v.createCoreModule("DomUtil",[],function(a,d){function b(a){for(var d=0;a=a.previousSibling;)++d;
return d}function f(a,d){for(var b=[];a;a=a.parentNode)b.push(a);for(a=d;a;a=a.parentNode)if(E(b,a))return a;return null}function e(a,d,b){for(d=b?d:d.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function k(a,d,b){for(b=b?a:a.parentNode;b;){a=b.parentNode;if(a===d)return b;b=a}return null}function g(a){a=a.nodeType;return 3==a||4==a||8==a}function h(a,d){var b=d.nextSibling;d=d.parentNode;b?d.insertBefore(a,b):d.appendChild(a);return a}function l(a){if(9==a.nodeType)return a;if("undefined"!=
typeof a.ownerDocument)return a.ownerDocument;if("undefined"!=typeof a.document)return a.document;if(a.parentNode)return l(a.parentNode);throw d.createError("getDocument: no document found for node");}function n(a){a=l(a);if("undefined"!=typeof a.defaultView)return a.defaultView;if("undefined"!=typeof a.parentWindow)return a.parentWindow;throw d.createError("Cannot get a window object for node");}function A(a){if("undefined"!=typeof a.contentDocument)return a.contentDocument;if("undefined"!=typeof a.contentWindow)return a.contentWindow.document;
throw d.createError("getIframeDocument: No Document object found for iframe element");}function m(a){return a&&p.isHostMethod(a,"setTimeout")&&p.isHostObject(a,"document")}function u(a){return a?g(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">[index:"+b(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]":a.nodeName:"[No node]"}function t(a){this._next=this.root=a}function z(a,d){this.node=a;this.offset=d}function S(a){this.code=
this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var p=a.util,K=p.getBody;p.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||d.fail("document missing a Node creation method");p.isHostMethod(document,"getElementsByTagName")||d.fail("document missing getElementsByTagName method");var D=document.createElement("div");p.areHostMethods(D,["insertBefore","appendChild","cloneNode"])||d.fail("Incomplete Element implementation");p.isHostProperty(D,"innerHTML")||
d.fail("Element is missing innerHTML property");D=document.createTextNode("test");p.areHostMethods(D,["splitText","deleteData","insertData","appendData","cloneNode"])||d.fail("Incomplete Text Node implementation");var E=function(a,d){for(var b=a.length;b--;)if(a[b]===d)return!0;return!1},v=!1;(function(){var d=document.createElement("b");d.innerHTML="1";d.innerHTML="<br />";v=!1;a.features.crashyTextNodes=v})();var q;"undefined"!=typeof window.getComputedStyle?q=function(a,d){return n(a).getComputedStyle(a,
null)[d]}:"undefined"!=typeof document.documentElement.currentStyle?q=function(a,d){return a.currentStyle?a.currentStyle[d]:""}:d.fail("No means of obtaining computed style properties found");t.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next,d;if(this._current)if(d=a.firstChild)this._next=d;else{for(d=null;a!==this.root&&!(d=a.nextSibling);)a=a.parentNode;this._next=d}return this._current},detach:function(){this._current=this._next=this.root=
null}};z.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+u(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};S.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};S.prototype.toString=function(){return this.message};a.dom={arrayContains:E,isHtmlNamespace:function(a){var d;
return"undefined"==typeof a.namespaceURI||null===(d=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==d},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:b,getNodeLength:function(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}},getCommonAncestor:f,isAncestorOf:e,isOrIsAncestorOf:function(a,d){return e(a,d,!0)},getClosestAncestorIn:k,isCharacterDataNode:g,isTextOrCommentNode:function(a){if(!a)return!1;
a=a.nodeType;return 3==a||8==a},insertAfter:h,splitDataNode:function(a,d,f){var e=a.cloneNode(!1);e.deleteData(0,d);a.deleteData(d,a.length-d);h(e,a);if(f)for(var k=0,g;g=f[k++];)g.node==a&&g.offset>d?(g.node=e,g.offset-=d):g.node==a.parentNode&&g.offset>b(a)&&++g.offset;return e},getDocument:l,getWindow:n,getIframeWindow:function(a){if("undefined"!=typeof a.contentWindow)return a.contentWindow;if("undefined"!=typeof a.contentDocument)return a.contentDocument.defaultView;throw d.createError("getIframeWindow: No Window object found for iframe element");
},getIframeDocument:A,getBody:K,isWindow:m,getContentDocument:function(a,d,b){if(a)p.isHostProperty(a,"nodeType")?f=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?A(a):l(a):m(a)&&(f=a.document);else var f=document;if(!f)throw d.createError(b+"(): Parameter must be a Window object or DOM node");return f},getRootContainer:function(a){for(var d;d=a.parentNode;)a=d;return a},comparePoints:function(a,e,g,h){var l;if(a==g)return e===h?0:e<h?-1:1;if(l=k(g,a,!0))return e<=b(l)?-1:1;if(l=k(a,g,!0))return b(l)<
h?-1:1;e=f(a,g);if(!e)throw Error("comparePoints error: nodes have no common ancestor");a=a===e?e:k(a,e,!0);g=g===e?e:k(g,e,!0);if(a===g)throw d.createError("comparePoints got to case 4 and childA and childB are the same!");for(e=e.firstChild;e;){if(e===a)return-1;if(e===g)return 1;e=e.nextSibling}},isBrokenNode:function(a){return!1},inspectNode:u,getComputedStyleProperty:q,createTestElement:function(a,d,b){var f=K(a);a=a.createElement("div");a.contentEditable=""+!!b;d&&(a.innerHTML=d);(d=f.firstChild)?
f.insertBefore(a,d):f.appendChild(a);return a},removeNode:function(a){return a.parentNode.removeChild(a)},fragmentFromNodeChildren:function(a){for(var d=l(a).createDocumentFragment(),b;b=a.firstChild;)d.appendChild(b);return d},createIterator:function(a){return new t(a)},DomPosition:z};a.DOMException=S});v.createCoreModule("DomRange",["DomUtil"],function(a,d){function b(a,d){return 3!=a.nodeType&&(M(a,d.startContainer)||M(a,d.endContainer))}function f(a){return a.document||L(a.startContainer)}function e(a){return new P(a.parentNode,
F(a))}function k(a){return new P(a.parentNode,F(a)+1)}function g(a,d,b){var f=11==a.nodeType?a.firstChild:a;J(d)?b==d.length?r.insertAfter(a,d):d.parentNode.insertBefore(a,0==b?d:ca(d,b)):b>=d.childNodes.length?d.appendChild(a):d.insertBefore(a,d.childNodes[b]);return f}function h(a,d,b){I(a);I(d);if(f(d)!=f(a))throw new R("WRONG_DOCUMENT_ERR");var e=O(a.startContainer,a.startOffset,d.endContainer,d.endOffset);a=O(a.endContainer,a.endOffset,d.startContainer,d.startOffset);return b?0>=e&&0<=a:0>e&&
0<a}function l(a){for(var d,b,e=f(a.range).createDocumentFragment();b=a.next();){d=a.isPartiallySelectedSubtree();b=b.cloneNode(!d);d&&(d=a.getSubtreeIterator(),b.appendChild(l(d)),d.detach());if(10==b.nodeType)throw new R("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function n(a,d,b){var f,e;for(b=b||{stop:!1};f=a.next();)if(a.isPartiallySelectedSubtree())if(!1===d(f)){b.stop=!0;break}else{if(f=a.getSubtreeIterator(),n(f,d,b),f.detach(),b.stop)break}else for(f=r.createIterator(f);e=f.next();)if(!1===
d(e)){b.stop=!0;return}}function A(a){for(var d;a.next();)a.isPartiallySelectedSubtree()?(d=a.getSubtreeIterator(),A(d),d.detach()):a.remove()}function m(a){for(var d,b=f(a.range).createDocumentFragment(),e;d=a.next();){a.isPartiallySelectedSubtree()?(d=d.cloneNode(!1),e=a.getSubtreeIterator(),d.appendChild(m(e)),e.detach()):a.remove();if(10==d.nodeType)throw new R("HIERARCHY_REQUEST_ERR");b.appendChild(d)}return b}function u(a,d,b){var f=!(!d||!d.length),e,k=!!b;f&&(e=new RegExp("^("+d.join("|")+
")$"));var g=[];n(new z(a,!1),function(d){if(!f||e.test(d.nodeType))if(!k||b(d)){var h=a.startContainer;d==h&&J(h)&&a.startOffset==h.length||(h=a.endContainer,d==h&&J(h)&&0==a.endOffset||g.push(d))}});return g}function t(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+r.inspectNode(a.startContainer)+":"+a.startOffset+", "+r.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function z(a,d){this.range=a;this.clonePartiallySelectedTextNodes=d;a.collapsed||(this.sc=a.startContainer,
this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset,a=a.commonAncestorContainer,this.sc===this.ec&&J(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==a||J(this.sc)?ha(this.sc,a,!0):this.sc.childNodes[this.so],this._last=this.ec!==a||J(this.ec)?ha(this.ec,a,!0):this.ec.childNodes[this.eo-1]))}function p(a){return function(d,b){for(b=b?d:d.parentNode;b;){d=b.nodeType;if(U(a,d))return b;b=b.parentNode}return null}}function K(a,
d){if(za(a,d))throw new R("INVALID_NODE_TYPE_ERR");}function D(a,d){if(!U(d,a.nodeType))throw new R("INVALID_NODE_TYPE_ERR");}function E(a,d){if(0>d||d>(J(a)?a.length:a.childNodes.length))throw new R("INDEX_SIZE_ERR");}function v(a,d){if(Fa(a,!0)!==Fa(d,!0))throw new R("WRONG_DOCUMENT_ERR");}function q(a){if(Ja(a,!0))throw new R("NO_MODIFICATION_ALLOWED_ERR");}function C(a,d){return d<=(J(a)?a.length:a.childNodes.length)}function x(a){return!!a.startContainer&&!!a.endContainer&&!(ia&&(r.isBrokenNode(a.startContainer)||
r.isBrokenNode(a.endContainer)))&&T(a.startContainer)==T(a.endContainer)&&C(a.startContainer,a.startOffset)&&C(a.endContainer,a.endOffset)}function I(a){if(!x(a))throw Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+a.inspect()+")");}function y(a,d){I(a);var b=a.startContainer,f=a.startOffset,e=a.endContainer,k=a.endOffset,g=b===e;J(e)&&0<k&&k<e.length&&ca(e,k,d);J(b)&&0<f&&f<b.length&&(b=ca(b,f,d),g?(k-=f,e=b):e==b.parentNode&&k>=F(b)&&k++,f=0);a.setStartAndEnd(b,
f,e,k)}function Z(a){I(a);var d=a.commonAncestorContainer.parentNode.cloneNode(!1);d.appendChild(a.cloneContents());return d.innerHTML}function aa(a){a.START_TO_START=0;a.START_TO_END=1;a.END_TO_END=2;a.END_TO_START=3;a.NODE_BEFORE=0;a.NODE_AFTER=1;a.NODE_BEFORE_AND_AFTER=2;a.NODE_INSIDE=3}function ba(a){aa(a);aa(a.prototype)}function ra(a,d){return function(){I(this);var b=this.startContainer,f=this.startOffset,e=this.commonAncestorContainer,g=new z(this,!0);b!==e&&(b=ha(b,e,!0),f=k(b),b=f.node,
f=f.offset);n(g,q);g.reset();e=a(g);g.detach();d(this,b,f,b,f);return e}}function Q(d,f){function g(a,d){return function(b){D(b,ja);D(T(b),sa);b=(a?e:k)(b);(d?h:l)(this,b.node,b.offset)}}function h(a,d,b){var e=a.endContainer,k=a.endOffset;if(d!==a.startContainer||b!==a.startOffset){if(T(d)!=T(e)||1==O(d,b,e,k))e=d,k=b;f(a,d,b,e,k)}}function l(a,d,b){var e=a.startContainer,k=a.startOffset;if(d!==a.endContainer||b!==a.endOffset){if(T(d)!=T(e)||-1==O(d,b,e,k))e=d,k=b;f(a,e,k,d,b)}}var n=function(){};
n.prototype=a.rangePrototype;d.prototype=new n;B.extend(d.prototype,{setStart:function(a,d){K(a,!0);E(a,d);h(this,a,d)},setEnd:function(a,d){K(a,!0);E(a,d);l(this,a,d)},setStartAndEnd:function(){var a=arguments,d=a[0],b=a[1],e=d,k=b;switch(a.length){case 3:k=a[2];break;case 4:e=a[2],k=a[3]}f(this,d,b,e,k)},setBoundary:function(a,d,b){this["set"+(b?"Start":"End")](a,d)},setStartBefore:g(!0,!0),setStartAfter:g(!1,!0),setEndBefore:g(!0,!1),setEndAfter:g(!1,!1),collapse:function(a){I(this);a?f(this,this.startContainer,
this.startOffset,this.startContainer,this.startOffset):f(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){K(a,!0);f(this,a,0,a,da(a))},selectNode:function(a){K(a,!1);D(a,ja);var d=e(a);a=k(a);f(this,d.node,d.offset,a.node,a.offset)},extractContents:ra(m,f),deleteContents:ra(A,f),canSurroundContents:function(){I(this);q(this.startContainer);q(this.endContainer);var a=new z(this,!0),d=a._first&&b(a._first,this)||a._last&&b(a._last,this);a.detach();
return!d},splitBoundaries:function(){y(this)},splitBoundariesPreservingPositions:function(a){y(this,a)},normalizeBoundaries:function(){I(this);var a=this.startContainer,d=this.startOffset,b=this.endContainer,e=this.endOffset,k=function(a){var d=a.nextSibling;d&&d.nodeType==a.nodeType&&(b=a,e=a.length,a.appendData(d.data),V(d))},g=function(f){var k=f.previousSibling;if(k&&k.nodeType==f.nodeType){a=f;var g=f.length;d=k.length;f.insertData(0,k.data);V(k);a==b?(e+=d,b=a):b==f.parentNode&&(k=F(f),e==k?
(b=f,e=g):e>k&&e--)}},h=!0;J(b)?e==b.length?k(b):0==e&&(k=b.previousSibling)&&k.nodeType==b.nodeType&&(e=k.length,a==b&&(h=!1),k.appendData(b.data),V(b),b=k):(0<e&&(h=b.childNodes[e-1])&&J(h)&&k(h),h=!this.collapsed);h?J(a)?0==d?g(a):d==a.length&&(k=a.nextSibling)&&k.nodeType==a.nodeType&&(b==k&&(b=a,e+=a.length),a.appendData(k.data),V(k)):d<a.childNodes.length&&(k=a.childNodes[d])&&J(k)&&g(k):(a=b,d=e);f(this,a,d,b,e)},collapseToPoint:function(a,d){K(a,!0);E(a,d);this.setStartAndEnd(a,d)}});ba(d)}
function w(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:r.getCommonAncestor(a.startContainer,a.endContainer)}function H(a,d,b,f,e){a.startContainer=d;a.startOffset=b;a.endContainer=f;a.endOffset=e;a.document=r.getDocument(d);w(a)}function G(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this.document=a;w(this)}var r=a.dom,B=a.util,P=r.DomPosition,R=a.DOMException,J=r.isCharacterDataNode,
F=r.getNodeIndex,M=r.isOrIsAncestorOf,L=r.getDocument,O=r.comparePoints,ca=r.splitDataNode,ha=r.getClosestAncestorIn,da=r.getNodeLength,U=r.arrayContains,T=r.getRootContainer,ia=a.features.crashyTextNodes,V=r.removeNode;z.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,
J(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current;if(!J(a)||a!==this.sc&&a!==this.ec)a.parentNode&&V(a);else{var d=a===this.sc?this.so:0;var b=a===this.ec?this.eo:a.length;d!=b&&a.deleteData(d,b-d)}},isPartiallySelectedSubtree:function(){return b(this._current,this.range)},getSubtreeIterator:function(){if(this.isSingleCharacterDataNode){var a=
this.range.cloneRange();a.collapse(!1)}else{a=new G(f(this.range));var d=this._current,b=d,e=0,k=d,g=da(d);M(d,this.sc)&&(b=this.sc,e=this.so);M(d,this.ec)&&(k=this.ec,g=this.eo);H(a,b,e,k,g)}return new z(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var ja=[1,3,4,5,7,8,10],sa=[2,9,11],xa=[1,3,4,5,7,8,10,11],ka=[1,3,4,5,7,8],Fa=p([9,11]),Ja=p([5,6,10,12]),za=p([6,10,12]);d=document.createElement("style");
var ya=!1;try{d.innerHTML="<b>x</b>",ya=3==d.firstChild.nodeType}catch(Ka){}a.features.htmlParsingConforms=ya;var Aa="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" ");B.extend(a.rangePrototype,{compareBoundaryPoints:function(a,d){I(this);v(this.startContainer,d.startContainer);var b=3==a||0==a?"start":"end";a=1==a||0==a?"start":"end";return O(this[b+"Container"],this[b+"Offset"],d[a+"Container"],d[a+"Offset"])},insertNode:function(a){I(this);D(a,xa);
q(this.startContainer);if(M(a,this.startContainer))throw new R("HIERARCHY_REQUEST_ERR");a=g(a,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){I(this);if(this.collapsed)return f(this).createDocumentFragment();if(this.startContainer===this.endContainer&&J(this.startContainer)){var a=this.startContainer.cloneNode(!0);a.data=a.data.slice(this.startOffset,this.endOffset);var d=f(this).createDocumentFragment();d.appendChild(a);return d}d=new z(this,!0);a=l(d);d.detach();
return a},canSurroundContents:function(){I(this);q(this.startContainer);q(this.endContainer);var a=new z(this,!0),d=a._first&&b(a._first,this)||a._last&&b(a._last,this);a.detach();return!d},surroundContents:function(a){D(a,ka);if(!this.canSurroundContents())throw new R("INVALID_STATE_ERR");var d=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset);a.appendChild(d);this.selectNode(a)},cloneRange:function(){I(this);for(var a=
new G(f(this)),d=Aa.length,b;d--;)b=Aa[d],a[b]=this[b];return a},toString:function(){I(this);var a=this.startContainer;if(a===this.endContainer&&J(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var d=[];a=new z(this,!0);n(a,function(a){3!=a.nodeType&&4!=a.nodeType||d.push(a.data)});a.detach();return d.join("")},compareNode:function(a){I(this);var d=a.parentNode,b=F(a);if(!d)throw new R("NOT_FOUND_ERR");a=this.comparePoint(d,b);d=this.comparePoint(d,b+1);return 0>
a?0<d?2:0:0<d?1:3},comparePoint:function(a,d){I(this);if(!a)throw new R("HIERARCHY_REQUEST_ERR");v(a,this.startContainer);return 0>O(a,d,this.startContainer,this.startOffset)?-1:0<O(a,d,this.endContainer,this.endOffset)?1:0},createContextualFragment:ya?function(a){var d=this.startContainer,b=L(d);if(!d)throw new R("INVALID_STATE_ERR");var f=null;1==d.nodeType?f=d:J(d)&&(f=r.parentElement(d));f=null===f||"HTML"==f.nodeName&&r.isHtmlNamespace(L(f).documentElement)&&r.isHtmlNamespace(f)?b.createElement("body"):
f.cloneNode(!1);f.innerHTML=a;return r.fragmentFromNodeChildren(f)}:function(a){var d=f(this).createElement("body");d.innerHTML=a;return r.fragmentFromNodeChildren(d)},toHtml:function(){return Z(this)},intersectsNode:function(a,d){I(this);if(T(a)!=T(this.startContainer))return!1;var b=a.parentNode,f=F(a);if(!b)return!0;a=O(b,f,this.endContainer,this.endOffset);b=O(b,f+1,this.startContainer,this.startOffset);return d?0>=a&&0<=b:0>a&&0<b},isPointInRange:function(a,d){I(this);if(!a)throw new R("HIERARCHY_REQUEST_ERR");
v(a,this.startContainer);return 0<=O(a,d,this.startContainer,this.startOffset)&&0>=O(a,d,this.endContainer,this.endOffset)},intersectsRange:function(a){return h(this,a,!1)},intersectsOrTouchesRange:function(a){return h(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var d=O(this.startContainer,this.startOffset,a.startContainer,a.startOffset),b=O(this.endContainer,this.endOffset,a.endContainer,a.endOffset),f=this.cloneRange();-1==d&&f.setStart(a.startContainer,a.startOffset);1==b&&
f.setEnd(a.endContainer,a.endOffset);return f}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var d=this.cloneRange();-1==O(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&d.setStart(a.startContainer,a.startOffset);1==O(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&d.setEnd(a.endContainer,a.endOffset);return d}throw new R("Ranges do not intersect");},containsNode:function(a,d){return d?this.intersectsNode(a,!1):3==this.compareNode(a)},containsNodeContents:function(a){return 0<=
this.comparePoint(a,0)&&0>=this.comparePoint(a,da(a))},containsRange:function(a){var d=this.intersection(a);return null!==d&&a.equals(d)},containsNodeText:function(a){var d=this.cloneRange();d.selectNode(a);var b=d.getNodes([3]);return 0<b.length?(d.setStart(b[0],0),a=b.pop(),d.setEnd(a,a.length),this.containsRange(d)):this.containsNodeContents(a)},getNodes:function(a,d){I(this);return u(this,a,d)},getDocument:function(){return f(this)},collapseBefore:function(a){this.setEndBefore(a);this.collapse(!1)},
collapseAfter:function(a){this.setStartAfter(a);this.collapse(!0)},getBookmark:function(d){var b=f(this),e=a.createRange(b);d=d||r.getBody(b);e.selectNodeContents(d);b=this.intersection(e);var k=0,g=0;b&&(e.setEnd(b.startContainer,b.startOffset),k=e.toString().length,g=k+b.toString().length);return{start:k,end:g,containerNode:d}},moveToBookmark:function(a){var d=a.containerNode,b=0;this.setStart(d,0);this.collapse(!0);d=[d];for(var f,e=!1,k=!1,g,h;!k&&(f=d.pop());)if(3==f.nodeType)g=b+f.length,!e&&
a.start>=b&&a.start<=g&&(this.setStart(f,a.start-b),e=!0),e&&a.end>=b&&a.end<=g&&(this.setEnd(f,a.end-b),k=!0),b=g;else for(h=f.childNodes,g=h.length;g--;)d.push(h[g])},getName:function(){return"DomRange"},equals:function(a){return G.rangesEqual(this,a)},isValid:function(){return x(this)},inspect:function(){return t(this)},detach:function(){}});Q(G,H);B.extend(G,{rangeProperties:Aa,RangeIterator:z,copyComparisonConstants:ba,createPrototypeRange:Q,inspect:t,toHtml:Z,getRangeDocument:f,rangesEqual:function(a,
d){return a.startContainer===d.startContainer&&a.startOffset===d.startOffset&&a.endContainer===d.endContainer&&a.endOffset===d.endOffset}});a.DomRange=G});v.createCoreModule("WrappedRange",["DomRange"],function(a,d){var b,f=a.dom,e=a.util,k=f.DomPosition,g=a.DomRange,h=f.getBody,l=f.getContentDocument,n=f.isCharacterDataNode;a.features.implementsDomRange&&function(){function k(a){for(var d=n.length,b;d--;)b=n[d],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===
a.endOffset}var n=g.rangeProperties;b=function(a){if(!a)throw d.createError("WrappedRange: Range must be specified");this.nativeRange=a;k(this)};g.createPrototypeRange(b,function(a,d,b,f,e){var k=a.startContainer!==d||a.startOffset!=b,g=a.endContainer!==f||a.endOffset!=e,h=!a.equals(a.nativeRange);if(k||g||h)a.setEnd(f,e),a.setStart(d,b)});var u=b.prototype;u.selectNode=function(a){this.nativeRange.selectNode(a);k(this)};u.cloneContents=function(){return this.nativeRange.cloneContents()};u.surroundContents=
function(a){this.nativeRange.surroundContents(a);k(this)};u.collapse=function(a){this.nativeRange.collapse(a);k(this)};u.cloneRange=function(){return new b(this.nativeRange.cloneRange())};u.refresh=function(){k(this)};u.toString=function(){return this.nativeRange.toString()};var A=document.createTextNode("test");h(document).appendChild(A);var m=document.createRange();m.setStart(A,0);m.setEnd(A,0);try{m.setStart(A,1);u.setStart=function(a,d){this.nativeRange.setStart(a,d);k(this)};u.setEnd=function(a,
d){this.nativeRange.setEnd(a,d);k(this)};var t=function(a){return function(d){this.nativeRange[a](d);k(this)}}}catch(Ba){u.setStart=function(a,d){try{this.nativeRange.setStart(a,d)}catch(aa){this.nativeRange.setEnd(a,d),this.nativeRange.setStart(a,d)}k(this)},u.setEnd=function(a,d){try{this.nativeRange.setEnd(a,d)}catch(aa){this.nativeRange.setStart(a,d),this.nativeRange.setEnd(a,d)}k(this)},t=function(a,d){return function(b){try{this.nativeRange[a](b)}catch(ba){this.nativeRange[d](b),this.nativeRange[a](b)}k(this)}}}u.setStartBefore=
t("setStartBefore","setEndBefore");u.setStartAfter=t("setStartAfter","setEndAfter");u.setEndBefore=t("setEndBefore","setStartBefore");u.setEndAfter=t("setEndAfter","setStartAfter");u.selectNodeContents=function(a){this.setStartAndEnd(a,0,f.getNodeLength(a))};m.selectNodeContents(A);m.setEnd(A,3);t=document.createRange();t.selectNodeContents(A);t.setEnd(A,4);t.setStart(A,2);-1==m.compareBoundaryPoints(m.START_TO_END,t)&&1==m.compareBoundaryPoints(m.END_TO_START,t)?u.compareBoundaryPoints=function(a,
d){d=d.nativeRange||d;a==d.START_TO_END?a=d.END_TO_START:a==d.END_TO_START&&(a=d.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,d)}:u.compareBoundaryPoints=function(a,d){return this.nativeRange.compareBoundaryPoints(a,d.nativeRange||d)};t=document.createElement("div");t.innerHTML="123";var z=t.firstChild,p=h(document);p.appendChild(t);m.setStart(z,1);m.setEnd(z,2);m.deleteContents();"13"==z.data&&(u.deleteContents=function(){this.nativeRange.deleteContents();k(this)},u.extractContents=
function(){var a=this.nativeRange.extractContents();k(this);return a});p.removeChild(t);p=null;e.isHostMethod(m,"createContextualFragment")&&(u.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});h(document).removeChild(A);u.getName=function(){return"WrappedRange"};a.WrappedRange=b;a.createNativeRange=function(a){a=l(a,d,"createNativeRange");return a.createRange()}}();if(a.features.implementsTextRange){var A=function(a,d,b,e,g){var h=a.duplicate();h.collapse(b);
var l=h.parentElement();f.isOrIsAncestorOf(d,l)||(l=d);if(!l.canHaveHTML)return l=new k(l.parentNode,f.getNodeIndex(l)),{boundaryPosition:l,nodeInfo:{nodeIndex:l.offset,containerElement:l.node}};d=f.getDocument(l).createElement("span");d.parentNode&&f.removeNode(d);var u=b?"StartToStart":"StartToEnd",m=g&&g.containerElement==l?g.nodeIndex:0,A=l.childNodes.length,t=A;for(g=t;;){g==A?l.appendChild(d):l.insertBefore(d,l.childNodes[g]);h.moveToElementText(d);var z=h.compareEndPoints(u,a);if(0==z||m==
t)break;else if(-1==z)if(t==m+1)break;else m=g;else t=t==m+1?m:g;g=Math.floor((m+t)/2);l.removeChild(d)}u=d.nextSibling;if(-1==z&&u&&n(u)){h.setEndPoint(b?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(u.data))for(b=h.duplicate(),e=b.text.replace(/\r\n/g,"\r").length,e=b.moveStart("character",e);-1==b.compareEndPoints("StartToEnd",b);)e++,b.moveStart("character",1);else e=h.text.length;b=new k(u,e)}else a=(e||!b)&&d.previousSibling,b=(b=(e||b)&&d.nextSibling)&&n(b)?new k(b,0):a&&n(a)?new k(a,a.data.length):
new k(l,f.getNodeIndex(d));f.removeNode(d);return{boundaryPosition:b,nodeInfo:{nodeIndex:g,containerElement:l}}},m=function(a,d){var b=a.offset,e=f.getDocument(a.node),k=h(e).createTextRange(),g=n(a.node);if(g){var l=a.node;a=l.parentNode}else l=a.node.childNodes,l=b<l.length?l[b]:null,a=a.node;e=e.createElement("span");e.innerHTML="&#feff;";l?a.insertBefore(e,l):a.appendChild(e);k.moveToElementText(e);k.collapse(!d);a.removeChild(e);if(g)k[d?"moveStart":"moveEnd"]("character",b);return k};var u=
function(a){this.textRange=a;this.refresh()};u.prototype=new g(document);u.prototype.refresh=function(){var a=this.textRange;var d=a.parentElement();var b=a.duplicate();b.collapse(!0);var e=b.parentElement();b=a.duplicate();b.collapse(!1);a=b.parentElement();e=e==a?e:f.getCommonAncestor(e,a);e=e==d?e:f.getCommonAncestor(d,e);d=this.textRange;0==d.compareEndPoints("StartToEnd",d)?e=d=A(this.textRange,e,!0,!0).boundaryPosition:(a=A(this.textRange,e,!0,!1),d=a.boundaryPosition,e=A(this.textRange,e,!1,
!1,a.nodeInfo).boundaryPosition);this.setStart(d.node,d.offset);this.setEnd(e.node,e.offset)};u.prototype.getName=function(){return"WrappedTextRange"};g.copyComparisonConstants(u);var t=function(a){if(a.collapsed)return m(new k(a.startContainer,a.startOffset),!0);var d=m(new k(a.startContainer,a.startOffset),!0),b=m(new k(a.endContainer,a.endOffset),!1);a=h(g.getRangeDocument(a)).createTextRange();a.setEndPoint("StartToStart",d);a.setEndPoint("EndToEnd",b);return a};u.rangeToTextRange=t;u.prototype.toTextRange=
function(){return t(this)};a.WrappedTextRange=u;if(!a.features.implementsDomRange||a.config.preferTextRange){var z=Function("return this;")();"undefined"==typeof z.Range&&(z.Range=u);a.createNativeRange=function(a){a=l(a,d,"createNativeRange");return h(a).createTextRange()};a.WrappedRange=u}}a.createRange=function(b){b=l(b,d,"createRange");return new a.WrappedRange(a.createNativeRange(b))};a.createRangyRange=function(a){a=l(a,d,"createRangyRange");return new g(a)};e.createAliasForDeprecatedMethod(a,
"createIframeRange","createRange");e.createAliasForDeprecatedMethod(a,"createIframeRangyRange","createRangyRange");a.addShimListener(function(d){var b=d.document;"undefined"==typeof b.createRange&&(b.createRange=function(){return a.createRange(b)});b=d=null})});v.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,d){function b(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function f(a,b){if(a){if(C.isWindow(a))return a;if(a instanceof p)return a.win;a=C.getContentDocument(a,
d,b);return C.getWindow(a)}return window}function e(a){return f(a,"getWinSelection").getSelection()}function k(a){return f(a,"getDocSelection").document.selection}function g(a){var d=!1;a.anchorNode&&(d=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return d}function h(a,d,b){var f=b?"end":"start";b=b?"start":"end";a.anchorNode=d[f+"Container"];a.anchorOffset=d[f+"Offset"];a.focusNode=d[b+"Container"];a.focusOffset=d[b+"Offset"]}function l(a){a.anchorNode=a.focusNode=null;
a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function n(d){if(d instanceof Z){var b=a.createNativeRange(d.getDocument());b.setEnd(d.endContainer,d.endOffset);b.setStart(d.startContainer,d.startOffset)}else d instanceof aa?b=d.nativeRange:Q.implementsDomRange&&d instanceof C.getWindow(d.startContainer).Range&&(b=d);return b}function m(a){var b=a.getNodes();a:if(b.length&&1==b[0].nodeType){var f=1;for(var e=b.length;f<e;++f)if(!C.isAncestorOf(b[0],b[f])){f=!1;break a}f=
!0}else f=!1;if(!f)throw d.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}function A(a){return!!a&&"undefined"!=typeof a.text}function u(a,d){d=new aa(d);a._ranges=[d];h(a,d,!1);a.rangeCount=1;a.isCollapsed=d.collapsed}function t(d){d._ranges.length=0;if("None"==d.docSelection.type)l(d);else{var b=d.docSelection.createRange();if(A(b))u(d,b);else{d.rangeCount=b.length;for(var f,e=r(b.item(0)),k=0;k<d.rangeCount;++k)f=a.createRange(e),
f.selectNode(b.item(k)),d._ranges.push(f);d.isCollapsed=1==d.rangeCount&&d._ranges[0].collapsed;h(d,d._ranges[d.rangeCount-1],!1)}}}function z(a,b){var f=a.docSelection.createRange();b=m(b);var e=r(f.item(0));e=w(e).createControlRange();for(var k=0,g=f.length;k<g;++k)e.add(f.item(k));try{e.add(b)}catch(Ia){throw d.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}e.select();t(a)}function p(a,d,b){this.nativeSelection=a;this.docSelection=
d;this._ranges=[];this.win=b;this.refresh()}function K(a){a.win=a.anchorNode=a.focusNode=a._ranges=null;a.rangeCount=a.anchorOffset=a.focusOffset=0;a.detached=!0}function D(a,d){for(var b=V.length,f,e;b--;)if(f=V[b],e=f.selection,"deleteAll"==d)K(e);else if(f.win==a)return"delete"==d?(V.splice(b,1),!0):e;"deleteAll"==d&&(V.length=0);return null}function E(a,b){var f=r(b[0].startContainer);f=w(f).createControlRange();for(var e=0,k,g=b.length;e<g;++e){k=m(b[e]);try{f.add(k)}catch(Ia){throw d.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");
}}f.select();t(a)}function v(a,d){if(a.win.document!=r(d))throw new ba("WRONG_DOCUMENT_ERR");}function q(d){return function(b,f){if(this.rangeCount){var e=this.getRangeAt(0);e["set"+(d?"Start":"End")](b,f)}else e=a.createRange(this.win.document),e.setStartAndEnd(b,f);this.setSingleRange(e,this.isBackward())}}function I(a){var d=[],b=new ra(a.anchorNode,a.anchorOffset),f=new ra(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var k=
0,g=a.rangeCount;k<g;++k)d[k]=Z.inspect(a.getRangeAt(k));return"["+e+"(Ranges: "+d.join(", ")+")(anchor: "+b.inspect()+", focus: "+f.inspect()+"]"}a.config.checkSelectionRanges=!0;var C=a.dom,x=a.util,y=x.isHostMethod,Z=a.DomRange,aa=a.WrappedRange,ba=a.DOMException,ra=C.DomPosition,Q=a.features,r=C.getDocument,w=C.getBody,H=Z.rangesEqual,G=y(window,"getSelection"),B=x.isHostObject(document,"selection");Q.implementsWinGetSelection=G;var qa=(Q.implementsDocSelection=B)&&(!G||a.config.preferTextRange);
if(qa){var J=k;a.isSelectionValid=function(a){a=f(a,"isSelectionValid").document;var d=a.selection;return"None"!=d.type||r(d.createRange().parentElement())==a}}else if(G)J=e,a.isSelectionValid=function(){return!0};else return d.fail("Neither document.selection or window.getSelection() detected."),!1;a.getNativeSelection=J;G=J();if(!G)return d.fail("Native selection was null (possibly issue 138?)"),!1;var M=a.createNativeRange(document),F=w(document),L=x.areHostProperties(G,["anchorNode","focusNode",
"anchorOffset","focusOffset"]);Q.selectionHasAnchorAndFocus=L;var P=y(G,"extend");Q.selectionHasExtend=P;var O="number"==typeof G.rangeCount;Q.selectionHasRangeCount=O;var ca=!1,ha=!0,da=P?function(d,b){var f=Z.getRangeDocument(b);f=a.createRange(f);f.collapseToPoint(b.endContainer,b.endOffset);d.addRange(n(f));d.extend(b.startContainer,b.startOffset)}:null;x.areHostMethods(G,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof G.rangeCount&&Q.implementsDomRange&&function(){var d=window.getSelection();
if(d){for(var b=d.rangeCount,f=1<b,e=[],k=g(d),h=0;h<b;++h)e[h]=d.getRangeAt(h);h=C.createTestElement(document,"",!1);var l=h.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")),n=document.createRange();n.setStart(l,1);n.collapse(!0);d.removeAllRanges();d.addRange(n);ha=1==d.rangeCount;d.removeAllRanges();f||((f=window.navigator.appVersion.match(/Chrome\/(.*?) /))&&36<=parseInt(f[1])?ca=!1:(f=n.cloneRange(),n.setStart(l,0),f.setEnd(l,3),f.setStart(l,2),d.addRange(n),d.addRange(f),ca=2==d.rangeCount));
C.removeNode(h);d.removeAllRanges();for(h=0;h<b;++h)0==h&&k?da?da(d,e[h]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),d.addRange(e[h])):d.addRange(e[h])}}();Q.selectionSupportsMultipleRanges=ca;Q.collapsedNonEditableSelectionsSupported=ha;var U=!1;F&&y(F,"createControlRange")&&(F=F.createControlRange(),x.areHostProperties(F,["item","add"])&&(U=!0));Q.implementsControlRange=U;var T=
L?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var ia;y(G,"getRangeAt")?ia=function(a,d){try{return a.getRangeAt(d)}catch(za){return null}}:L&&(ia=function(d){var b=r(d.anchorNode);b=a.createRange(b);b.setStartAndEnd(d.anchorNode,d.anchorOffset,d.focusNode,d.focusOffset);b.collapsed!==this.isCollapsed&&b.setStartAndEnd(d.focusNode,d.focusOffset,d.anchorNode,d.anchorOffset);return b});p.prototype=
a.selectionPrototype;var V=[],ja=function(a){if(a&&a instanceof p)return a.refresh(),a;a=f(a,"getNativeSelection");var d=D(a),b=J(a),e=B?k(a):null;d?(d.nativeSelection=b,d.docSelection=e,d.refresh()):(d=new p(b,e,a),V.push({win:a,selection:d}));return d};a.getSelection=ja;x.createAliasForDeprecatedMethod(a,"getIframeSelection","getSelection");F=p.prototype;if(!qa&&L&&x.areHostMethods(G,["removeAllRanges","addRange"]))F.removeAllRanges=function(){this.nativeSelection.removeAllRanges();l(this)},F.addRange=
O?function(d,f){if(U&&B&&"Control"==this.docSelection.type)z(this,d);else if(b(f)&&P)da(this.nativeSelection,d),this.refresh();else{ca?f=this.rangeCount:(this.removeAllRanges(),f=0);var e=n(d).cloneRange();try{this.nativeSelection.addRange(e)}catch(ya){}this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==f+1?(a.config.checkSelectionRanges&&(f=ia(this.nativeSelection,this.rangeCount-1))&&!H(f,d)&&(d=new aa(f)),this._ranges[this.rangeCount-1]=d,h(this,d,ka(this.nativeSelection)),this.isCollapsed=
T(this)):this.refresh()}}:function(a,d){b(d)&&P?da(this.nativeSelection,a):this.nativeSelection.addRange(n(a));this.refresh()},F.setRanges=function(a){if(U&&B&&1<a.length)E(this,a);else{this.removeAllRanges();for(var d=0,b=a.length;d<b;++d)this.addRange(a[d])}};else if(y(G,"empty")&&y(M,"select")&&U&&qa)F.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){if(this.anchorNode)var a=r(this.anchorNode);else if("Control"==this.docSelection.type){var d=this.docSelection.createRange();
d.length&&(a=r(d.item(0)))}a&&(w(a).createTextRange().select(),this.docSelection.empty())}}catch(za){}l(this)},F.addRange=function(d){"Control"==this.docSelection.type?z(this,d):(a.WrappedTextRange.rangeToTextRange(d).select(),this._ranges[0]=d,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,d,!1))},F.setRanges=function(a){this.removeAllRanges();var d=a.length;1<d?E(this,a):d&&this.addRange(a[0])};else return d.fail("No means of selecting a Range or TextRange was found"),!1;F.getRangeAt=
function(a){if(0>a||a>=this.rangeCount)throw new ba("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};if(qa)var sa=function(d){if(a.isSelectionValid(d.win))var b=d.docSelection.createRange();else b=w(d.win.document).createTextRange(),b.collapse(!0);"Control"==d.docSelection.type?t(d):A(b)?u(d,b):l(d)};else if(y(G,"getRangeAt")&&"number"==typeof G.rangeCount)sa=function(d){if(U&&B&&"Control"==d.docSelection.type)t(d);else if(d._ranges.length=d.rangeCount=d.nativeSelection?d.nativeSelection.rangeCount:
0,d.rangeCount){for(var b=0,f=d.rangeCount;b<f;++b)d._ranges[b]=new a.WrappedRange(d.nativeSelection.getRangeAt(b));h(d,d._ranges[d.rangeCount-1],ka(d.nativeSelection));d.isCollapsed=T(d)}else l(d)};else if(L&&"boolean"==typeof G.isCollapsed&&"boolean"==typeof M.collapsed&&Q.implementsDomRange)sa=function(a){var d=a.nativeSelection;d.anchorNode?(d=ia(d,0),a._ranges=[d],a.rangeCount=1,d=a.nativeSelection,a.anchorNode=d.anchorNode,a.anchorOffset=d.anchorOffset,a.focusNode=d.focusNode,a.focusOffset=
d.focusOffset,a.isCollapsed=T(a)):l(a)};else return d.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;F.refresh=function(a){var d=a?this._ranges.slice(0):null,b=this.anchorNode,f=this.anchorOffset;sa(this);if(a){a=d.length;if(a!=this._ranges.length||this.anchorNode!=b||this.anchorOffset!=f)return!0;for(;a--;)if(!H(d[a],this._ranges[a]))return!0;return!1}};var xa=function(a,d){var b=a.getAllRanges();a.removeAllRanges();for(var f=0,e=b.length;f<e;++f)H(d,b[f])||
a.addRange(b[f]);a.rangeCount||l(a)};F.removeRange=U&&B?function(a){if("Control"==this.docSelection.type){var d=this.docSelection.createRange();a=m(a);var b=r(d.item(0));b=w(b).createControlRange();for(var f,e=!1,k=0,g=d.length;k<g;++k)f=d.item(k),f!==a||e?b.add(d.item(k)):e=!0;b.select();t(this)}else xa(this,a)}:function(a){xa(this,a)};if(!qa&&L&&Q.implementsDomRange){var ka=g;F.isBackward=function(){return ka(this)}}else ka=F.isBackward=function(){return!1};F.isBackwards=F.isBackward;F.toString=
function(){for(var a=[],d=0,b=this.rangeCount;d<b;++d)a[d]=""+this._ranges[d];return a.join("")};F.collapse=function(d,b){v(this,d);var f=a.createRange(d);f.collapseToPoint(d,b);this.setSingleRange(f);this.isCollapsed=!0};F.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new ba("INVALID_STATE_ERR");};F.collapseToEnd=function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new ba("INVALID_STATE_ERR");
};F.selectAllChildren=function(d){v(this,d);var b=a.createRange(d);b.selectNodeContents(d);this.setSingleRange(b)};F.deleteFromDocument=function(){if(U&&B&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),d;a.length;)d=a.item(0),a.remove(d),C.removeNode(d);this.refresh()}else if(this.rangeCount&&(a=this.getAllRanges(),a.length)){this.removeAllRanges();d=0;for(var b=a.length;d<b;++d)a[d].deleteContents();this.addRange(a[b-1])}};F.eachRange=function(a,d){for(var b=0,f=this._ranges.length;b<
f;++b)if(a(this.getRangeAt(b)))return d};F.getAllRanges=function(){var a=[];this.eachRange(function(d){a.push(d)});return a};F.setSingleRange=function(a,d){this.removeAllRanges();this.addRange(a,d)};F.callMethodOnEachRange=function(a,d){var b=[];this.eachRange(function(f){b.push(f[a].apply(f,d||[]))});return b};F.setStart=q(!0);F.setEnd=q(!1);a.rangePrototype.select=function(a){ja(this.getDocument()).setSingleRange(this,a)};F.changeEachRange=function(a){var d=[],b=this.isBackward();this.eachRange(function(b){a(b);
d.push(b)});this.removeAllRanges();b&&1==d.length?this.addRange(d[0],"backward"):this.setRanges(d)};F.containsNode=function(a,d){return this.eachRange(function(b){return b.containsNode(a,d)},!0)||!1};F.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}};F.moveToBookmark=function(d){for(var b=[],f=0,e,k;e=d.rangeBookmarks[f++];)k=a.createRange(this.win),k.moveToBookmark(e),b.push(k);d.backward?this.setSingleRange(b[0],"backward"):
this.setRanges(b)};F.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}};F.restoreRanges=function(a){this.removeAllRanges();for(var d=0,b;b=a.ranges[d];++d)this.addRange(b,a.backward&&0==d)};F.toHtml=function(){var a=[];this.eachRange(function(d){a.push(Z.toHtml(d))});return a.join("")};Q.implementsTextRange&&(F.getNativeTextRange=function(){var b;if(b=this.docSelection){b=b.createRange();if(A(b))return b;throw d.createError("getNativeTextRange: selection is a control selection");
}if(0<this.rangeCount)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw d.createError("getNativeTextRange: selection contains no range");});F.getName=function(){return"WrappedSelection"};F.inspect=function(){return I(this)};F.detach=function(){D(this.win,"delete");K(this)};p.detachAll=function(){D(null,"deleteAll")};p.inspect=I;p.isDirectionBackward=b;a.Selection=p;a.selectionPrototype=F;a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return ja(a)});
a=null})});var M=!1;t=function(a){M||(M=!0,!v.initialized&&v.config.autoInitialize&&l())};K&&("complete"==document.readyState?t():(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",t,!1),G(window,"load",t)));rangy=v})();
rangy.createModule("SaveRestore",["WrappedRange"],function(a,e){function b(a,d){var b="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),f=m.getDocument(a.startContainer);a=a.cloneRange();a.collapse(d);d=f.createElement("span");d.id=b;d.style.lineHeight="0";d.style.display="none";d.className="rangySelectionBoundary";d.appendChild(f.createTextNode("\ufeff"));a.insertNode(d);return d}function g(a,d,b,f){(a=(a||document).getElementById(b))?(d[f?"setStartBefore":"setEndBefore"](a),p(a)):
e.warn("Marker element has been removed. Cannot restore selection.")}function h(a,d){return d.compareBoundaryPoints(a.START_TO_START,a)}function f(d,f){var e=a.DomRange.getRangeDocument(d),k=d.toString(),g=q(f);if(d.collapsed){var h=b(d,!1);return{document:e,markerId:h.id,collapsed:!0}}h=b(d,!1);f=b(d,!0);return{document:e,startMarkerId:f.id,endMarkerId:h.id,collapsed:!1,backward:g,toString:function(){return"original text: '"+k+"', new text: '"+d.toString()+"'"}}}function d(d,b){var f=d.document;
"undefined"==typeof b&&(b=!0);var k=a.createRange(f);d.collapsed?(d=(f||document).getElementById(d.markerId))?(d.style.display="inline",(f=d.previousSibling)&&3==f.nodeType?(p(d),k.collapseToPoint(f,f.length)):(k.collapseBefore(d),p(d))):e.warn("Marker element has been removed. Cannot restore selection."):(g(f,k,d.startMarkerId,!0),g(f,k,d.endMarkerId,!1));b&&k.normalizeBoundaries();return k}function k(d,b){var e=[],k;var g=q(b);d=d.slice(0);d.sort(h);b=0;for(k=d.length;b<k;++b)e[b]=f(d[b],g);for(b=
k-1;0<=b;--b)g=d[b],k=a.DomRange.getRangeDocument(g),g.collapsed?g.collapseAfter((k||document).getElementById(e[b].markerId)):(g.setEndBefore((k||document).getElementById(e[b].endMarkerId)),g.setStartAfter((k||document).getElementById(e[b].startMarkerId)));return e}function l(a){for(var b=[],f=a.length-1;0<=f;f--)b[f]=d(a[f],!0);return b}function n(a,d){(a=(a||document).getElementById(d))&&p(a)}var m=a.dom,p=m.removeNode,q=a.Selection.isDirectionBackward;a.util.extend(a,{saveRange:f,restoreRange:d,
saveRanges:k,restoreRanges:l,saveSelection:function(d){if(!a.isSelectionValid(d))return e.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var b=a.getSelection(d),f=b.getAllRanges(),g=1==f.length&&b.isBackward(),h=k(f,g);g?b.setSingleRange(f[0],g):b.setRanges(f);return{win:d,rangeInfos:h,restored:!1}},restoreSelection:function(d,b){if(!d.restored){var f=d.rangeInfos,e=a.getSelection(d.win),k=l(f);1==f.length&&b&&a.features.selectionHasExtend&&
f[0].backward?(e.removeAllRanges(),e.addRange(k[0],!0)):e.setRanges(k);d.restored=!0}},removeMarkerElement:n,removeMarkers:function(a){for(var d=a.rangeInfos,b=0,f=d.length,e;b<f;++b)e=d[b],e.collapsed?n(a.doc,e.markerId):(n(a.doc,e.startMarkerId),n(a.doc,e.endMarkerId))}})});
rangy.createModule("TextRange",["WrappedSelection"],function(a,e){function b(a,d){var b=a.slice(d.start,d.end);a={isWord:d.isWord,chars:b,toString:function(){return b.join("")}};d=0;for(var f=b.length;d<f;++d)b[d].token=a;return a}function g(a,d,f){d=f(a,d);f=[];for(var e=0,k;k=d[e++];)f.push(b(a,k));return f}function h(a){a=a||"";a="string"==typeof a?a.split(""):a;a.sort(function(a,d){return a.charCodeAt(0)-d.charCodeAt(0)});return a.join("").replace(/(.)\1+/g,"$1")}function f(a,d){a=P(a,d);if(d.hasOwnProperty("wordOptions")){var b=
a.wordOptions;if(b){var f=b.language||"en";var e={};M(e,na[f]||na.en);M(e,b);b=e}else b=na.en;a.wordOptions=b}d.hasOwnProperty("characterOptions")&&(a.characterOptions=P(a.characterOptions,ea));return a}function d(a,d){d=oa(a,"display",d);a=a.tagName.toLowerCase();return"block"==d&&Da&&Ea.hasOwnProperty(a)?Ea[a]:d}function k(a){for(var b=a,f=[];b.parentNode;)f.unshift(b.parentNode),b=b.parentNode;a=f.concat([a]);b=0;for(f=a.length;b<f;++b)if(1==a[b].nodeType&&"none"==d(a[b]))return!0;return!1}function l(a,
d){if(!d&&a.hasChildNodes())return a.firstChild;for(;a&&!a.nextSibling;)a=a.parentNode;a=a?a.nextSibling:null;return a}function n(a){var d=a.previousSibling;if(d){for(a=d;a.hasChildNodes();)a=a.lastChild;return a}return(a=a.parentNode)&&1==a.nodeType?a:null}function m(a){if(!a||3!=a.nodeType)return!1;var d=a.data;if(""===d)return!0;var b=a.parentNode;if(!b||1!=b.nodeType)return!1;a=oa(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(d)&&/^(normal|nowrap)$/.test(a)||/^[\t\r ]+$/.test(d)&&"pre-line"==
a}function p(a){return""===a.data?!0:m(a)?!a.parentNode||k(a)?!0:!1:!1}function q(a){var d=a.nodeType;if(!(d=7==d||8==d||k(a)||/^(script|style)$/i.test(a.nodeName))){var b;d=3==a.nodeType&&(b=a.parentNode)&&"hidden"==oa(b,"visibility")}return d||p(a)}function x(a,b){var f=a.nodeType;return 7==f||8==f||1==f&&"none"==d(a,b)}function y(){this.store={}}function w(a,d,b){return function(f){var e=this.cache;if(e.hasOwnProperty(a))return Ga++,e[a];Ha++;f=d.call(this,b?this[b]:this,f);return e[a]=f}}function B(a,
d){this.node=a;this.session=d;this.cache=new y;this.positions=new y}function C(a,d){this.offset=d;this.nodeWrapper=a;this.node=a.node;this.session=a.session;this.cache=new y}function H(){D();return Y=new Ba}function D(){Y&&Y.detach();Y=null}function t(a,d,b,f){function k(){var a=null;d?(a=g,h||(g=g.previousVisible(),h=!g||b&&g.equals(b))):h||(a=g=g.nextVisible(),h=!g||b&&g.equals(b));h&&(g=null);return a}b&&(d?q(b.node)&&(b=a.previousVisible()):q(b.node)&&(b=b.nextVisible()));var g=a,h=!1,l,n=!1;
return{next:function(){if(n)return n=!1,l;for(var a,d;a=k();)if(d=a.getCharacter(f))return l=a;return null},rewind:function(){if(l)n=!0;else throw e.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");},dispose:function(){a=b=null}}}function z(a,d,b){function f(a){for(var d,b=[],f=a?e:k,g=!1,h=!1;a=f.next();){d=a.character;if(W.test(d))h&&(h=!1,g=!0);else if(g){f.rewind();break}else h=!0;b.push(a)}return b}var e=t(a,!1,null,d),k=t(a,!0,null,d),h=b.tokenizer;a=
f(!0);d=f(!1).reverse();var l=g(d.concat(a),b,h),n=a.length?l.slice(Ca(l,a[0].token)):[],u=d.length?l.slice(0,Ca(l,d.pop().token)+1):[];return{nextEndToken:function(){for(var a,d;1==n.length&&!(a=n[0]).isWord&&0<(d=f(!0)).length;)n=g(a.chars.concat(d),b,h);return n.shift()},previousStartToken:function(){for(var a,d;1==u.length&&!(a=u[0]).isWord&&0<(d=f(!1)).length;)u=g(d.reverse().concat(a.chars),b,h);return u.pop()},dispose:function(){e.dispose();k.dispose();n=u=null}}}function A(a,d,b,f){var e=
a.getRangeBoundaryPosition(d,!0);a=a.getRangeBoundaryPosition(d,!1);return t(f?a:e,!!f,f?e:a,b)}function K(d,b,f,e,k){function g(d,b){d=l[d].previousVisible();b=l[b-1];var f;if(!(f=!k.wholeWordsOnly)){f=k.wordOptions;var e=a.createRange(d.node);e.setStartAndEnd(d.node,d.offset,b.node,b.offset);f=!e.expand("word",{wordOptions:f})}return{startPos:d,endPos:b,valid:f}}var h=ma(k.direction);d=t(d,h,d.session.getRangeBoundaryPosition(e,h),k.characterOptions);e="";for(var l=[],n,u,m,A,z,p=null;n=d.next();)if(u=
n.character,f||k.caseSensitive||(u=u.toLowerCase()),h?(l.unshift(n),e=u+e):(l.push(n),e+=u),f){if(n=b.exec(e))if(m=n.index,A=m+n[0].length,z){if(!h&&A<e.length||h&&0<m){p=g(m,A);break}}else z=!0}else if(-1!=(m=e.indexOf(b))){p=g(m,m+b.length);break}z&&(p=g(m,A));d.dispose();return p}function E(a){return function(){var d=!!Y,b=[Y||H()].concat(L.toArray(arguments));b=a.apply(this,b);d||D();return b}}function v(a,d){return E(function(b,e,k,g){var h;"undefined"==typeof k&&(k=e,e="character");g=f(g,fa);
var l=a;d&&(l=0<=k,this.collapse(!l));b=b.getRangeBoundaryPosition(this,l);var n=g.characterOptions,u=g.wordOptions;g=0;var m=b,A=Math.abs(k);if(0!==k){k=0>k;switch(e){case "character":for(u=t(b,k,null,n);(h=u.next())&&g<A;)++g,m=h;u.dispose();break;case "word":u=z(b,n,u);for(var p=k?u.previousStartToken:u.nextEndToken;(u=p())&&g<A;)u.isWord&&(++g,m=k?u.chars[0]:u.chars[u.chars.length-1]);break;default:throw Error("movePositionBy: unit '"+e+"' not implemented");}k?(m=m.previousVisible(),g=-g):m&&
m.isLeadingSpace&&!m.isTrailingSpace&&("word"==e&&(u=t(b,!1,null,n),h=u.next(),u.dispose()),h&&(m=h.previousVisible()))}b=m;h=g;this[l?"setStart":"setEnd"](b.node,b.offset);return h})}function I(a){return E(function(d,b){b=P(b,ea);var f,e=A(d,this,b,!a);for(d=0;(f=e.next())&&W.test(f.character);)++d;e.dispose();if(f=0<d)this[a?"moveStart":"moveEnd"]("character",a?d:-d,{characterOptions:b});return f})}function G(a){return E(function(d,b){var f=!1;this.changeEachRange(function(d){f=d[a](b)||f});return f})}
var r=a.dom,L=a.util,M=L.extend,P=L.createOptions,J=r.getBody,N=/^[ \t\f\r\n]+$/,la=/^[ \t\f\r]+$/,W=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,X=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,ma=a.Selection.isDirectionBackward,ta=!1,ua=!1;(function(){var d=r.createTestElement(document,"<p>1 </p><p></p>",!0),b=d.firstChild,f=a.getSelection();f.collapse(b.lastChild,2);f.setStart(b.firstChild,0);d.innerHTML="1 <br />";f.collapse(d,2);f.setStart(d.firstChild,
0);ta=1==(""+f).length;d.innerHTML="1 <p>1</p>";f.collapse(d,2);f.setStart(d.firstChild,0);ua=1==(""+f).length;r.removeNode(d);f.removeAllRanges()})();var ea={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},va={includeBlockContentTrailingSpace:!1,includeSpaceBeforeBr:!ta,includeSpaceBeforeBlock:!ua,includePreLineTrailingSpace:!0},na={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:function(a,
d){function b(a,d,b){k.push({start:a,end:d,isWord:b})}for(var f=a.join(""),e,k=[],g=0,h;e=d.wordRegex.exec(f);){h=e.index;e=h+e[0].length;h>g&&b(g,h,!1);if(d.includeTrailingSpace)for(;X.test(a[e]);)++e;b(h,e,!0);g=e}g<a.length&&b(g,a.length,!1);return k}}},u={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},fa={wordOptions:null,characterOptions:null},wa={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},S=
{wordOptions:null,characterOptions:null,direction:"forward"},oa=r.getComputedStyleProperty,Da;(function(){var a=document.createElement("table"),d=J(document);d.appendChild(a);Da="block"==oa(a,"display");d.removeChild(a)})();var Ea={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};y.prototype={get:function(a){return this.store.hasOwnProperty(a)?
this.store[a]:null},set:function(a,d){return this.store[a]=d}};var Ga=0,Ha=0,pa={getPosition:function(a){var d=this.positions;return d.get(a)||d.set(a,new C(this,a))},toString:function(){return"[NodeWrapper("+r.inspectNode(this.node)+")]"}};B.prototype=pa;M(pa,{isCharacterDataNode:w("isCharacterDataNode",r.isCharacterDataNode,"node"),getNodeIndex:w("nodeIndex",r.getNodeIndex,"node"),getLength:w("nodeLength",r.getNodeLength,"node"),containsPositions:w("containsPositions",function(a){return r.isCharacterDataNode(a)||
!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)},"node"),isWhitespace:w("isWhitespace",m,"node"),isCollapsedWhitespace:w("isCollapsedWhitespace",p,"node"),getComputedDisplay:w("computedDisplay",d,"node"),isCollapsed:w("collapsed",q,"node"),isIgnored:w("ignored",x,"node"),next:w("nextPos",l,"node"),previous:w("previous",n,"node"),getTextNodeInfo:w("textNodeInfo",function(a){var d=null,b=!1,f=oa(a.parentNode,"whiteSpace"),e="pre-line"==f;if(e)d=la,b=!0;
else if("normal"==f||"nowrap"==f)d=N,b=!0;return{node:a,text:a.data,spaceRegex:d,collapseSpaces:b,preLine:e}},"node"),hasInnerText:w("hasInnerText",function(a,d){var b=this.session,f=b.getPosition(a.parentNode,this.getNodeIndex()+1);b=b.getPosition(a,0);a=d?f:b;for(f=d?b:f;a!==f;){a.prepopulateChar();if(a.isDefinitelyNonEmpty())return!0;a=d?a.previousVisible():a.nextVisible()}return!1},"node"),isRenderedBlock:w("isRenderedBlock",function(a){a=a.getElementsByTagName("br");for(var d=0,b=a.length;d<
b;++d)if(!q(a[d]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:w("trailingSpace",function(a){if("br"!=a.tagName.toLowerCase())switch(this.getComputedDisplay()){case "inline":for(a=a.lastChild;a;){if(!x(a))return 1==a.nodeType?this.session.getNodeWrapper(a).getTrailingSpace():"";a=a.previousSibling}break;case "inline-block":case "inline-table":case "none":case "table-column":case "table-column-group":break;case "table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},
"node"),getLeadingSpace:w("leadingSpace",function(a){switch(this.getComputedDisplay()){case "inline":case "inline-block":case "inline-table":case "none":case "table-column":case "table-column-group":case "table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});pa={character:"",characterType:"EMPTY",isBr:!1,prepopulateChar:function(){if(!this.prepopulatedChar){var a=this.node,d=this.offset,b="",f="EMPTY",e=!1;if(0<d)if(3==a.nodeType){a=a.data;var k=a.charAt(d-1),g=this.nodeWrapper.getTextNodeInfo(),
h=g.spaceRegex;g.collapseSpaces?h.test(k)?1<d&&h.test(a.charAt(d-2))||(g.preLine&&"\n"===a.charAt(d)?(b=" ",f="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK"):(b=" ",f="COLLAPSIBLE_SPACE")):(b=k,f="NON_SPACE",e=!0):(b=k,f="UNCOLLAPSIBLE_SPACE",e=!0)}else(k=a.childNodes[d-1])&&1==k.nodeType&&!q(k)&&("br"==k.tagName.toLowerCase()?(b="\n",this.isBr=!0,f="COLLAPSIBLE_SPACE",e=!1):this.checkForTrailingSpace=!0),b||(d=a.childNodes[d])&&1==d.nodeType&&!q(d)&&(this.checkForLeadingSpace=!0);this.prepopulatedChar=
!0;this.character=b;this.characterType=f;this.isCharInvariant=e}},isDefinitelyNonEmpty:function(){var a=this.characterType;return"NON_SPACE"==a||"UNCOLLAPSIBLE_SPACE"==a},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType="COLLAPSIBLE_SPACE");this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){if(a=
this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace())this.isLeadingSpace=!0,this.character=a,this.characterType="COLLAPSIBLE_SPACE";this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){for(var d=this,b;d=d.previousVisible();)if(b=d.getCharacter(a),""!==b)return d;return null},getCharacter:function(a){function d(){n||(l=u.getPrecedingUncollapsedPosition(a),n=!0);return l}this.resolveLeadingAndTrailingSpaces();var b=this.character,f=h(a.ignoreCharacters),
e=""!==b&&-1<f.indexOf(b);if(this.isCharInvariant)return e?"":b;e=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace,f].join("_");var k=this.cache.get(e);if(null!==k)return k;k="";var g,l,n=!1,u=this;if("COLLAPSIBLE_SPACE"==this.characterType)if("INCLUDED_TRAILING_LINE_BREAK_AFTER_BR"==this.type)k="\n";else if(" "!=b||d()&&!l.isTrailingSpace&&"\n"!=l.character&&(" "!=l.character||"COLLAPSIBLE_SPACE"!=l.characterType))if("\n"==b&&this.isLeadingSpace)d()&&
"\n"!=l.character&&(k="\n");else if(g=this.nextUncollapsed())if(g.isBr?this.type="TRAILING_SPACE_BEFORE_BR":g.isTrailingSpace&&"\n"==g.character?this.type="TRAILING_SPACE_IN_BLOCK":g.isLeadingSpace&&"\n"==g.character&&(this.type="TRAILING_SPACE_BEFORE_BLOCK"),"\n"==g.character){if("TRAILING_SPACE_BEFORE_BR"!=this.type||a.includeSpaceBeforeBr)if("TRAILING_SPACE_BEFORE_BLOCK"!=this.type||a.includeSpaceBeforeBlock)if("TRAILING_SPACE_IN_BLOCK"!=this.type||!g.isTrailingSpace||a.includeBlockContentTrailingSpace)if("PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK"!=
this.type||"NON_SPACE"!=g.type||a.includePreLineTrailingSpace)"\n"==b?g.isTrailingSpace?!this.isTrailingSpace&&this.isBr&&(g.type="TRAILING_LINE_BREAK_AFTER_BR",d()&&l.isLeadingSpace&&!l.isTrailingSpace&&"\n"==l.character?g.character="":g.type="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR"):k="\n":" "==b&&(k=" ")}else k=b;-1<f.indexOf(k)&&(k="");this.cache.set(e,k);return k},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:function(){return"[Position("+r.inspectNode(this.node)+
":"+this.offset+")]"},toString:function(){return this.character}};C.prototype=pa;M(pa,{next:w("nextPos",function(a){var d=a.nodeWrapper,b=a.node,f=a.offset;a=d.session;if(!b)return null;f==d.getLength()?d=(b=b.parentNode)?d.getNodeIndex()+1:0:d.isCharacterDataNode()?d=f+1:(d=b.childNodes[f],a.getNodeWrapper(d).containsPositions()?(b=d,d=0):d=f+1);return b?a.getPosition(b,d):null}),previous:w("previous",function(a){var d=a.nodeWrapper,b=a.node,f=a.offset;a=d.session;0==f?d=(b=b.parentNode)?d.getNodeIndex():
0:d.isCharacterDataNode()?d=f-1:(d=b.childNodes[f-1],a.getNodeWrapper(d).containsPositions()?(b=d,d=r.getNodeLength(d)):d=f-1);return b?a.getPosition(b,d):null}),nextVisible:w("nextVisible",function(a){var d=a.next();if(!d)return null;a=d.nodeWrapper;var b=d.node;a.isCollapsed()&&(d=a.session.getPosition(b.parentNode,a.getNodeIndex()+1));return d}),nextUncollapsed:w("nextUncollapsed",function(a){for(;a=a.nextVisible();)if(a.resolveLeadingAndTrailingSpaces(),""!==a.character)return a;return null}),
previousVisible:w("previousVisible",function(a){var d=a.previous();if(!d)return null;a=d.nodeWrapper;var b=d.node;a.isCollapsed()&&(d=a.session.getPosition(b.parentNode,a.getNodeIndex()));return d})});var Y=null,Ba=function(){function a(a){var d=new y;return{get:function(b){var f=d.get(b[a]);if(f)for(var e=0,k;k=f[e++];)if(k.node===b)return k;return null},set:function(b){var f=b.node[a];(d.get(f)||d.set(f,[])).push(b)}}}function d(){this.initCaches()}var b=L.isHostProperty(document.documentElement,
"uniqueID");d.prototype={initCaches:function(){this.elementCache=b?function(){var a=new y;return{get:function(d){return a.get(d.uniqueID)},set:function(d){a.set(d.node.uniqueID,d)}}}():a("tagName");this.textNodeCache=a("data");this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){switch(a.nodeType){case 1:var d=this.elementCache;break;case 3:d=this.textNodeCache;break;default:d=this.otherNodeCache}var b=d.get(a);b||(b=new B(a,this),d.set(b));return b},getPosition:function(a,d){return this.getNodeWrapper(a).getPosition(d)},
getRangeBoundaryPosition:function(a,d){d=d?"start":"end";return this.getPosition(a[d+"Container"],a[d+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}};return d}();M(r,{nextNode:l,previousNode:n});var Ca=Array.prototype.indexOf?function(a,d){return a.indexOf(d)}:function(a,d){for(var b=0,f=a.length;b<f;++b)if(a[b]===d)return b;return-1};M(a.rangePrototype,{moveStart:v(!0,!1),moveEnd:v(!1,!1),move:v(!0,!0),trimStart:I(!0),trimEnd:I(!1),trim:E(function(a,
d){a=this.trimStart(d);d=this.trimEnd(d);return a||d}),expand:E(function(a,d,b){var e=!1;b=f(b,wa);var k=b.characterOptions;d||(d="character");if("word"==d){var g=b.wordOptions;d=a.getRangeBoundaryPosition(this,!0);a=a.getRangeBoundaryPosition(this,!1);var h=z(d,k,g).nextEndToken(),l=h.chars[0].previousVisible();g=this.collapsed?h:z(a,k,g).previousStartToken();g=g.chars[g.chars.length-1];l.equals(d)||(this.setStart(l.node,l.offset),e=!0);g&&!g.equals(a)&&(this.setEnd(g.node,g.offset),e=!0);b.trim&&
(b.trimStart&&(e=this.trimStart(k)||e),b.trimEnd&&(e=this.trimEnd(k)||e));return e}return this.moveEnd("character",1,b)}),text:E(function(a,d){if(this.collapsed)d="";else{var b=P(d,ea);d=[];for(a=A(a,this,b);b=a.next();)d.push(b);a.dispose();d=d.join("")}return d}),selectCharacters:E(function(a,d,b,f,e){a={characterOptions:e};d||(d=J(this.getDocument()));this.selectNodeContents(d);this.collapse(!0);this.moveStart("character",b,a);this.collapse(!0);this.moveEnd("character",f-b,a)}),toCharacterRange:E(function(a,
d,b){d||(d=J(this.getDocument()));a=d.parentNode;d=r.getNodeIndex(d);var f=-1==r.comparePoints(this.startContainer,this.endContainer,a,d),e=this.cloneRange();f?(e.setStartAndEnd(this.startContainer,this.startOffset,a,d),a=-e.text(b).length):(e.setStartAndEnd(a,d,this.startContainer,this.startOffset),a=e.text(b).length);b=a+this.text(b).length;return{start:a,end:b}}),findText:E(function(d,b,e){e=f(e,u);e.wholeWordsOnly&&(e.wordOptions.includeTrailingSpace=!1);var k=ma(e.direction),g=e.withinRange;
g||(g=a.createRange(),g.selectNodeContents(this.getDocument()));var h=!1;"string"==typeof b?e.caseSensitive||(b=b.toLowerCase()):h=!0;var l=d.getRangeBoundaryPosition(this,!k),n=g.comparePoint(l.node,l.offset);-1===n?l=d.getRangeBoundaryPosition(g,!0):1===n&&(l=d.getRangeBoundaryPosition(g,!1));var m=l;for(n=!1;;)if(m=K(m,b,h,g,e)){if(m.valid)return this.setStartAndEnd(m.startPos.node,m.startPos.offset,m.endPos.node,m.endPos.offset),!0;m=k?m.startPos:m.endPos}else if(e.wrap&&!n)g=g.cloneRange(),m=
d.getRangeBoundaryPosition(g,!k),g.setBoundary(l.node,l.offset,k),n=!0;else return!1}),pasteHtml:function(a){this.deleteContents();if(a){a=this.createContextualFragment(a);var d=a.lastChild;this.insertNode(a);this.collapseAfter(d)}}});M(a.selectionPrototype,{expand:E(function(a,d,b){this.changeEachRange(function(a){a.expand(d,b)})}),move:E(function(a,d,b,f){a=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var e=this.getRangeAt(0);f||(f={});f.characterOptions=P(f.characterOptions,
va);a=e.move(d,b,f);this.setSingleRange(e)}return a}),trimStart:G("trimStart"),trimEnd:G("trimEnd"),trim:G("trim"),selectCharacters:E(function(d,b,f,e,k,g){d=a.createRange(b);d.selectCharacters(b,f,e,g);this.setSingleRange(d,k)}),saveCharacterRanges:E(function(a,d,b){a=this.getAllRanges();for(var f=[],e=1==a.length&&this.isBackward(),k=0,g=a.length;k<g;++k)f[k]={characterRange:a[k].toCharacterRange(d,b),backward:e,characterOptions:b};return f}),restoreCharacterRanges:E(function(d,b,f){this.removeAllRanges();
d=0;for(var e=f.length,k,g,h;d<e;++d)g=f[d],h=g.characterRange,k=a.createRange(b),k.selectCharacters(b,h.start,h.end,g.characterOptions),this.addRange(k,g.backward)}),text:E(function(a,d){a=[];for(var b=0,f=this.rangeCount;b<f;++b)a[b]=this.getRangeAt(b).text(d);return a.join("")})});a.innerText=function(d,b){var f=a.createRange(d);f.selectNodeContents(d);return f.text(b)};a.createWordIterator=function(a,d,b){var e=Y||H();b=f(b,S);a=e.getPosition(a,d);var k=z(a,b.characterOptions,b.wordOptions),g=
ma(b.direction);return{next:function(){return g?k.previousStartToken():k.nextEndToken()},dispose:function(){k.dispose();this.next=function(){}}}};a.noMutation=function(a){var d=Y||H();a(d);D()};a.noMutation.createEntryPointFunction=E;a.textRange={isBlockNode:function(a){return a&&(1==a.nodeType&&!/^(inline(-block|-table)?|none)$/.test(d(a))||9==a.nodeType||11==a.nodeType)},isCollapsedWhitespaceNode:p,createPosition:E(function(a,d,b){return a.getPosition(d,b)})}});
wysihtml.browser=function(){function a(a,d){var b=-1,f;"Microsoft Internet Explorer"==navigator.appName?f=/MSIE ([0-9]{1,}[.0-9]{0,})/:"Netscape"==navigator.appName&&(-1<navigator.userAgent.indexOf("Trident")?f=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/:/Edge\/(\d+)./i.test(navigator.userAgent)&&(f=/Edge\/(\d+)./i));f&&null!=f.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));if(-1===b)return!1;if(!a)return!0;if(!d)return a===b;if("<"===d)return a<b;if(">"===d)return a>b;if("<="===d)return a<=b;if(">="===
d)return a>=b}var e=navigator.userAgent,b=document.createElement("div"),g=-1!==e.indexOf("Gecko")&&-1===e.indexOf("KHTML")&&!a(),h=-1!==e.indexOf("AppleWebKit/")&&!a(),f=-1!==e.indexOf("Chrome/")&&!a(),d=-1!==e.indexOf("Opera/")&&!a();return{USER_AGENT:e,supported:function(){var a=this.USER_AGENT.toLowerCase(),d="contentEditable"in b,f=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,e=document.querySelector&&document.querySelectorAll,g;if(g=this.isIos())g=5>+(/ipad|iphone|ipod/.test(a)&&
a.match(/ os (\d+).+? like mac os x/)||[void 0,0])[1];a=g||this.isAndroid()&&4>+(a.match(/android (\d+)/)||[void 0,0])[1]||-1!==a.indexOf("opera mobi")||-1!==a.indexOf("hpwos/");return d&&f&&e&&!a},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return a()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in
document)},displaysCaretInEmptyContentEditableCorrectly:function(){return a(12,">")},hasCurrentStyleProperty:function(){return"currentStyle"in b},insertsLineBreaksOnReturn:function(){return g},supportsPlaceholderAttributeOn:function(a){return"placeholder"in a},supportsEvent:function(a){var d;(d="on"+a in b)||(b.setAttribute("on"+a,"return;"),d="function"===typeof b["on"+a]);return d},supportsEventsInIframeCorrectly:function(){return!d},supportsHTML5Tags:function(a){a=a.createElement("div");a.innerHTML=
"<article>foo</article>";return"<article>foo</article>"===a.innerHTML.toLowerCase()},supportsCommand:function(){var d={formatBlock:a(10,"<="),insertUnorderedList:a(),insertOrderedList:a()},b={insertHTML:g};return function(a,f){if(!d[f]){try{return a.queryCommandSupported(f)}catch(p){}try{return a.queryCommandEnabled(f)}catch(p){return!!b[f]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return a()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},
clearsContentEditableCorrectly:function(){return g||d||h},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return g||a()||d},autoScrollsToCaret:function(){return!h},autoClosesUnclosedTags:function(){var a=b.cloneNode(!1);a.innerHTML="<p><div></div>";a=a.innerHTML.toLowerCase();var d="<p></p><div></div>"===a||"<p><div></div></p>"===a;this.autoClosesUnclosedTags=function(){return d};return d},supportsNativeGetElementsByClassName:function(){return-1!==
String(document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return d},supportsSpeechApiOn:function(a){return 11<=(e.match(/Chrome\/(\d+)/)||[void 0,0])[1]&&("onwebkitspeechchange"in a||"speech"in a)},crashesWhenDefineProperty:function(d){return a(9)&&("XMLHttpRequest"===d||"XDomainRequest"===d)},doesAsyncFocus:function(){return a(12,">")},hasProblemsSettingCaretAfterImg:function(){return a()},
hasLiDeletingProblem:function(){return a()},hasUndoInContextMenu:function(){return g||f||d},hasInsertNodeIssue:function(){return d},hasIframeFocusIssue:function(){return a()},createsNestedInvalidMarkupAfterPaste:function(){return h},hasCaretBlockElementIssue:function(){return h},supportsMutationEvents:function(){return"MutationEvent"in window},supportsMutationObserver:function(){return"MutationObserver"in window},supportsModernPaste:function(){return!a()},fixStyleKey:function(a){return"cssFloat"===
a?"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat":a},usesControlRanges:function(){return document.body&&"createControlRange"in document.body},hasCaretAtLinkEndInsertionProblems:function(){return h}}}();
wysihtml.lang.array=function(a){return{contains:function(e){if(Array.isArray(e)){for(var b=e.length;b--;)if(-1!==wysihtml.lang.array(a).indexOf(e[b]))return!0;return!1}return-1!==wysihtml.lang.array(a).indexOf(e)},indexOf:function(e){if(a.indexOf)return a.indexOf(e);for(var b=0,g=a.length;b<g;b++)if(a[b]===e)return b;return-1},without:function(e){e=wysihtml.lang.array(e);for(var b=[],g=0,h=a.length;g<h;g++)e.contains(a[g])||b.push(a[g]);return b},get:function(){for(var e=0,b=a.length,g=[];e<b;e++)g.push(a[e]);
return g},map:function(e,b){if(Array.prototype.map)return a.map(e,b);for(var g=a.length>>>0,h=Array(g),f=0;f<g;f++)h[f]=e.call(b,a[f],f,a);return h},unique:function(){for(var e=[],b=a.length,g=0;g<b;)wysihtml.lang.array(e).contains(a[g])||e.push(a[g]),g++;return e}}};
wysihtml.lang.Dispatcher=Base.extend({on:function(a,e){this.events=this.events||{};this.events[a]=this.events[a]||[];this.events[a].push(e);return this},off:function(a,e){this.events=this.events||{};var b=0,g;if(a){var h=this.events[a]||[];for(g=[];b<h.length;b++)h[b]!==e&&e&&g.push(h[b]);this.events[a]=g}else this.events={};return this},fire:function(a,e){this.events=this.events||{};a=this.events[a]||[];for(var b=0;b<a.length;b++)a[b].call(this,e);return this},observe:function(){return this.on.apply(this,
arguments)},stopObserving:function(){return this.off.apply(this,arguments)}});
wysihtml.lang.object=function(a){return{merge:function(e,b){for(var g in e)b&&wysihtml.lang.object(e[g]).isPlainObject()&&("undefined"===typeof a[g]||wysihtml.lang.object(a[g]).isPlainObject())?"undefined"===typeof a[g]?a[g]=wysihtml.lang.object(e[g]).clone(!0):wysihtml.lang.object(a[g]).merge(wysihtml.lang.object(e[g]).clone(!0)):a[g]=wysihtml.lang.object(e[g]).isPlainObject()?wysihtml.lang.object(e[g]).clone(!0):e[g];return this},difference:function(e){var b={},g;for(g in a)a.hasOwnProperty(g)&&
(e.hasOwnProperty(g)||(b[g]=a[g]));for(var h in e)e.hasOwnProperty(h)&&(a.hasOwnProperty(h)&&a[h]===e[h]||(b[0]=a[0]));return b},get:function(){return a},clone:function(e){var b={},g;if(null===a||!wysihtml.lang.object(a).isPlainObject())return a;for(g in a)a.hasOwnProperty(g)&&(b[g]=e?wysihtml.lang.object(a[g]).clone(e):a[g]);return b},isArray:function(){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(){return"[object Function]"===Object.prototype.toString.call(a)},
isPlainObject:function(){return a&&"[object Object]"===Object.prototype.toString.call(a)&&!("Node"in window?a instanceof Node:a instanceof Element||a instanceof Text)},isEmpty:function(){for(var e in a)if(a.hasOwnProperty(e))return!1;return!0}}};
(function(){var a=/^\s+/,e=/\s+$/,b=/[&<>\t"]/g,g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml.lang.string=function(h){h=String(h);return{trim:function(){return h.replace(a,"").replace(e,"")},interpolate:function(a){for(var d in a)h=this.replace("#{"+d+"}").by(a[d]);return h},replace:function(a){return{by:function(d){return h.split(a).join(d)}}},escapeHTML:function(a,d){var f=h.replace(b,function(a){return g[a]});a&&(f=f.replace(/(?:\r\n|\r|\n)/g,"<br />"));d&&(f=f.replace(/  /gi,
"&nbsp; "));return f}}}})();
(function(a){function e(a){return a.replace(h,function(a,b){a=(b.match(f)||[])[1]||"";var e=d[a];b=b.replace(f,"");b.split(e).length>b.split(a).length&&(b+=a,a="");var k=e=b;100<b.length&&(k=k.substr(0,100)+"...");"www."===e.substr(0,4)&&(e="http://"+e);return'<a href="'+e+'">'+k+"</a>"+a})}function b(d,f){if(!(g.contains(d.nodeName)||d.className&&a.lang.array(d.className.split(" ")).contains(f)))if(d.nodeType===a.TEXT_NODE&&d.data.match(h)){f=d.parentNode;var k=a.lang.string(d.data).escapeHTML();var l=
f.ownerDocument;var p=l._wysihtml_tempElement;p||(p=l._wysihtml_tempElement=l.createElement("div"));l=p;l.innerHTML="<span></span>"+e(k);for(l.removeChild(l.firstChild);l.firstChild;)f.insertBefore(l.firstChild,d);f.removeChild(d)}else{k=a.lang.array(d.childNodes).get();l=k.length;for(p=0;p<l;p++)b(k[p],f);return d}}var g=a.lang.array("CODE PRE A SCRIPT HEAD TITLE STYLE".split(" ")),h=/((https?:\/\/|www\.)[^\s<]{3,})/gi,f=/([^\w\/\-](,?))$/i,d={")":"(","]":"[","}":"{"};a.dom.autoLink=function(d,f){a:{var e=
d;for(var k;e.parentNode;){e=e.parentNode;k=e.nodeName;if(e.className&&a.lang.array(e.className.split(" ")).contains(f)||g.contains(k)){e=!0;break a}if("body"===k)break}e=!1}if(e)return d;d===d.ownerDocument.documentElement&&(d=d.ownerDocument.body);return b(d,f)};a.dom.autoLink.URL_REG_EXP=h})(wysihtml);
(function(a){var e=a.dom;e.addClass=function(a,g){var b=a.classList;if(b)return b.add(g);e.hasClass(a,g)||(a.className+=" "+g)};e.removeClass=function(a,e){var b=a.classList;if(b)return b.remove(e);a.className=a.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ")};e.hasClass=function(a,e){var b=a.classList;if(b)return b.contains(e);a=a.className;return 0<a.length&&(a==e||(new RegExp("(^|\\s)"+e+"(\\s|$)")).test(a))}})(wysihtml);
wysihtml.dom.compareDocumentPosition=function(){return document.documentElement.compareDocumentPosition?function(a,e){return a.compareDocumentPosition(e)}:function(a,e){if(a===e)return 0;if(a===e.ownerDocument)return 20;if(a.ownerDocument===e)return 10;if((9===a.nodeType?a:a.ownerDocument)!==(9===e.nodeType?e:e.ownerDocument))return 1;if(2===a.nodeType&&a.childNodes&&-1!==wysihtml.lang.array(a.childNodes).indexOf(e))return 20;if(2===e.nodeType&&e.childNodes&&-1!==wysihtml.lang.array(e.childNodes).indexOf(a))return 10;
for(var b=a,g=[];b;){if(b==e)return 10;g.push(b);b=b.parentNode}b=e;for(e=null;b;){if(b==a)return 20;var h=wysihtml.lang.array(g).indexOf(b);if(-1!==h)return a=g[h],g=wysihtml.lang.array(a.childNodes).indexOf(g[h-1]),e=wysihtml.lang.array(a.childNodes).indexOf(e),g>e?2:4;e=b;b=b.parentNode}return 1}}();
wysihtml.dom.contains=function(){var a=document.documentElement;if(a.contains)return function(a,b){if(b.nodeType!==wysihtml.ELEMENT_NODE){if(b.parentNode===a)return!0;b=b.parentNode}return a!==b&&a.contains(b)};if(a.compareDocumentPosition)return function(a,b){return!!(a.compareDocumentPosition(b)&16)}}();
(function(a){var e=document;a.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView||this.element.ownerDocument.parentWindow},getDocument:function(){return this.element.ownerDocument},constructor:function(b,e,h){this.callback=b||a.EMPTY_FUNCTION;this.config=a.lang.object({}).merge(e).get();this.config.className||(this.config.className="wysihtml-sandbox");this.element=h?this._bindElement(h):this._createElement()},
destroy:function(){},_createElement:function(){var a=e.createElement("div");a.className=this.config.className;this._loadElement(a);return a},_bindElement:function(a){a.className=a.className?a.className+" wysihtml-sandbox":"wysihtml-sandbox";this._loadElement(a,!0);return a},_loadElement:function(a,e){var b=this;e||(e=this._getHtml(),a.innerHTML=e);this.loaded=!0;setTimeout(function(){b.callback(b)},0)},_getHtml:function(a){return""}})})(wysihtml);
wysihtml.dom.convertToList=function(){function a(a,b){a=a.createElement("li");b.appendChild(a);return a}return function(e,b,g){if("UL"===e.nodeName||"OL"===e.nodeName||"MENU"===e.nodeName)return e;var h=e.ownerDocument;b=h.createElement(b);var f=e.querySelectorAll("br"),d=f.length,k,l,n;for(n=0;n<d;n++)for(l=f[n];(k=l.parentNode)&&k!==e&&k.lastChild===l;){if("block"===wysihtml.dom.getStyle("display").from(k)){k.removeChild(l);break}wysihtml.dom.insert(l).after(l.parentNode)}k=wysihtml.lang.array(e.childNodes).get();
f=k.length;for(n=0;n<f;n++){var m=m||a(h,b);d=k[n];l="block"===wysihtml.dom.getStyle("display").from(d);var p="BR"===d.nodeName;!l||g&&wysihtml.dom.hasClass(d,g)?p?m=m.firstChild?null:m:m.appendChild(d):(m=m.firstChild?a(h,b):m,m.appendChild(d),m=null)}0===k.length&&a(h,b);e.parentNode.replaceChild(b,e);return b}}();wysihtml.dom.copyAttributes=function(a){return{from:function(e){return{to:function h(g){for(var f,d=0,k=a.length;d<k;d++)f=a[d],"undefined"!==typeof e[f]&&""!==e[f]&&(g[f]=e[f]);return{andTo:h}}}}}};
(function(a){var e=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],b=function(b){a:{var g=0;for(var f=e.length;g<f;g++)if("border-box"===a.getStyle(e[g]).from(b)){g=e[g];break a}g=void 0}return g?parseInt(a.getStyle("width").from(b),10)<b.offsetWidth:!1};a.copyStyles=function(g){return{from:function(h){b(h)&&(g=wysihtml.lang.array(g).without(e));for(var f="",d=g.length,k=0,l;k<d;k++)l=g[k],f+=l+":"+a.getStyle(l).from(h)+";";return{to:function p(d){a.setStyles(f).on(d);return{andTo:p}}}}}}})(wysihtml.dom);
(function(a){a.dom.delegate=function(a,b,g,h){var f=function(d){var f=d.target;f=3===f.nodeType?f.parentNode:f;for(var e=a.querySelectorAll(b),g=0,m=e.length;g<m;g++)e[g].contains(f)&&h.call(e[g],d)};a.addEventListener(g,f,!1);return{stop:function(){a.removeEventListener(g,f,!1)}}}})(wysihtml);
(function(a){function e(a,e){for(var b=[a];e&&a&&a!==e||!e&&a;)b.unshift(a),a=a.parentNode;return b}a.dom.domNode=function(b){var g=[a.ELEMENT_NODE,a.TEXT_NODE];return{is:{emptyTextNode:function(e){e=e?/^\s*$/g:/^[\r\n]*$/g;return b&&b.nodeType===a.TEXT_NODE&&e.test(b.data)},rangyBookmark:function(){return b&&1===b.nodeType&&b.classList.contains("rangySelectionBoundary")},visible:function(){var e=!/^\s*$/g.test(a.dom.getTextContent(b));e||1===b.nodeType&&b.querySelector("img, br, hr, object, embed, canvas, input, textarea")&&
(e=!0);return e},lineBreak:function(){return b&&1===b.nodeType&&"BR"===b.nodeName},block:function(){return b&&1===b.nodeType&&"block"===b.ownerDocument.defaultView.getComputedStyle(b).display},voidElement:function(){return a.dom.domNode(b).test({query:a.VOID_ELEMENTS})}},prev:function(e){var f=b.previousSibling,d=e&&e.nodeTypes?e.nodeTypes:g;return f?a.dom.domNode(f).is.rangyBookmark()||!a.lang.array(d).contains(f.nodeType)||e&&e.ignoreBlankTexts&&a.dom.domNode(f).is.emptyTextNode(!0)?a.dom.domNode(f).prev(e):
f:null},next:function(e){var f=b.nextSibling,d=e&&e.nodeTypes?e.nodeTypes:g;return f?a.dom.domNode(f).is.rangyBookmark()||!a.lang.array(d).contains(f.nodeType)||e&&e.ignoreBlankTexts&&a.dom.domNode(f).is.emptyTextNode(!0)?a.dom.domNode(f).next(e):f:null},commonAncestor:function(a,f){var d=e(b,f);a=e(a,f);if(d[0]!=a[0])return null;for(f=0;f<d.length;f++)if(d[f]!=a[f])return d[f-1];return null},lastLeafNode:function(e){if(1!==b.nodeType)return b;var f=b.lastChild;if(!f)return b;if(e&&e.leafClasses)for(var d=
e.leafClasses.length;d--;)if(a.dom.hasClass(b,e.leafClasses[d]))return b;return a.dom.domNode(f).lastLeafNode(e)},escapeParent:function(e,f){var d,k=b;if(!a.dom.contains(e,b))throw Error("Child is not a descendant of node.");do{var g=k.parentNode;for(d=g.cloneNode(!1);g.lastChild&&g.lastChild!==k;)d.insertBefore(g.lastChild,d.firstChild);if(g!==e){var h=g.cloneNode(!1);h.appendChild(k);k=h}g.parentNode.insertBefore(k,g.nextSibling);if(""!==d.innerHTML)if(/^\s+$/.test(d.innerHTML))for(;d.lastChild;)g.parentNode.insertBefore(d.lastChild,
k.nextSibling);else g.parentNode.insertBefore(d,k.nextSibling);if(""===g.innerHTML)g.parentNode.removeChild(g);else if(/^\s+$/.test(g.innerHTML)){for(;g.firstChild;)g.parentNode.insertBefore(g.firstChild,g);g.parentNode.removeChild(g)}}while(g&&g!==e);f&&k&&(k.parentNode.insertBefore(f,k),f.appendChild(k))},transferContentTo:function(e,f){if(1===b.nodeType){if(a.dom.domNode(e).is.voidElement()||3===e.nodeType)for(;b.lastChild;)e.parentNode.insertBefore(b.lastChild,e.nextSibling);else for(;b.firstChild;)e.appendChild(b.firstChild);
f&&b.parentNode.removeChild(b)}else if(3===b.nodeType||8===b.nodeType)a.dom.domNode(e).is.voidElement()?e.parentNode.insertBefore(b,e.nextSibling):e.appendChild(b)},test:function(e){if(!e||1!==b.nodeType||e.query&&!b.matches(e.query)||e.nodeName&&b.nodeName.toLowerCase()!==e.nodeName.toLowerCase()||e.className&&!b.classList.contains(e.className)||e.classRegExp&&0===((b.className||"").match(e.classRegExp)||[]).length)return!1;if(e.styleProperty&&0<e.styleProperty.length){var f=Array.isArray(e.styleProperty)?
e.styleProperty:[e.styleProperty];for(var d=f.length;0<d;){f=a.browser.fixStyleKey(f[0]);if(b.style[f])if(e.styleValue)if(e.styleValue instanceof RegExp){if(0<b.style[f].trim().match(e.styleValue).length)break}else if(Array.isArray(e.styleValue)){if(e.styleValue.indexOf(b.style[f].trim()))break}else{if(e.styleValue===b.style[f].trim().replace(/, /g,","))break}else break;return!1}}if(e.attribute){f=a.dom.getAttributes(b);d=[];var k=!1;Array.isArray(e.attribute)?d=e.attribute:d[e.attribute]=e.attributeValue;
for(var g in d)if(d.hasOwnProperty(g))if("undefined"===typeof d[g]){if("undefined"!==typeof f[g]){k=!0;break}}else if(f[g]===d[g]){k=!0;break}if(!k)return!1}return!0}}}})(wysihtml);
wysihtml.dom.getAsDom=function(){var a="abbr article aside audio bdi canvas command datalist details figcaption figure footer header hgroup keygen mark meter nav output progress rp rt ruby svg section source summary time track video wbr".split(" ");return function(e,b){b=b||document;if("object"===typeof e&&e.nodeType)b=b.createElement("div"),b.appendChild(e);else if(wysihtml.browser.supportsHTML5Tags(b))b=b.createElement("div"),b.innerHTML=e;else{var g=b;if(!g._wysihtml_supportsHTML5Tags){for(var h=
0,f=a.length;h<f;h++)g.createElement(a[h]);g._wysihtml_supportsHTML5Tags=!0}g=b.createElement("div");g.style.display="none";b.body.appendChild(g);try{g.innerHTML=e}catch(d){}b.body.removeChild(g);b=g}return b}}();wysihtml.dom.getAttribute=function(a,e){var b=!wysihtml.browser.supportsGetAttributeCorrectly();e=e.toLowerCase();return"IMG"==a.nodeName&&"src"==e&&!0===wysihtml.dom.isLoadedImage(a)?a.src:b&&"outerHTML"in a?-1!=a.outerHTML.toLowerCase().indexOf(" "+e+"=")?a.getAttribute(e):null:a.getAttribute(e)};
wysihtml.dom.getAttributes=function(a){var e=!wysihtml.browser.supportsGetAttributeCorrectly(),b=a.nodeName,g=[],h;for(h in a.attributes)(a.attributes.hasOwnProperty&&a.attributes.hasOwnProperty(h)||!a.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(a.attributes,h))&&a.attributes[h].specified&&("IMG"==b&&"src"==a.attributes[h].name.toLowerCase()&&!0===wysihtml.dom.isLoadedImage(a)?g.src=a.src:wysihtml.lang.array(["rowspan","colspan"]).contains(a.attributes[h].name.toLowerCase())&&
e?1!==a.attributes[h].value&&(g[a.attributes[h].name]=a.attributes[h].value):g[a.attributes[h].name]=a.attributes[h].value);return g};wysihtml.dom.getParentElement=function(){return function(a,e,b,g){for(b=b||50;b--&&a&&"BODY"!==a.nodeName&&(!g||a!==g);){if(wysihtml.dom.domNode(a).test(e))return a;a=a.parentNode}return null}}();
wysihtml.dom.getPastedHtml=function(a){var e;wysihtml.browser.supportsModernPaste()&&a.clipboardData&&(wysihtml.lang.array(a.clipboardData.types).contains("text/html")?e=a.clipboardData.getData("text/html"):wysihtml.lang.array(a.clipboardData.types).contains("text/plain")&&(e=wysihtml.lang.string(a.clipboardData.getData("text/plain")).escapeHTML(!0,!0)));return e};
wysihtml.dom.getPastedHtmlWithDiv=function(a,e){var b=a.selection.getBookmark(),g=a.element.ownerDocument,h=g.createElement("DIV"),f=a.getScrollPos();g.body.appendChild(h);h.style.width="1px";h.style.height="1px";h.style.overflow="hidden";h.style.position="absolute";h.style.top=f.y+"px";h.style.left=f.x+"px";h.setAttribute("contenteditable","true");h.focus();setTimeout(function(){var d;a.selection.setBookmark(b);(d=h.innerHTML)&&/^<br\/?>$/i.test(d.trim())&&(d=!1);e(d);h.parentNode.removeChild(h)},
0)};
wysihtml.dom.getStyle=function(){function a(a){return a.replace(b,function(a){return a.charAt(1).toUpperCase()})}var e={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},b=/\-[a-z]/g;return function(b){return{from:function(g){if(g.nodeType===wysihtml.ELEMENT_NODE){var f=g.ownerDocument,d=e[b]||a(b),k=g.style,l=g.currentStyle,h=k[d];if(h)return h;if(l)try{return l[d]}catch(p){}d=f.defaultView||f.parentWindow;f=("height"===b||"width"===b)&&"TEXTAREA"===g.nodeName;if(d.getComputedStyle){if(f){var m=
k.overflow;k.overflow="hidden"}g=d.getComputedStyle(g,null).getPropertyValue(b);f&&(k.overflow=m||"");return g}}}}}}();wysihtml.dom.getTextNodes=function(a,e){var b=[];for(a=a.firstChild;a;a=a.nextSibling)3==a.nodeType?e&&/^\s*$/.test(a.innerText||a.textContent)||b.push(a):b=b.concat(wysihtml.dom.getTextNodes(a,e));return b};
(function(a){var e={},b=1;a.dom.hasElementWithClassName=function(g,h){if(!a.browser.supportsNativeGetElementsByClassName())return!!g.querySelector("."+h);var f=(g._wysihtml_identifier||(g._wysihtml_identifier=b++))+":"+h,d=e[f];d||(d=e[f]=g.getElementsByClassName(h));return 0<d.length}})(wysihtml);wysihtml.dom.hasElementWithTagName=function(){var a={},e=1;return function(b,g){var h=(b._wysihtml_identifier||(b._wysihtml_identifier=e++))+":"+g,f=a[h];f||(f=a[h]=b.getElementsByTagName(g));return 0<f.length}}();
wysihtml.dom.insert=function(a){return{after:function(e){e.parentNode.insertBefore(a,e.nextSibling)},before:function(e){e.parentNode.insertBefore(a,e)},into:function(e){e.appendChild(a)}}};wysihtml.dom.insertCSS=function(a){a=a.join("\n");return{into:function(e){var b=e.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(e.createTextNode(a));var g=e.querySelector("head link");g?g.parentNode.insertBefore(b,g):(e=e.querySelector("head"))&&e.appendChild(b)}}};
wysihtml.dom.isLoadedImage=function(a){try{return a.complete&&!a.mozMatchesSelector(":-moz-broken")}catch(e){if(a.complete&&"complete"===a.readyState)return!0}};
(function(a){a.dom.lineBreaks=function(e){function b(b){return"BR"===b.nodeName||"block"===a.dom.getStyle("display").from(b)?!0:!1}return{add:function(g){g=e.ownerDocument;var h=a.dom.domNode(e).next({ignoreBlankTexts:!0}),f=a.dom.domNode(e).prev({ignoreBlankTexts:!0});h&&!b(h)&&a.dom.insert(g.createElement("br")).after(e);f&&!b(f)&&a.dom.insert(g.createElement("br")).before(e)},remove:function(b){b=a.dom.domNode(e).next({ignoreBlankTexts:!0});var g=a.dom.domNode(e).prev({ignoreBlankTexts:!0});b&&
"BR"===b.nodeName&&b.parentNode.removeChild(b);g&&"BR"===g.nodeName&&g.parentNode.removeChild(g)}}}})(wysihtml);
wysihtml.dom.observe=function(a,e,b){e="string"===typeof e?[e]:e;for(var g,h,f=0,d=e.length;f<d;f++)h=e[f],a.addEventListener?a.addEventListener(h,b,!1):(g=function(d){"target"in d||(d.target=d.srcElement);d.preventDefault=d.preventDefault||function(){this.returnValue=!1};d.stopPropagation=d.stopPropagation||function(){this.cancelBubble=!0};b.call(a,d)},a.attachEvent("on"+h,g));return{stop:function(){for(var d,f=0,h=e.length;f<h;f++)d=e[f],a.removeEventListener?a.removeEventListener(d,b,!1):a.detachEvent("on"+
d,g)}}};
wysihtml.dom.parse=function(a,e){function b(a,f,e,g){var h=a.nodeType,l=a.childNodes,n=l.length,m=d[h],t;if(g&&1===h&&wysihtml.dom.hasClass(a,g))return a;var D=m&&m(a,e);if(!D){if(!1===D){h=a.ownerDocument.createDocumentFragment();for(m=n;m--;)l[m]&&(t=b(l[m],f,e,g))&&(l[m]===t&&m--,h.insertBefore(t,h.firstChild));f=wysihtml.dom.getStyle("display").from(a);""===f&&(f=wysihtml.lang.array(p).contains(a.tagName)?"block":"");wysihtml.lang.array(["block","flex","table"]).contains(f)&&h.appendChild(a.ownerDocument.createElement("br"));wysihtml.lang.array("div pre p table td th ul ol li dd dl footer header section h1 h2 h3 h4 h5 h6".split(" ")).contains(a.nodeName.toLowerCase())&&
a.parentNode.lastChild!==a&&(a.nextSibling&&3===a.nextSibling.nodeType&&/^\s/.test(a.nextSibling.nodeValue)||h.appendChild(a.ownerDocument.createTextNode(" ")));h.normalize&&h.normalize();return h}return null}for(m=0;m<n;m++)l[m]&&(t=b(l[m],f,e,g))&&(l[m]===t&&m--,D.appendChild(t));if(f&&D.nodeName.toLowerCase()===k&&(!D.childNodes.length||/^\s*$/gi.test(D.innerHTML)&&(e||"_wysihtml-temp-placeholder"!==a.className&&"rangySelectionBoundary"!==a.className)||!D.attributes.length)){for(h=D.ownerDocument.createDocumentFragment();D.firstChild;)h.appendChild(D.firstChild);
h.normalize&&h.normalize();return h}D.normalize&&D.normalize();return D}function g(a,d){var b=a.getAttribute("class"),f=a.getAttribute("style"),e,k;if(d.methods)for(g in d.methods)if(d.methods.hasOwnProperty(g)&&w[g]&&w[g](a))return!0;if(b&&d.classes){b=b.replace(/^\s+/g,"").replace(/\s+$/g,"").split(l);var g=b.length;for(var h=0;h<g;h++)if(d.classes[b[h]])return!0}if(f&&d.styles)for(e in f=f.split(";"),d.styles)if(d.styles.hasOwnProperty(e))for(g=f.length;g--;)if(b=f[g].split(":"),b[0].replace(/\s/g,
"").toLowerCase()===e&&(!0===d.styles[e]||1===d.styles[e]||wysihtml.lang.array(d.styles[e]).contains(b[1].replace(/\s/g,"").toLowerCase())))return!0;if(d.attrs)for(k in d.attrs)if(d.attrs.hasOwnProperty(k)&&(f=wysihtml.dom.getAttribute(a,k),"string"===typeof f&&-1<f.search(d.attrs[k])))return!0;return!1}function h(a,d,b,f){if(a=wysihtml.lang.object(b).isFunction()?b:q[b])if(d=a(d,f),"string"===typeof d)return d;return!1}function f(a,d){var b=wysihtml.lang.object(m.attributes||{}).clone();d=wysihtml.lang.object(b).merge(wysihtml.lang.object(d||
{}).clone()).get();b={};var f=wysihtml.dom.getAttributes(a),e;for(e in d)if(/\*$/.test(e)){var k=void 0;var g=e.slice(0,-1);var l=f,n=[];for(k in l)l.hasOwnProperty(k)&&0===k.indexOf(g)&&n.push(k);g=n;l=0;for(n=g.length;l<n;l++)k=h(g[l],f[g[l]],d[e],a.nodeName),!1!==k&&(b[g[l]]=k)}else k=h(e,f[e],d[e],a.nodeName),!1!==k&&(b[e]=k);return b}var d={1:function(a,d){var b=m.tags;var e=a.nodeName.toLowerCase();var h=a.scopeName;if(a._wysihtml)return null;a._wysihtml=1;if("wysihtml-temp"===a.className)return null;
h&&"HTML"!=h&&(e=h+":"+e);"outerHTML"in a&&(wysihtml.browser.autoClosesUnclosedTags()||"P"!==a.nodeName||"</p>"===a.outerHTML.slice(-4).toLowerCase()||(e="div"));if(e in b){b=b[e];if(!b||b.remove)return null;if(b.unwrap)return!1;b="string"===typeof b?{rename_tag:b}:b}else if(a.firstChild)b={rename_tag:k};else return null;if(h=b.one_of_type){a:{h=m;var n=b.one_of_type;if("SPAN"!==a.nodeName||d||"_wysihtml-temp-placeholder"!==a.className&&"rangySelectionBoundary"!==a.className){for(E in n)if(n.hasOwnProperty(E)&&
h.type_definitions&&h.type_definitions[E]){var p=h.type_definitions[E];if(g(a,p)){var E=!0;break a}}E=!1}else E=!0}h=!E}if(h)if(b.remove_action){if("unwrap"===b.remove_action)return!1;if("rename"===b.remove_action)var v=b.remove_action_rename_to||k;else return null}else return null;e=a.ownerDocument.createElement(v||b.rename_tag||e);var q=b;v={};var G=q.set_class,r=q.add_class,C=q.add_style,w=q.set_attributes;E=m.classes;h=0;n=[];p=[];var H=[];w&&(v=wysihtml.lang.object(w).clone());v=wysihtml.lang.object(v).merge(f(a,
q.check_attributes)).get();G&&n.push(G);if(r)for(N in r)if(q=y[r[N]])q=q(wysihtml.dom.getAttribute(a,N)),"string"===typeof q&&n.push(q);if(C)for(N in C)if(q=x[C[N]])newStyle=q(wysihtml.dom.getAttribute(a,N)),"string"===typeof newStyle&&p.push(newStyle);if("string"===typeof E&&"any"===E)if(a.getAttribute("class"))if(m.classes_blacklist){(r=a.getAttribute("class"))&&(n=n.concat(r.split(l)));for(r=n.length;h<r;h++)C=n[h],m.classes_blacklist[C]||H.push(C);H.length&&(v["class"]=wysihtml.lang.array(H).unique().join(" "))}else v["class"]=
a.getAttribute("class");else n&&0<n.length&&(v["class"]=wysihtml.lang.array(n).unique().join(" "));else{d||(E["_wysihtml-temp-placeholder"]=1,E._rangySelectionBoundary=1,E["wysiwyg-tmp-selected-cell"]=1);(r=a.getAttribute("class"))&&(n=n.concat(r.split(l)));for(r=n.length;h<r;h++)C=n[h],E[C]&&H.push(C);H.length&&(v["class"]=wysihtml.lang.array(H).unique().join(" "))}v["class"]&&d&&(v["class"]=v["class"].replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(v["class"])&&delete v["class"]);p.length&&
(v.style=wysihtml.lang.array(p).unique().join(" "));for(N in v)try{e.setAttribute(N,v[N])}catch(la){}v.src&&("undefined"!==typeof v.width&&e.setAttribute("width",v.width),"undefined"!==typeof v.height&&e.setAttribute("height",v.height));d=b;var B;if(d&&d.keep_styles)for(B in d.keep_styles)if(d.keep_styles.hasOwnProperty(B)){var N="float"===B?a.style.styleFloat||a.style.cssFloat:a.style[B];d.keep_styles[B]instanceof RegExp&&!d.keep_styles[B].test(N)||("float"===B?e.style[a.style.styleFloat?"styleFloat":
"cssFloat"]=N:a.style[B]&&(e.style[B]=N))}e.normalize&&e.normalize();return e},3:function(a){var d=a.nextSibling;if(d&&d.nodeType===wysihtml.TEXT_NODE)d.data=a.data.replace(wysihtml.INVISIBLE_SPACE_REG_EXP,"")+d.data.replace(wysihtml.INVISIBLE_SPACE_REG_EXP,"");else return d=a.data.replace(wysihtml.INVISIBLE_SPACE_REG_EXP,""),a.ownerDocument.createTextNode(d)},8:function(a){if(m.comments)return a.ownerDocument.createComment(a.nodeValue)}},k="span",l=/\s+/,n={tags:{},classes:{}},m={},p="ADDRESS BLOCKQUOTE CENTER DIR DIV DL FIELDSET FORM H1 H2 H3 H4 H5 H6 ISINDEX MENU NOFRAMES NOSCRIPT OL P PRE TABLE UL".split(" "),
q={url:function(){var a=/^https?:\/\//i;return function(d){return d&&d.match(a)?d.replace(a,function(a){return a.toLowerCase()}):null}}(),src:function(){var a=/^(\/|https?:\/\/)/i;return function(d){return d&&d.match(a)?d.replace(a,function(a){return a.toLowerCase()}):null}}(),href:function(){var a=/^(#|\/|https?:\/\/|mailto:|tel:)/i;return function(d){return d&&d.match(a)?d.replace(a,function(a){return a.toLowerCase()}):null}}(),alt:function(){var a=/[^ a-z0-9_\-]/gi;return function(d,b){return d?
d.replace(a,""):"IMG"===b?"":null}}(),numbers:function(){var a=/\D/g;return function(d){return(d=(d||"").replace(a,""))||null}}(),dimension:function(){var a=/\D*(\d+)(\.\d+)?\s?(%)?\D*/;return function(d){return(d=(d||"").replace(a,"$1$2$3"))||null}}(),any:function(){return function(a){return a?a:null}}()},x={align_text:function(){var a={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(d){return a[String(d).toLowerCase()]}}()},y={align_img:function(){var a=
{left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(d){return a[String(d).toLowerCase()]}}(),align_text:function(){var a={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(d){return a[String(d).toLowerCase()]}}(),clear_br:function(){var a={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(d){return a[String(d).toLowerCase()]}}(),
size_font:function(){var a={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(d){return a[String(d).charAt(0)]}}()},w={has_visible_contet:function(){var a,d="img video picture br script noscript style table iframe object embed audio svg input button select textarea canvas".split(" ");
return function(b){if((a=(b.innerText||b.textContent).replace(/\s/g,""))&&0<a.length)return!0;for(var f=d.length;f--;)if(b.querySelector(d[f]))return!0;return b.offsetWidth&&0<b.offsetWidth&&b.offsetHeight&&0<b.offsetHeight?!0:!1}}()},B={unwrap:function(a){wysihtml.dom.unwrap(a)},remove:function(a){a.parentNode.removeChild(a)}};return function(a,d){wysihtml.lang.object(m).merge(n).merge(d.rules).get();var f=d.context||a.ownerDocument||document,e=f.createDocumentFragment(),k="string"===typeof a,g=
!1,h,l;!0===d.clearInternals&&(g=!0);a=k?wysihtml.dom.getAsDom(a,f):a;if(m.selectors)for(h in f=m.selectors,f)if(f.hasOwnProperty(h)){wysihtml.lang.object(f[h]).isFunction()?l=f[h]:"string"===typeof f[h]&&B[f[h]]&&(l=B[f[h]]);var p=a.querySelectorAll(h);for(var q=p.length;q--;)l(p[q])}for(;a.firstChild;)l=a.firstChild,(h=b(l,d.cleanUp,g,d.uneditableClass))&&e.appendChild(h),l!==h&&a.removeChild(l);if(d.unjoinNbsps)for(d=wysihtml.dom.getTextNodes(e),g=d.length;g--;)d[g].nodeValue=d[g].nodeValue.replace(/([\S\u00A0])\u00A0/gi,
"$1 ");a.innerHTML="";a.appendChild(e);return k?wysihtml.quirks.getCorrectInnerHTML(a):a}(a,e)};wysihtml.dom.query=function(a,e){var b=[],g;a.nodeType&&(a=[a]);for(var h=0,f=a.length;h<f;h++)if(g=a[h].querySelectorAll(e))for(var d=g.length;d--;b.unshift(g[d]));return b};wysihtml.dom.removeEmptyTextNodes=function(a){for(var e=wysihtml.lang.array(a.childNodes).get(),b=e.length,g=0;g<b;g++)a=e[g],a.nodeType===wysihtml.TEXT_NODE&&/^[\n\r]*$/.test(a.data)&&a.parentNode.removeChild(a)};
wysihtml.dom.removeInvisibleSpaces=function(a){a=wysihtml.dom.getTextNodes(a);for(var e=a.length;e--;)a[e].nodeValue=a[e].nodeValue.replace(wysihtml.INVISIBLE_SPACE_REG_EXP,"")};wysihtml.dom.renameElement=function(a,e){e=a.ownerDocument.createElement(e);for(var b;b=a.firstChild;)e.appendChild(b);wysihtml.dom.copyAttributes(["align","className"]).from(a).to(e);a.parentNode&&a.parentNode.replaceChild(e,a);return e};
wysihtml.dom.replaceWithChildNodes=function(a){if(a.parentNode){for(;a.firstChild;)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a)}};
(function(a){function e(b){return"block"===a.getStyle("display").from(b)}function b(a){var b=a.ownerDocument.createElement("br");a.appendChild(b)}a.resolveList=function(a,h){if(a.nodeName.match(/^(MENU|UL|OL)$/)){var f=a.ownerDocument,d=f.createDocumentFragment(),k=wysihtml.dom.domNode(a).prev({ignoreBlankTexts:!0}),g=wysihtml.dom.domNode(a).next({ignoreBlankTexts:!0}),n=a.lastElementChild||a.lastChild,m;if(h)for(k&&!e(k)&&"BR"!==k.nodeName&&b(d);k=a.firstElementChild||a.firstChild;){f=k.lastChild;
for(m=k===n;h=k.firstChild;){var p=h===f;p=(!m||g&&!e(g))&&p&&!e(h)&&"BR"!==h.nodeName;d.appendChild(h);p&&b(d)}k.parentNode.removeChild(k)}else for(;k=a.firstElementChild||a.firstChild;){if(k.querySelector&&k.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;h=k.firstChild;)d.appendChild(h);else{for(g=f.createElement("p");h=k.firstChild;)g.appendChild(h);d.appendChild(g)}k.parentNode.removeChild(k)}a.parentNode.replaceChild(d,a)}}})(wysihtml.dom);
(function(a){var e=document,b="parent top opener frameElement frames localStorage globalStorage sessionStorage indexedDB".split(" "),g="open close openDialog showModalDialog alert confirm prompt openDatabase postMessage XMLHttpRequest XDomainRequest".split(" "),h=["referrer","write","open","close"];a.dom.Sandbox=Base.extend({constructor:function(b,d){this.callback=b||a.EMPTY_FUNCTION;this.config=a.lang.object({}).merge(d).get();this.config.className||(this.config.className="wysihtml-sandbox");this.editableArea=
this._createIframe()},insertInto:function(a){"string"===typeof a&&(a=e.getElementById(a));a.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var a=this.getIframe();a.parentNode.removeChild(a)},_readyError:function(){throw Error("wysihtml.Sandbox: Sandbox iframe isn't loaded yet");},_createIframe:function(){var b=this,d=e.createElement("iframe");d.className=this.config.className;
a.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(d);a.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(d.src="javascript:'<html></html>'");d.onload=function(){d.onreadystatechange=d.onload=null;b._onLoadIframe(d)};d.onreadystatechange=function(){/loaded|complete/.test(d.readyState)&&(d.onreadystatechange=d.onload=null,b._onLoadIframe(d))};return d},_onLoadIframe:function(f){if(a.dom.contains(e.documentElement,
f)){var d=this,k=f.contentWindow,l=f.contentWindow.document,n=this._getHtml({charset:e.characterSet||e.charset||"utf-8",stylesheets:this.config.stylesheets});l.open("text/html","replace");l.write(n);l.close();this.getWindow=function(){return f.contentWindow};this.getDocument=function(){return f.contentWindow?f.contentWindow.document:null};k.onerror=function(a,d,b){throw Error("wysihtml.Sandbox: "+a,d,b);};if(!a.browser.supportsSandboxedIframes()){var m;n=0;for(m=b.length;n<m;n++)this._unset(k,b[n]);
n=0;for(m=g.length;n<m;n++)this._unset(k,g[n],a.EMPTY_FUNCTION);n=0;for(m=h.length;n<m;n++)this._unset(l,h[n]);this._unset(l,"cookie","",!0)}a.polyfills&&a.polyfills(k,l).apply();this.loaded=!0;setTimeout(function(){d.callback(d)},0)}},_getHtml:function(b){var d=b.stylesheets,f="",e=0,g;if(d="string"===typeof d?[d]:d)for(g=d.length;e<g;e++)f+='<link rel="stylesheet" href="'+d[e]+'">';b.stylesheets=f;return a.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(b)},
_unset:function(b,d,e,g){try{b[d]=e}catch(m){}try{b.__defineGetter__(d,function(){return e})}catch(m){}if(g)try{b.__defineSetter__(d,function(){})}catch(m){}if(!a.browser.crashesWhenDefineProperty(d))try{var f={get:function(){return e}};g&&(f.set=function(){});Object.defineProperty(b,d,f)}catch(m){}}})})(wysihtml);(function(){var a={className:"class"};wysihtml.dom.setAttributes=function(e){return{on:function(b){for(var g in e)b.setAttribute(a[g]||g,e[g])}}}})();
wysihtml.dom.setStyles=function(a){return{on:function(e){e=e.style;if("string"===typeof a)e.cssText+=";"+a;else for(var b in a)"float"===b?(e.cssFloat=a[b],e.styleFloat=a[b]):e[b]=a[b]}}};
(function(a){a.simulatePlaceholder=function(e,b,g,h){var f=h||"wysihtml-placeholder";h=function(){var d=0<b.element.offsetWidth&&0<b.element.offsetHeight;b.hasPlaceholderSet()&&(b.clear(),b.element.focus(),d&&setTimeout(function(){var a=b.selection.getSelection();a.focusNode&&a.anchorNode||b.selection.selectNode(b.element.firstChild||b.element)},0));b.placeholderSet=!1;a.removeClass(b.element,f)};var d=function(){b.isEmpty()&&!b.placeholderSet&&(b.placeholderSet=!0,b.setValue(g,!1),a.addClass(b.element,
f))};e.on("set_placeholder",d).on("unset_placeholder",h).on("focus:composer",h).on("paste:composer",h).on("blur:composer",d);d()}})(wysihtml.dom);(function(a){var e=document.documentElement;"textContent"in e?(a.setTextContent=function(a,e){a.textContent=e},a.getTextContent=function(a){return a.textContent}):"innerText"in e?(a.setTextContent=function(a,e){a.innerText=e},a.getTextContent=function(a){return a.innerText}):(a.setTextContent=function(a,e){a.nodeValue=e},a.getTextContent=function(a){return a.nodeValue})})(wysihtml.dom);
wysihtml.dom.unwrap=function(a){var e=[];if(a.parentNode){for(;a.lastChild;)e.unshift(a.lastChild),wysihtml.dom.insert(a.lastChild).after(a);a.parentNode.removeChild(a)}return e};
wysihtml.quirks.cleanPastedHTML=function(){return function(a,e){var b={color:wysihtml.dom.getStyle("color").from(e.referenceNode),fontSize:wysihtml.dom.getStyle("font-size").from(e.referenceNode)};a:{var g=e.rules;if(g){for(var h=0,f=g.length;h<f;h++){if(!g[h].condition)var d=g[h].set;if(g[h].condition&&g[h].condition.test(a)){g=g[h].set;break a}}g=d}else g=null}g=wysihtml.lang.object(g||{}).clone(!0);var k,l;for(k in g.tags)if(g.tags.hasOwnProperty(k)&&g.tags[k].keep_styles)for(l in g.tags[k].keep_styles)g.tags[k].keep_styles.hasOwnProperty(l)&&
b[l]&&(d=g.tags[k].keep_styles,h=l,f=wysihtml.lang.string(b[l]).trim().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),d[h]=new RegExp("^((?!^"+f+"$).)*$","i"));return wysihtml.dom.parse(a,{rules:g,cleanUp:!0,context:e.referenceNode.ownerDocument,uneditableClass:e.uneditableClass,clearInternals:!0,unjoinNbsps:!0})}}();
wysihtml.quirks.ensureProperClearing=function(){var a=function(){var a=this;setTimeout(function(){var b=a.innerHTML.toLowerCase();if("<p>&nbsp;</p>"==b||"<p>&nbsp;</p><p>&nbsp;</p>"==b)a.innerHTML=""},0)};return function(e){wysihtml.dom.observe(e.element,["cut","keydown"],a)}}();
(function(a){a.quirks.getCorrectInnerHTML=function(e){var b=e.innerHTML;if(-1===b.indexOf("%7E"))return b;e=e.querySelectorAll("[href*='~'], [src*='~']");var g;var h=0;for(g=e.length;h<g;h++){var f=e[h].href||e[h].src;var d=a.lang.string(f).replace("~").by("%7E");b=a.lang.string(b).replace(d).by(f)}return b}})(wysihtml);
(function(a){a.quirks.redraw=function(e){a.dom.addClass(e,"wysihtml-quirks-redraw");a.dom.removeClass(e,"wysihtml-quirks-redraw");try{var b=e.ownerDocument;b.execCommand("italic",!1,null);b.execCommand("italic",!1,null)}catch(g){}}})(wysihtml);
(function(a){function e(a){var f;for(f in b)if(b.hasOwnProperty(f)){var d=b[f];if(d.regex.test(a))return d}}var b={rgba:{regex:/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,name:"rgba"},rgb:{regex:/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,name:"rgb"},hex6:{regex:/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,name:"hex",radix:16},hex3:{regex:/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,name:"hex",radix:16}},g=function(a){return new RegExp("(^|\\s|;)"+
a+"\\s*:\\s*[^;$]+","gi")};a.quirks.styleParser={getColorParseMethod:e,getColorFormat:function(a){return(a=e(a))?a.name:void 0},parseColor:function(h,f){var d,k,l=h;if(f){f=g(f);if(!(h=h.match(f)))return!1;h=h.pop().split(":")[1];l=a.lang.string(h).trim()}if(!(d=e(l))||!(k=l.match(d.regex)))return!1;var n=d.radix||10;if(d===b.hex3)return k.shift(),k.push(1),a.lang.array(k).map(function(a,d){return 3>d?parseInt(a,n)*n+parseInt(a,n):parseFloat(a)});k.shift();k[3]||k.push(1);return a.lang.array(k).map(function(a,
d){return 3>d?parseInt(a,n):parseFloat(a)})},unparseColor:function(a,b){return"hex"===b?(a[0].toString(16)+a[1].toString(16)+a[2].toString(16)).toUpperCase():"hash"===b?"#"+(a[0].toString(16)+a[1].toString(16)+a[2].toString(16)).toUpperCase():"rgb"===b?"rgb("+a[0]+","+a[1]+","+a[2]+")":"rgba"===b?"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":"csv"===b?a[0]+","+a[1]+","+a[2]+","+a[3]:a[3]&&1!==a[3]?"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":"rgb("+a[0]+","+a[1]+","+a[2]+")"},parseFontSize:function(b){return(b=
b.match(g("font-size")))?a.lang.string(b[b.length-1].split(":")[1]).trim():!1}}})(wysihtml);
(function(a){function e(a,d){for(var b=0;d!==a;)if(b++,d=d.parentNode,!d)throw Error("not a descendant of ancestor!");return b}function b(a,d){return 3===a.nodeType?a:a.childNodes[d]||a}function g(b){var d=document.createElement("span"),e=function(a){b.removeEventListener("mouseup",e);b.removeEventListener("keydown",e);b.removeEventListener("touchstart",e);b.removeEventListener("focus",e);b.removeEventListener("blur",e);b.removeEventListener("paste",f);b.removeEventListener("drop",f);b.removeEventListener("beforepaste",
f);d&&d.parentNode&&d.parentNode.removeChild(d)},f=function(a){d&&d.parentNode&&setTimeout(e,0)};d.appendChild(b.ownerDocument.createTextNode(a.INVISIBLE_SPACE));d.className="_wysihtml-temp-caret-fix";d.style.display="block";d.style.minWidth="1px";d.style.height="0px";b.addEventListener("mouseup",e);b.addEventListener("keydown",e);b.addEventListener("touchstart",e);b.addEventListener("focus",e);b.addEventListener("blur",e);b.addEventListener("paste",f);b.addEventListener("drop",f);b.addEventListener("beforepaste",
f);return d}var h=a.dom;a.Selection=Base.extend({constructor:function(a,d,b){rangy.init();this.editor=a;this.composer=a.composer;this.doc=this.composer.doc;this.win=this.composer.win;this.contain=d;this.unselectableClass=b||!1},getBookmark:function(){var a=this.getRange();return a&&a.cloneRange()},setBookmark:function(a){a&&this.setSelection(a)},setBefore:function(a){var d=rangy.createRange(this.doc);d.setStartBefore(a);d.setEndBefore(a);return this.setSelection(d)},createTemporaryCaretSpaceAfter:function(b){var d=
this.doc.createElement("span"),e=this.doc.createTextNode(a.INVISIBLE_SPACE),f=function(b){this.contain.removeEventListener("mouseup",f);this.contain.removeEventListener("keydown",h);this.contain.removeEventListener("touchstart",f);this.contain.removeEventListener("focus",f);this.contain.removeEventListener("blur",f);this.contain.removeEventListener("paste",g);this.contain.removeEventListener("drop",g);this.contain.removeEventListener("beforepaste",g);d&&d.parentNode&&(d.innerHTML=d.innerHTML.replace(a.INVISIBLE_SPACE_REG_EXP,
""),/[^\s]+/.test(d.innerHTML)?(b=d.lastChild,a.dom.unwrap(d),this.setAfter(b)):d.parentNode.removeChild(d))}.bind(this),g=function(a){d&&d.parentNode&&setTimeout(f,0)},h=function(a){8===a.which||91===a.which||17===a.which||86===a.which&&(a.ctrlKey||a.metaKey)||f()};d.className="_wysihtml-temp-caret-fix";d.style.position="absolute";d.style.display="block";d.style.minWidth="1px";d.style.zIndex="99999";d.appendChild(e);b.parentNode.insertBefore(d,b.nextSibling);this.setBefore(e);this.contain.addEventListener("mouseup",
f);this.contain.addEventListener("keydown",h);this.contain.addEventListener("touchstart",f);this.contain.addEventListener("focus",f);this.contain.addEventListener("blur",f);this.contain.addEventListener("paste",g);this.contain.addEventListener("drop",g);this.contain.addEventListener("beforepaste",g);return d},setAfter:function(b,d,e){var f=this.win,k=rangy.createRange(this.doc),g=function(){var e=b.parentNode;e=e?e.childNodes[e.childNodes.length-1]:null;if(!h||e===b&&1===b.nodeType&&"block"===f.getComputedStyle(b).display)if(d){var k=
this.doc.createTextNode(a.INVISIBLE_SPACE);b.parentNode.insertBefore(k,b.nextSibling);this.selectNode(k);setTimeout(function(){k&&k.parentNode&&k.parentNode.removeChild(k)},0)}else this.createTemporaryCaretSpaceAfter(b)}.bind(this);k.setStartAfter(b);k.setEndAfter(b);if(document.activeElement&&document.activeElement===this.composer.element){var h=this.setSelection(k);g();e&&e(h)}else{var q=this.composer.getScrollPos();this.composer.element.focus();this.composer.setScrollPos(q);setTimeout(function(){h=
this.setSelection(k);g();e&&e(h)}.bind(this),0)}},selectNode:function(b,d){var e=rangy.createRange(this.doc),f=b.nodeType===a.ELEMENT_NODE,g="canHaveHTML"in b?b.canHaveHTML:"IMG"!==b.nodeName,m=f?b.innerHTML:b.data;m=""===m||m===a.INVISIBLE_SPACE;var p=h.getStyle("display").from(b);p="block"===p||"list-item"===p;if(m&&f&&g&&!d)try{b.innerHTML=a.INVISIBLE_SPACE}catch(q){}g?e.selectNodeContents(b):e.selectNode(b);g&&m&&f?e.collapse(p):g&&m&&(e.setStartAfter(b),e.setEndAfter(b));this.setSelection(e)},
getSelectedNode:function(a){if(a&&this.doc.selection&&"Control"===this.doc.selection.type&&(a=this.doc.selection.createRange())&&a.length)return a.item(0);a=this.getSelection(this.doc);return a.focusNode===a.anchorNode?a.focusNode:(a=this.getRange(this.doc))?a.commonAncestorContainer:this.doc.body},fixSelBorders:function(){var a=this.getRange();if(!a.canSurroundContents())for(var d=a.commonAncestorContainer,b=e(d,a.startContainer),g=e(d,a.endContainer);!a.canSurroundContents();)b>g?(a.setStartBefore(a.startContainer),
b=e(d,a.startContainer)):(a.setEndAfter(a.endContainer),g=e(d,a.endContainer));this.setSelection(a)},getSelectedOwnNodes:function(a){a=this.getOwnRanges();for(var d=[],b=0,e=a.length;b<e;b++)d.push(a[b].commonAncestorContainer||this.doc.body);return d},findNodesInSelection:function(b){for(var d=this.getOwnRanges(),e=[],f,g=0,h=d.length;g<h;g++)f=d[g].getNodes([1],function(d){return a.lang.array(b).contains(d.nodeName)}),e=e.concat(f);return e},filterElements:function(a){for(var d=this.getOwnRanges(),
b=[],e,f=0,g=d.length;f<g;f++)e=d[f].getNodes([1],function(b){return a(b,d[f])}),b=b.concat(e);return b},containsUneditable:function(){for(var a=this.getOwnUneditables(),d=this.getSelection(),b=0,e=a.length;b<e;b++)if(d.containsNode(a[b]))return!0;return!1},deleteContents:function(){var a=this.getRange();this.deleteRangeContents(a);this.setSelection(a)},deleteRangeContents:function(b){var d,e;if(this.unselectableClass)for((d=a.dom.getParentElement(b.startContainer,{query:"."+this.unselectableClass},
!1,this.contain))&&b.setStartBefore(d),(e=a.dom.getParentElement(b.endContainer,{query:"."+this.unselectableClass},!1,this.contain))&&b.setEndAfter(e),d=b.getNodes([1],function(d){return a.dom.hasClass(d,this.unselectableClass)}.bind(this)),e=d.length;e--;)try{var f=new CustomEvent("wysihtml:uneditable:delete");d[e].dispatchEvent(f)}catch(n){}b.deleteContents()},getCaretNode:function(){var a=this.getSelection();return a&&a.anchorNode?b(a.anchorNode,a.anchorOffset):null},getPreviousNode:function(e,
d){if(!e){var f=this.getSelection();e=f&&f.anchorNode?b(f.anchorNode,f.anchorOffset):null}if(e===this.contain)return!1;f=e.previousSibling;if(f===this.contain)return!1;f&&3!==f.nodeType&&1!==f.nodeType?f=this.getPreviousNode(f,d):f&&3===f.nodeType&&/^\s*$/.test(f.textContent)?f=this.getPreviousNode(f,d):d&&f&&1===f.nodeType?(e=a.dom.getStyle("display").from(f),a.lang.array(["BR","HR","IMG"]).contains(f.nodeName)||a.lang.array(["block","inline-block","flex","list-item","table"]).contains(e)||!/^[\s]*$/.test(f.innerHTML)||
(f=this.getPreviousNode(f,d))):f||e===this.contain||(e=e.parentNode,e!==this.contain&&(f=this.getPreviousNode(e,d)));return f!==this.contain?f:!1},getNodesNearCaret:function(){if(!this.isCollapsed())throw"Selection must be caret when using selection.getNodesNearCaret()";var a=this.getOwnRanges();if(a&&0<a.length){if(1===a[0].startContainer.nodeType){var d=a[0].startContainer.childNodes[a[0].startOffset-1];if(!d&&0===a[0].startOffset)var b=a[0].startContainer.childNodes[0];else if(d){var e=d.previousSibling;
b=d.nextSibling}}else{if(0===a[0].startOffset&&a[0].startContainer.previousSibling){if(d=a[0].startContainer.previousSibling,3===d.nodeType)var g=d.data.length}else d=a[0].startContainer,g=a[0].startOffset;e=d.previousSibling;b=d.nextSibling}return{caretNode:d,prevNode:e,nextNode:b,textOffset:g}}return null},getSelectionParentsByTag:function(b){b=this.getSelectedOwnNodes();for(var d,e=[],f=0,g=b.length;f<g;f++)(d=b[f].nodeName&&"LI"===b[f].nodeName?b[f]:a.dom.getParentElement(b[f],{query:"li"},!1,
this.contain))&&e.push(d);return e.length?e:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var a=this.getRange();if(a){var d=a.startContainer;a=a.startOffset;var b=rangy.createRange(this.doc);b.selectNodeContents(d);b.setStart(d,a);return b}}},getRangeToNodeBeginning:function(){if(this.isCollapsed()){var a=this.getRange(),d=a.startContainer;a=a.startOffset;var b=rangy.createRange(this.doc);b.selectNodeContents(d);b.setEnd(d,a);return b}},caretIsInTheEndOfNode:function(a){rangy.createRange(this.doc);
this.getSelection();var d=this.getRangeToNodeEnd();return d&&(d=d.cloneContents(),d=d.textContent,/^\s*$/.test(d))?a?(a=this.getRangeToNodeBeginning().cloneContents(),a=a.textContent,!/[\u00A0 ][\s\uFEFF]*$/.test(a)):!0:!1},caretIsFirstInSelection:function(e){var d=rangy.createRange(this.doc),f=this.getSelection(),g=this.getRange(),h=b(g.startContainer,g.startOffset);if(h){if(h.nodeType===a.TEXT_NODE){if(!h.parentNode||!this.isCollapsed()||h.parentNode.firstChild!==h&&!a.dom.domNode(h.previousSibling).is.block())return!1;
e=this.win.getComputedStyle(h.parentNode).whiteSpace;return"pre"===e||"pre-wrap"===e?0===g.startOffset:/^\s*$/.test(h.data.substr(0,g.startOffset))}if(e&&a.dom.domNode(h).is.lineBreak())return!0;d.selectNodeContents(this.getRange().commonAncestorContainer);d.collapse(!0);return this.isCollapsed()&&(d.startContainer===f.anchorNode||d.endContainer===f.anchorNode)&&d.startOffset===f.anchorOffset}},caretIsInTheBeginnig:function(b){var d=this.getSelection(),e=d.anchorNode;d=d.anchorOffset;if(b&&e)return 0===
d&&(e.nodeName&&e.nodeName===b.toUpperCase()||a.dom.getParentElement(e.parentNode,{query:b},1));if(e)return 0===d&&!this.getPreviousNode(e,!0)},getBeforeSelection:function(b){var d=this.getSelection(),e=d.isBackwards()?d.focusNode:d.anchorNode;d=d.isBackwards()?d.focusOffset:d.anchorOffset;var f=this.createRange(),g;e&&3===e.nodeType&&/^\s*$/.test(e.data.slice(0,d))&&(d=0);if(g=a.dom.getParentElement(e,{query:"._wysihtml-temp-caret-fix"},1))e=g.parentNode,d=Array.prototype.indexOf.call(e.childNodes,
g);if(e){if(0<d){if(3===e.nodeType)return f.setStart(e,0),f.setEnd(e,d),{type:"text",range:f,offset:d,node:e};f.setStartBefore(e.childNodes[0]);e=e.childNodes[d-1];f.setEndAfter(e);return{type:"element",range:f,offset:d,node:e}}f.setStartAndEnd(e,0);return b&&(b=this.getPreviousNode(e,!0),g=null,b&&(g=1===b.nodeType&&a.dom.hasClass(b,this.unselectableClass)?b:a.dom.domNode(b).lastLeafNode()),g)?{type:"leafnode",range:f,offset:d,node:g}:{type:"none",range:f,offset:d,node:e}}return null},executeAndRestoreRangy:function(a,
d){if(d=rangy.saveSelection(this.win))try{a()}catch(k){setTimeout(function(){throw k;},0)}else a();rangy.restoreSelection(d)},executeAndRestore:function(b,d){var e=this.doc.body,f=d&&e.scrollTop,g=d&&e.scrollLeft,m='<span class="_wysihtml-temp-placeholder">'+a.INVISIBLE_SPACE+"</span>",p=this.getRange(!0);if(p){if(!p.collapsed){var q=p.cloneRange();var x=q.createContextualFragment(m);q.collapse(!1);q.insertNode(x);q.detach()}m=p.createContextualFragment(m);p.insertNode(m);x&&(x=this.contain.querySelectorAll("._wysihtml-temp-placeholder"),
p.setStartBefore(x[0]),p.setEndAfter(x[x.length-1]));this.setSelection(p);try{b(p.startContainer,p.endContainer)}catch(w){setTimeout(function(){throw w;},0)}if((x=this.contain.querySelectorAll("._wysihtml-temp-placeholder"))&&x.length){b=rangy.createRange(this.doc);p=x[0].nextSibling;if(1<x.length)var y=x[x.length-1].previousSibling;y&&p?(b.setStartBefore(p),b.setEndAfter(y)):(y=this.doc.createTextNode(a.INVISIBLE_SPACE),h.insert(y).after(x[0]),b.setStartBefore(y),b.setEndAfter(y));this.setSelection(b);
for(y=x.length;y--;)x[y].parentNode.removeChild(x[y])}else this.contain.focus();d&&(e.scrollTop=f,e.scrollLeft=g);try{x.parentNode.removeChild(x)}catch(w){}}else b(e,e)},set:function(a,d){var b=rangy.createRange(this.doc);b.setStart(a,d||0);this.setSelection(b)},insertHTML:function(a){var d=this.getRange(),b=this.doc.createElement("DIV"),e=this.doc.createDocumentFragment();if(d){d.deleteContents();b.innerHTML=a;for(a=b.lastChild;b.firstChild;)e.appendChild(b.firstChild);d.insertNode(e);for(d=this.contain.lastChild;d&&
3===d.nodeType&&d.previousSibling&&/^\s*$/.test(d.data);)d=d.previousSibling;a&&(d&&a===d&&1===a.nodeType&&this.contain.appendChild(this.doc.createElement("br")),this.setAfter(a))}},insertNode:function(a){var d=this.getRange();d&&(d.deleteContents(),d.insertNode(a))},canAppendChild:function(a){var d,b=this.getRange();(a=a||b.startContainer)&&(d=(a.tagName||a.nodeName).toLowerCase());return-1==="area base br col command embed hr img input keygen link meta param source track wbr".split(" ").indexOf(d)},
splitElementAtCaret:function(b,d){var e=this.getSelection();if(0<e.rangeCount){e=e.getRangeAt(0).cloneRange();e.setEndAfter(b);var f=e.extractContents();var g=f.childNodes;for(var h=g.length;h--;)a.dom.domNode(g[h]).is.visible()||f.removeChild(g[h]);b.parentNode.insertBefore(f,b.nextSibling);d?(f=d.firstChild||d,g=d.lastChild||d,b.parentNode.insertBefore(d,b.nextSibling),f&&g&&(e.setStartBefore(f),e.setEndAfter(g),this.setSelection(e))):(e.setStartAfter(b),e.setEndAfter(b));a.dom.domNode(b).is.visible()||
(""===a.dom.getTextContent(b)?b.parentNode.removeChild(b):b.parentNode.replaceChild(this.doc.createTextNode(" "),b))}},surround:function(a){var d=this.getOwnRanges(),b=[];if(0==d.length)return b;for(var e=d.length;e--;){var f=this.doc.createElement(a.nodeName);b.push(f);a.className&&(f.className=a.className);a.cssStyle&&f.setAttribute("style",a.cssStyle);try{d[e].surroundContents(f),this.selectNode(f)}catch(m){f.appendChild(d[e].extractContents()),d[e].insertNode(f)}}return b},scrollIntoView:function(){var b=
this.doc,d=b.documentElement.scrollHeight>b.documentElement.offsetHeight,e;(e=b._wysihtmlScrollIntoViewElement)||(e=b.createElement("span"),e.innerHTML=a.INVISIBLE_SPACE);e=b._wysihtmlScrollIntoViewElement=e;if(d){this.insertNode(e);d=e;var g=0;if(d.parentNode){do g+=d.offsetTop||0,d=d.offsetParent;while(d)}d=g;e.parentNode.removeChild(e);d>=b.body.scrollTop+b.documentElement.offsetHeight-5&&(b.body.scrollTop=d)}},selectLine:function(){var b=rangy.createRange();a.browser.supportsSelectionModify()?
this._selectLine_W3C():b.nativeRange&&b.nativeRange.getBoundingClientRect&&this._selectLineUniversal()},includeRangyRangeHelpers:function(){var a=this.getSelection(),d=a.getRangeAt(0),b=function(a){return a&&1===a.nodeType&&a.classList.contains("rangySelectionBoundary")},e=1===a.anchorNode.nodeType?a.anchorNode.childNodes[a.anchorOffset]:a.anchorNode,g=1===a.focusNode.nodeType?a.focusNode.childNodes[a.focusOffset]:a.focusNode,h;if(h=g){h=a.focusOffset;var p=1===g.nodeType?g.childNodes&&g.childNodes.length||
0:g.data&&g.data.length||0;h=h===p}h&&g.nextSibling&&b(g.nextSibling)&&d.setEndAfter(g.nextSibling);e&&0===a.anchorOffset&&e.previousSibling&&b(e.previousSibling)&&d.setStartBefore(e.previousSibling);d.select()},_selectLine_W3C:function(){var a=this.win.getSelection(),d=[a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset];a.modify("move","left","lineboundary");a.modify("extend","right","lineboundary");a.anchorNode===d[0]&&a.anchorOffset===d[1]&&a.focusNode===d[2]&&a.focusOffset===d[3]?this._selectLineUniversal():
this.includeRangyRangeHelpers()},toLineBoundary:function(b,d){d="undefined"===typeof d?!1:d;if(a.browser.supportsSelectionModify()){var e=this.win.getSelection();e.modify("extend",b,"lineboundary");d&&("left"===b?e.collapseToStart():"right"===b&&e.collapseToEnd())}},getRangeRect:function(a){this.doc.createTextNode("i");var d=this.doc.createTextNode("i");a.collapsed?(a.insertNode(d),a.selectNode(d),d=a.nativeRange.getBoundingClientRect(),a.deleteContents()):d=a.nativeRange.getBoundingClientRect();
return d},_selectLineUniversal:function(){var b=this.getSelection().getRangeAt(0),d=0,e=this;var g=function(d){return d&&1===d.nodeType&&("block"===e.win.getComputedStyle(d).display||a.lang.array(["BR","HR"]).contains(d.nodeName))};var h=function(a){if(a)for(;a&&(1===a.nodeType&&a.classList.contains("rangySelectionBoundary")||3===a.nodeType&&/^\s*$/.test(a.data));)a=a.previousSibling;return a};b.cloneRange();b.cloneRange();b.collapsed&&(3===b.startContainer.nodeType&&b.startOffset<b.startContainer.data.length?
b.moveEnd("character",1):1===b.startContainer.nodeType&&b.startContainer.childNodes[b.startOffset]&&3===b.startContainer.childNodes[b.startOffset].nodeType&&0<b.startContainer.childNodes[b.startOffset].data.length?b.moveEnd("character",1):0<b.startOffset&&(3===b.startContainer.nodeType||1===b.startContainer.nodeType&&!g(h(b.startContainer.childNodes[b.startOffset-1])))&&b.moveStart("character",-1));b.collapsed||b.insertNode(this.doc.createTextNode(a.INVISIBLE_SPACE));g=b.nativeRange.getBoundingClientRect();
do{h=b.moveStart("character",-1);var m=b.nativeRange.getBoundingClientRect();if(!m||Math.floor(m.top)!==Math.floor(g.top)){b.moveStart("character",1);var p=!0}d++}while(0!==h&&!p&&2E3>d);d=0;p=!1;g=b.nativeRange.getBoundingClientRect();if(b.endContainer!==this.contain||this.contain.lastChild&&this.contain.childNodes[b.endOffset]!==this.contain.lastChild){do h=b.moveEnd("character",1),m=b.nativeRange.getBoundingClientRect(),m&&Math.floor(m.bottom)===Math.floor(g.bottom)||(b.moveEnd("character",-1),
b.endContainer&&1===b.endContainer.nodeType&&b.endContainer.childNodes[b.endOffset]&&1===b.endContainer.childNodes[b.endOffset].nodeType&&"BR"===b.endContainer.childNodes[b.endOffset].nodeName&&b.endContainer.childNodes[b.endOffset].previousSibling&&(1===b.endContainer.childNodes[b.endOffset].previousSibling.nodeType?b.setEnd(b.endContainer.childNodes[b.endOffset].previousSibling,b.endContainer.childNodes[b.endOffset].previousSibling.childNodes.length):3===b.endContainer.childNodes[b.endOffset].previousSibling.nodeType&&
b.setEnd(b.endContainer.childNodes[b.endOffset].previousSibling,b.endContainer.childNodes[b.endOffset].previousSibling.data.length)),p=!0),d++;while(0!==h&&!p&&2E3>d)}b.select();this.includeRangyRangeHelpers()},getText:function(){var a=this.getSelection();return a?a.toString():""},getNodes:function(a,d){var b=this.getRange();return b?b.getNodes(Array.isArray(a)?a:[a],d):[]},getOwnNodes:function(a,d,b){for(var e=this.getOwnRanges(),f=[],g=0,k=e.length;g<k;g++)e[g]&&(b&&e[g].splitBoundaries(),f=f.concat(e[g].getNodes(Array.isArray(a)?
a:[a],d)));return f},fixRangeOverflow:function(a){if(this.contain&&this.contain.firstChild&&a){var d=a.compareNode(this.contain);2!==d?(1===d&&a.setStartBefore(this.contain.firstChild),0===d&&a.setEndAfter(this.contain.lastChild),3===d&&(a.setStartBefore(this.contain.firstChild),a.setEndAfter(this.contain.lastChild))):this._detectInlineRangeProblems(a)&&(d=a.endContainer.previousElementSibling)&&a.setEnd(d,this._endOffsetForNode(d))}},_endOffsetForNode:function(a){var d=document.createRange();d.selectNodeContents(a);
return d.endOffset},_detectInlineRangeProblems:function(a){var d=h.compareDocumentPosition(a.startContainer,a.endContainer);return 0==a.endOffset&&d&4},getRange:function(a){var d=this.getSelection();d=d&&d.rangeCount&&d.getRangeAt(0);!0!==a&&this.fixRangeOverflow(d);return d},getOwnUneditables:function(){var b=h.query(this.contain,"."+this.unselectableClass),d=h.query(b,"."+this.unselectableClass);return a.lang.array(b).without(d)},getOwnRanges:function(){var a=[],d=this.getRange();d&&a.push(d);if(this.unselectableClass&&
this.contain&&d){var b=this.getOwnUneditables();if(0<b.length)for(var e=0,g=b.length;e<g;e++){d=[];for(var h=0,p=a.length;h<p;h++){if(a[h])switch(a[h].compareNode(b[e])){case 2:break;case 3:var q=a[h].cloneRange();q.setEndBefore(b[e]);d.push(q);q=a[h].cloneRange();q.setStartAfter(b[e]);d.push(q);break;default:d.push(a[h])}a=d}}}return a},getSelection:function(){return rangy.getSelection(this.win)},setSelection:function(a){var d=rangy.getSelection(this.win);d.setSingleRange(a);return d&&d.anchorNode&&
d.focusNode?d:null},selectAll:function(){var b=this.createRange(),d=this.composer,e=this,h=g(this.composer.element),n=g(this.composer.element),m,p=function(){b.setStart(d.element,0);b.setEnd(d.element,d.element.childNodes.length);m=e.setSelection(b)},q=function(){return!m||m.nativeSelection&&m.nativeSelection.type&&("Caret"===m.nativeSelection.type||"None"===m.nativeSelection.type)};a.dom.removeInvisibleSpaces(this.composer.element);p();this.composer.element.firstChild&&q()&&(this.composer.element.appendChild(h),
p(),q()&&(h.parentNode.removeChild(h),this.composer.element.insertBefore(n,this.composer.element.firstChild),p(),q()&&(this.composer.element.appendChild(h),p())))},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},getPlainText:function(){return this.getSelection().toString()},isEndToEndInNode:function(b){var d=this.getRange(),e=d.commonAncestorContainer,f=d.startContainer,
g=d.endContainer;e.nodeType===a.TEXT_NODE&&(e=e.parentNode);if(f.nodeType===a.TEXT_NODE&&!/^\s*$/.test(f.data.substr(d.startOffset))||g.nodeType===a.TEXT_NODE&&!/^\s*$/.test(g.data.substr(d.endOffset)))return!1;for(;f&&f!==e;){if(f.nodeType!==a.TEXT_NODE&&!a.dom.contains(e,f)||a.dom.domNode(f).prev({ignoreBlankTexts:!0}))return!1;f=f.parentNode}for(;g&&g!==e;){if(g.nodeType!==a.TEXT_NODE&&!a.dom.contains(e,g)||a.dom.domNode(g).next({ignoreBlankTexts:!0}))return!1;g=g.parentNode}return a.lang.array(b).contains(e.nodeName)?
e:!1},isInThisEditable:function(){var b=this.getSelection(),d=b.focusNode;b=b.anchorNode;d&&1!==d.nodeType&&(d=d.parentNode);b&&1!==b.nodeType&&(b=b.parentNode);return b&&d&&(a.dom.contains(this.composer.element,d)||this.composer.element===d)&&(a.dom.contains(this.composer.element,b)||this.composer.element===b)},deselect:function(){var a=this.getSelection();a&&a.removeAllRanges()}})})(wysihtml);
wysihtml.Commands=Base.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.doc=this.composer.doc},support:function(a){return wysihtml.browser.supportsCommand(this.doc,a)},exec:function(a,e){var b=wysihtml.commands[a],g=wysihtml.lang.array(arguments).get(),h=b&&b.exec,f=null;this.composer.hasPlaceholderSet()&&!wysihtml.lang.array(["styleWithCSS","enableObjectResizing","enableInlineTableEditing"]).contains(a)&&(this.composer.element.innerHTML="",this.composer.selection.selectNode(this.composer.element));
this.editor.fire("beforecommand:composer",{command:a,value:e});if(h)g.unshift(this.composer),f=h.apply(b,g);else try{f=this.doc.execCommand(a,!1,e)}catch(d){}this.editor.fire("aftercommand:composer",{command:a,value:e});return f},remove:function(a,e){var b=wysihtml.commands[a],g=wysihtml.lang.array(arguments).get(),h=b&&b.remove;if(h)return g.unshift(this.composer),h.apply(b,g)},state:function(a,e){var b=wysihtml.commands[a],g=wysihtml.lang.array(arguments).get(),h=b&&b.state;if(h)return g.unshift(this.composer),
h.apply(b,g);try{return this.doc.queryCommandState(a)}catch(f){return!1}},stateValue:function(a){var e=wysihtml.commands[a],b=wysihtml.lang.array(arguments).get(),g=e&&e.stateValue;return g?(b.unshift(this.composer),g.apply(e,b)):!1}});
(function(a){var e={nodeName:"A",toggle:!1};a.commands.createLink={exec:function(b,g,h){h=a.lang.object({}).merge(e).merge({attribute:h}).get();if(b.selection.isCollapsed()&&!this.state(b,g)){var f=b.doc.createTextNode(h.attribute.href);b.selection.insertNode(f);b.selection.selectNode(f)}a.commands.formatInline.exec(b,g,h)},state:function(b,g){return a.commands.formatInline.state(b,g,e)}}})(wysihtml);
(function(a){function e(a,d){return 3===a.nodeType?a:a.childNodes[d]||a}function b(a){return a&&1===a.nodeType&&"BR"===a.nodeName}function g(a){return a&&1===a.nodeType&&a.classList.contains("rangySelectionBoundary")}function h(a,d){return b(a)||a&&1===a.nodeType&&"block"===d.win.getComputedStyle(a).display}function f(d,b){a.dom.removeInvisibleSpaces(d.element);var e=d.element,f=e.querySelectorAll("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote");d=d.config.classNames.uneditableContainer+[""].concat("h1; h2; h3; h4; h5; h6; p; pre; div; blockquote".split(";")).join(", "+
d.config.classNames.uneditableContainer+" ");e=e.querySelectorAll(d);f=a.lang.array(f).without(e);for(d=f.length;d--;)""!==f[d].innerHTML.replace(/[\uFEFF]/g,"")||0!==b.length&&f[d]===b[b.length-1]||(e=a.lang.array(b).indexOf(f[d]),-1<e&&b.splice(e,1),f[d].parentNode.removeChild(f[d]));return b}function d(a,d,b){for(var e=null;a&&d&&a!==d;)1===a.nodeType&&a.matches(b?"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote":"h1, h2, h3, h4, h5, h6, p, pre")&&(e=a),a=a.parentNode;return e}function k(d,b,e){d||
(d=e.doc.createElement(b.nodeName||(e.config.useLineBreaks?"DIV":"P")),d.appendChild(e.doc.createTextNode(a.INVISIBLE_SPACE)));b.nodeName&&d.nodeName!==b.nodeName&&(d=C.renameElement(d,b.nodeName));b.classRegExp&&(d.className=d.className.replace(b.classRegExp,""));b.className&&d.classList.add(b.className);b.styleProperty&&"undefined"!==typeof b.styleValue&&(d.style[a.browser.fixStyleKey(b.styleProperty)]=b.styleValue);return d}function l(d){d=d.querySelectorAll("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote")||
[];for(var b,e=d.length;e--;)b=a.dom.domNode(d[e]).next({nodeTypes:[1,3],ignoreBlankTexts:!0}),a.dom.domNode(d[e]).prev({nodeTypes:[1,3],ignoreBlankTexts:!0}),b&&1!==b.nodeType&&"BR"!==b.nodeName&&""!==(d[e].innerHTML||d[e].nodeValue||"").trim()&&d[e].parentNode.insertBefore(d[e].ownerDocument.createElement("BR"),b),b&&1!==b.nodeType&&"BR"!==b.nodeName&&""!==(d[e].innerHTML||d[e].nodeValue||"").trim()&&d[e].parentNode.insertBefore(d[e].ownerDocument.createElement("BR"),b),a.dom.unwrap(d[e])}function n(d){for(var b=
[],e,f,g,k,h,l,n=0,m=d.length;n<m;n++){1===d[n].startContainer.nodeType&&d[n].startContainer.matches("ul, ol")&&d[n].setStart(d[n].startContainer.childNodes[d[n].startOffset],0);1===d[n].endContainer.nodeType&&d[n].endContainer.matches("ul, ol")&&(l=d[n].endContainer.childNodes[Math.max(d[n].endOffset-1,0)],l.childNodes&&d[n].setEnd(l,l.childNodes.length));e=d[n].getNodes([1],function(a){return"LI"===a.nodeName});if(0<e.length)for(f=0,g=e.length;f<g;f++){h=d[n].compareNode(e[f]);if(h===d[n].NODE_AFTER||
h===d[n].NODE_INSIDE)k=d[n].cloneRange(),(l=a.dom.domNode(e[f]).prev({nodeTypes:[1]}))?k.setEnd(l,l.childNodes.length):e[f].closest("ul, ol")?k.setEndBefore(e[f].closest("ul, ol")):k.setEndBefore(e[f]),b.push(k),d[n].setStart(e[f],0);if(h===d[n].NODE_BEFORE||h===d[n].NODE_INSIDE)k=d[n].cloneRange(),k.setEnd(e[f],e[f].childNodes.length),b.push(k),(l=a.dom.domNode(e[f]).next({nodeTypes:[1]}))?d[n].setStart(l,0):e[f].closest("ul, ol")?d[n].setStartAfter(e[f].closest("ul, ol")):d[n].setStartAfter(e[f])}b.push(d[n])}return b}
function m(b,e,f,g){var k=e.startContainer;if(g=g||d(k,f.element,!0)){e=b.firstChild;var l=b.lastChild;f.selection.splitElementAtCaret(g,b);var n=a.dom.domNode(l).next({nodeTypes:[1,3],ignoreBlankTexts:!0});b=a.dom.domNode(e).prev({nodeTypes:[1,3],ignoreBlankTexts:!0});e&&!h(e,f)&&b&&!h(b,f)&&e.parentNode.insertBefore(f.doc.createElement("br"),e);l&&!h(l,f)&&n&&!h(n,f)&&n.parentNode.insertBefore(f.doc.createElement("br"),n)}else{g=f.element;var m=k;k=null;for(var A;m&&g&&m!==g;)1===m.nodeType&&m.matches("b, big, i, small, tt, abbr, acronym, cite, code, dfn, em, kbd, strong, samp, var, a, bdo, br, q, span, sub, sup, button, label, textarea, input, select, u")&&
(n=m,null===k?l=k=m.cloneNode(!1):(A=m.cloneNode(!1),A.appendChild(k),k=A)),m=m.parentNode;if((g=k)&&l&&n){if(1===b.childNodes.length){for(;b.firstChild.firstChild;)l.appendChild(b.firstChild.firstChild);b.firstChild.appendChild(g)}f.selection.splitElementAtCaret(n,b)}else f=b.firstChild,l=b.lastChild,e.insertNode(b),e.setStartBefore(f),e.setEndAfter(l)}}function p(d,b,f){d=d.cloneRange();var g=e(d.startContainer,d.startOffset).previousSibling,k=e(d.endContainer,d.endOffset).nextSibling,n=d.extractContents();
b=f.doc.createDocumentFragment();for(var p;n.firstChild;)if(1===n.firstChild.nodeType&&n.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote")){l(n.firstChild);p=a.dom.unwrap(n.firstChild);0<p.length&&(b.lastChild&&(1!==b.lastChild.nodeType||!h(b.lastChild,f))||!b.lastChild&&g&&(1!==g.nodeType||h(g,f)))&&b.appendChild(f.doc.createElement("BR"));for(var t=0,z=p.length;t<z;t++)b.appendChild(p[t]);0<p.length&&(1===b.lastChild.nodeType&&h(b.lastChild,f)||(k||b.lastChild!==n.lastChild)&&
b.appendChild(f.doc.createElement("BR")))}else b.appendChild(n.firstChild);g=a.lang.array(b.childNodes).get();m(b,d,f);return g}function q(f,g,h,n){var A=g?{nodeName:g.nodeName||null,className:g.classRegExp?null:g.className||null,classRegExp:g.classRegExp||null,styleProperty:g.styleProperty||null}:null;f=f.cloneRange();var p=f.startContainer,t=e(f.startContainer,f.startOffset),z=e(f.endContainer,f.endOffset),q;if(q=f.startContainer===t&&3===t.nodeType)q=t.data?t.data.slice(0,f.startOffset):"",q=!/^\s*$/.test(q);
t=q?t:a.dom.domNode(t).prev({nodeTypes:[1,3],ignoreBlankTexts:!0});z=1===f.endContainer.nodeType&&f.endContainer.childNodes[f.endOffset]===z&&(1===z.nodeType||!H(z,f.endOffset)&&!a.dom.domNode(z).is.rangyBookmark())||f.endContainer===z&&3===z.nodeType&&!H(z,f.endOffset)?z:a.dom.domNode(z).next({nodeTypes:[1,3],ignoreBlankTexts:!0});var r=f.extractContents();q=n.doc.createDocumentFragment();A=A?a.dom.getParentElement(p,A,null,n.element):null;var x=!h||!g||"BLOCKQUOTE"===g.nodeName&&"BLOCKQUOTE"===
h;p=A||d(p,n.element,x);a.dom.domNode(z).is.rangyBookmark()&&(z=z.nextSibling);if(r){for(;r.firstChild&&3===r.firstChild.nodeType&&/^\s*$/.test(r.firstChild.data)&&r.lastChild!==r.firstChild;)r.removeChild(r.firstChild);for(;r.lastChild&&3===r.lastChild.nodeType&&/^\s*$/.test(r.lastChild.data)&&r.lastChild!==r.firstChild;)r.removeChild(r.lastChild);r.firstChild&&1===r.firstChild.nodeType&&"BR"===r.firstChild.nodeName&&r.lastChild!==r.firstChild&&r.removeChild(r.firstChild);r.lastChild&&1===r.lastChild.nodeType&&
"BR"===r.lastChild.nodeName&&r.lastChild!==r.firstChild&&r.removeChild(r.lastChild)}if(g&&"BLOCKQUOTE"===g.nodeName)g=k(null,g,n),g.appendChild(r),q.appendChild(g),g=[g];else{if(r.firstChild)for(;r.firstChild;)if(1==r.firstChild.nodeType&&r.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"))k(r.firstChild,g,n),r.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre")&&l(r.firstChild),q.appendChild(r.firstChild);else{A=h;x=n;var w=g?a.lang.object(g).clone(!0):null;w&&(w.nodeName=w.nodeName||
A||(x.config.useLineBreaks?"DIV":"P"));for(A=k(null,w,n);r.firstChild&&(1!==r.firstChild.nodeType||!r.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"));)1==r.firstChild.nodeType&&A.matches("h1, h2, h3, h4, h5, h6, p, pre")&&l(r.firstChild),A.appendChild(r.firstChild);q.appendChild(A)}else q.appendChild(k(null,g,n));g=a.lang.array(q.childNodes).get()}m(q,f,n,p);f=z;h=t&&a.dom.domNode(t).prev({nodeTypes:[1,3],ignoreBlankTexts:!0});b(f)&&f.parentNode.removeChild(f);!b(t)||h&&1===
h.nodeType&&"block"===n.win.getComputedStyle(h).display||t.parentNode.removeChild(t);0<g.length&&("undefined"===typeof g[g.length-1].lastChild||a.dom.domNode(g[g.length-1].lastChild).is.rangyBookmark())&&g[g.length-1].appendChild(n.doc.createElement("br"));return g}function x(d,b){b=a.dom.getParentElement(d.selection.getOwnRanges()[0].startContainer,{query:"h1, h2, h3, h4, h5, h6, p, pre, "+(b?b.toLowerCase():"div")},null,d.element);if(b){var e=d.selection.createRange();e.selectNode(b);d.selection.setSelection(e)}else d.isEmpty()||
d.selection.selectLine()}function y(a,d){d=d.selection.createRange();var b=a[a.length-1],e=1===b.nodeType&&b.childNodes?b.childNodes.length|0:b.length||0;d.setStart(a[0],0);d.setEnd(b,e);d.select()}function w(d,b,e){var f=b.selection.getOwnRanges(),g=[];f=n(f);for(var k=f.length;k--;){var h=f[k];var l=b;var m=h.startContainer;var t=h.endContainer;m&&1===m.nodeType&&m===t?m.firstChild===m.lastChild&&1===h.endOffset&&m!==l.element&&"LI"!==m.nodeName&&"TD"!==m.nodeName&&(h.setStartBefore(m),h.setEndAfter(t)):
m&&1===m.nodeType&&3===t.nodeType?m.firstChild===t&&h.endOffset===t.data.length&&m!==l.element&&"LI"!==m.nodeName&&"TD"!==m.nodeName&&h.setEndAfter(m):t&&1===t.nodeType&&3===m.nodeType?t.firstChild===m&&0===h.startOffset&&t!==l.element&&"LI"!==t.nodeName&&"TD"!==t.nodeName&&h.setStartBefore(t):m&&3===m.nodeType&&m===t&&1===m.parentNode.childNodes.length&&h.endOffset==t.data.length&&0===h.startOffset&&(m=m.parentNode,m!==l.element&&"LI"!==m.nodeName&&"TD"!==m.nodeName&&(h.setStartBefore(m),h.setEndAfter(m)));
h=(h=a.dom.getParentElement(f[k].startContainer,{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"},null,b.element))?h.nodeName:null;g="remove"===d?g.concat(p(f[k],h,b)):g.concat(q(f[k],e,h,b))}return g}function B(a){"string"===typeof a&&(a={nodeName:a.toUpperCase()});return a}var C=a.dom,H=function(a,d){a=a.data?a.data.slice(d):"";return/^\s*$/.test(a)};a.commands.formatBlock={exec:function(d,e,k){k=B(k);var h=[],l;k&&k.toggle&&(l=this.state(d,e,k));if(l){var n=rangy.saveSelection(d.win);e=
0;for(var m=l.length;e<m;e++){var p=l[e];var t=k;var z=d,q=p.previousSibling,D=p.nextSibling,H=!1;t.styleProperty&&(p.style[a.browser.fixStyleKey(t.styleProperty)]="");t.className&&p.classList.remove(t.className);t.classRegExp&&(p.className=p.className.replace(t.classRegExp,""));null!==p.getAttribute("class")&&""===p.getAttribute("class").trim()&&p.removeAttribute("class");t.nodeName&&p.nodeName.toLowerCase()===t.nodeName.toLowerCase()&&((t=p.getAttribute("style"))&&""!==t.trim()?p=C.renameElement(p,
z.config.useLineBreaks?"DIV":"P"):(C.unwrap(p),H=!0));null!==p.getAttribute("style")&&""===p.getAttribute("style").trim()&&p.removeAttribute("style");H&&((p=q)&&g(p)&&(p=p.previousSibling),D&&g(D)&&(D=D.nextSibling),p&&(1!==p.nodeType||"block"!==z.win.getComputedStyle(p).display&&!b(p))&&p.parentNode&&p.parentNode.insertBefore(z.doc.createElement("br"),p.nextSibling),D&&(1!==D.nodeType||"block"!==z.win.getComputedStyle(D).display)&&D.parentNode&&D.parentNode.insertBefore(z.doc.createElement("br"),
D))}}else{if(d.selection.isCollapsed()){n=rangy.saveSelection(d.win);a:{if(d.selection.isCollapsed()&&(h=d.selection.getNodesNearCaret())&&h.caretNode&&(a.dom.domNode(h.caretNode).is.lineBreak()||3===h.caretNode.nodeType&&0===h.textOffset&&(!h.prevNode||a.dom.domNode(h.prevNode).is.lineBreak())||1===h.caretNode.nodeType&&h.caretNode.classList.contains("rangySelectionBoundary")&&(!h.prevNode||a.dom.domNode(h.prevNode).is.lineBreak()||a.dom.domNode(h.prevNode).is.block())&&(!h.nextNode||a.dom.domNode(h.nextNode).is.lineBreak()||
a.dom.domNode(h.nextNode).is.block()))){h=!0;break a}h=!1}h?d.selection.selectLine():x(d,k&&k.nodeName?k.nodeName.toUpperCase():void 0)}h=k?w("apply",d,k):w("remove",d)}h=f(d,h);n?rangy.restoreSelection(n):y(h,d)},remove:function(a,d,b){b=B(b);if(a.selection.isCollapsed()){var e=rangy.saveSelection(a.win);x(a,b&&b.nodeName?b.nodeName.toUpperCase():void 0)}d=w("remove",a);d=f(a,d);e?rangy.restoreSelection(e):y(d,a)},state:function(d,b,e){e=B(e);b=d.selection.filterElements(function(d){return a.dom.domNode(d).test(e||
{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"})}.bind(this));for(var f=d.selection.getSelectedOwnNodes(),g,k=0,h=f.length;k<h;k++)(g=C.getParentElement(f[k],e||{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"},null,d.element))&&-1===b.indexOf(g)&&b.push(g);return 0===b.length?!1:b}}})(wysihtml);
(function(a){function e(a){return!a.getAttribute("style")||/^\s*$/.test(a.getAttribute("style"))}function b(d,b){if(1!==d.nodeType||1!==b.nodeType||d.nodeName!==b.nodeName)return!1;var e=d.className.trim().replace(/\s+/g," ").split(" ");var f=b.className.trim().replace(/\s+/g," ").split(" ");if(0<a.lang.array(e).without(f).length)return!1;d=a.dom.getAttributes(d);b=a.dom.getAttributes(b);return d.length===b.length&&a.lang.object(a.lang.object(d).difference(b)).isEmpty()?!0:!1}function g(d,b){d=d.ownerDocument.createElement(b&&
b.nodeName||"SPAN");b.classRegExp&&(d.className=d.className.replace(b.classRegExp,""));b.className&&d.classList.add(b.className);b.styleProperty&&"undefined"!==typeof b.styleValue&&(d.style[a.browser.fixStyleKey(b.styleProperty)]=b.styleValue);if(b.attribute)if("object"===typeof b.attribute)for(var e in b.attribute)b.attribute.hasOwnProperty(e)&&d.setAttribute(e,b.attribute[e]);else"undefined"!==typeof b.attributeValue&&d.setAttribute(b.attribute,b.attributeValue);return d}function h(d,b){b.className&&
(!1!==b.toggle&&d.classList.contains(b.className)?d.classList.remove(b.className):(b.classRegExp&&(d.className=d.className.replace(b.classRegExp,"")),d.classList.add(b.className)),/^\s*$/.test(d.className)&&d.removeAttribute("class"));b.styleProperty&&(!1!==b.toggle&&d.style[a.browser.fixStyleKey(b.styleProperty)].trim().replace(/, /g,",")===b.styleValue?d.style[a.browser.fixStyleKey(b.styleProperty)]="":d.style[a.browser.fixStyleKey(b.styleProperty)]=b.styleValue);e(d)&&d.removeAttribute("style");
if(b.attribute){if("object"===typeof b.attribute)var f=b.attribute;else f={},f[b.attribute]=b.attributeValue||"";var g=b.toggle,k=a.dom.getAttributes(d);a:{for(h in f)if(f.hasOwnProperty(h)&&k[h]!==f[h]){var h=!1;break a}h=!0}a.lang.object(k).difference(f);if(h&&!1!==g)for(l in f)f.hasOwnProperty(l)&&d.removeAttribute(l);else for(l in f)f.hasOwnProperty(l)&&d.setAttribute(l,f[l])}var l=(l=b.nodeName?D[b.nodeName.toLowerCase()]||b.nodeName.toLowerCase():null)?a.dom.domNode(d).test({query:l}):!1;if(!b.nodeName||
"SPAN"===b.nodeName||l){if(b=(!1!==b.toggle&&l||!b.nodeName&&"SPAN"===d.nodeName)&&/^\s*$/.test(d.className)&&e(d))b=a.dom.getAttributes(d),b=a.lang.object(b).isEmpty();b&&a.dom.unwrap(d)}}function f(d,b){var e=[];d.isCollapsed()||(e=e.concat(d.getOwnNodes([3],function(d){return!a.dom.domNode(d).is.emptyTextNode()},b)));return e}function d(d,b,e,f){b=f?b:{nodeName:b.nodeName||null,className:b.classRegExp?null:b.className||null,classRegExp:b.classRegExp||null,styleProperty:b.styleProperty||null};do{if(f=
1===d.nodeType){f=d;var g=b;g.nodeName?(g=D[g.nodeName.toLowerCase()]||g.nodeName.toLowerCase(),f=a.dom.domNode(f).test({query:g})):(g=a.lang.object(g).clone(),g.query="b, big, i, small, tt, abbr, acronym, cite, code, dfn, em, kbd, strong, samp, var, a, bdo, br, q, span, sub, sup, button, label, textarea, input, select, u",f=a.dom.domNode(f).test(g))}if(f)return d;d=d.parentNode}while(d&&d!==e);return null}function k(d,b){var e=document.documentElement||document.body,f=e.scrollTop,g=e.scrollLeft;
rangy.getSelection(d.win);rangy.getSelection(d.win).removeAllRanges();try{rangy.getSelection(d.win).addRange(b)}catch(v){}d.doc.activeElement&&a.dom.contains(d.element,d.doc.activeElement)||(d.element.focus(),e.scrollTop=f,e.scrollLeft=g,rangy.getSelection(d.win).addRange(b))}function l(a,d){var b=rangy.createRange(d.doc),e=a[a.length-1];a[0]&&e&&(b.setStart(a[0],0),b.setEnd(e,e.length),k(d,b))}function n(a,d,b,e){var f=rangy.createRange(a.doc);d&&(f.setStart(d,b),f.setEnd(d,"undefined"!==typeof e?
e:b),k(a,f))}function m(a,b,e){var g=f(a.selection),k=[],h=!1;if(a.selection.isInThisEditable()){if(0===g.length&&a.selection.isCollapsed()){var l=a.selection.getSelection().anchorNode;if(!l)return{nodes:[],partial:!1};3===l.nodeType&&(g=[l])}g.length||(l=a.selection.getOwnRanges()[0])&&(g=[l.endContainer]);for(var n=0,m=g.length;n<m;n++)(l=d(g[n],b,a.element,e))?k.push(l):h=!0}return{nodes:k,partial:h}}function p(a){if(a){var d=a.anchorNode;var b=a.anchorOffset;if(d&&3===d.nodeType&&0<b&&b<d.data.length)return a=
d.data[b-1],d=d.data[b],/\w/.test(a)&&/\w/.test(d)}return!1}function q(d){var b,e;var f=[];if(d){f=d.anchorNode;d=b=e=d.anchorOffset;var g=f.ownerDocument;g=rangy.createRange(g);if(f&&3===f.nodeType){for(;0<b&&/\w/.test(f.data[b-1]);)b--;for(;e<f.data.length&&/\w/.test(f.data[e]);)e++;g.setStartAndEnd(f,b,e);g.splitBoundaries();f=g.getNodes([3],function(d){return!a.dom.domNode(d).is.emptyTextNode()});return{wordOffset:d-b,range:g,textNode:f[0]}}}return!1}function x(a){for(var d=a.length;d--;)if(a[d]&&
a[d].parentNode){if(a[d].nextSibling&&b(a[d],a[d].nextSibling)){for(var e=a[d],f=a[d].nextSibling;f.firstChild;)e.appendChild(f.firstChild);f.parentNode.removeChild(f)}if(a[d].previousSibling&&b(a[d],a[d].previousSibling)){e=a[d].previousSibling;for(f=a[d];f.firstChild;)e.appendChild(f.firstChild);f.parentNode.removeChild(f)}}}function y(a,d,b){0<d.length&&l(d,a);x(m(a,b).nodes);0<d.length&&l(d,a)}function w(a,d,b,e){n(a,d,b);x(m(a,e).nodes);n(a,d,b)}function B(a,d){d=g(a,d);a.parentNode.insertBefore(d,
a);d.appendChild(a)}function C(b,e,f){e=d(b,f,e.element);if(e){var g=e.cloneNode(!1);a.dom.domNode(b).escapeParent(e,g);h(g,f)}}function H(a){a="string"===typeof a?{nodeName:a}:a;a.nodeName&&(a.nodeName=a.nodeName.toUpperCase());return a}var D={b:"b, strong",strong:"b, strong",em:"em, i",i:"em, i"};a.commands.formatInline={exec:function(b,e,k){k=H(k);b.element.normalize();e=f(b.selection,!0);var l=m(b,k);if(0<l.nodes.length){var n=m(b,k,!0),A=b.selection.getSelection();if(e.length){if(n.partial||
!1===k.toggle)for(n=e.length;n--;)d(e[n],k,b.element)&&C(e[n],b,k),d(e[n],k,b.element)||B(e[n],k);else for(n=e.length;n--;)C(e[n],b,k);y(b,e,k)}else if(!1!==k.toggle)if(p(A))e=q(A),C(e.textNode,b,k),w(b,e.textNode,e.wordOffset,k);else{if(e=b.doc.createTextNode(a.INVISIBLE_SPACE),n=l.nodes[0].cloneNode(!1),n.appendChild(e),b.selection.splitElementAtCaret(l.nodes[0],n),h(n,k),y(b,[e],k),e=b.selection.getSelection(),e.anchorNode&&e.focusNode)try{e.collapseToEnd()}catch(I){}}else for(n=l.nodes.length;n--;)h(l.nodes[n],
k)}else if(l=k,k=b.selection.getSelection(),e.length){for(k=e.length;k--;)B(e[k],l);y(b,e,l)}else if(p(k))e=q(k),B(e.textNode,l),w(b,e.textNode,e.wordOffset,l);else if(e=b.selection.getOwnRanges()[0])l=g(e.endContainer,l),e.surroundContents(l),b.selection.selectNode(l);b.element.normalize()},remove:function(b,e,g){g=H(g);b.element.normalize();e=f(b.selection,!0);var k=m(b,g);if(0<k.nodes.length){var h;var l=b.selection.getSelection();if(e.length){for(l=e.length;l--;)k=e[l],(h=d(k,g,b.element))&&a.dom.domNode(k).escapeParent(h);
y(b,e,g)}else{e=l.anchorNode;h=l.anchorOffset;for(l=k.nodes.length;l--;)a.dom.unwrap(k.nodes[l]);w(b,e,h,g)}}b.element.normalize()},state:function(a,d,b){b=H(b);a=m(a,b,!0).nodes;return 0===a.length?!1:a}}})(wysihtml);
(function(a){a.commands.indentList={exec:function(a,b,g){return(b=a.selection.getSelectionParentsByTag("LI"))?this.tryToPushLiLevel(b,a.selection):!1},state:function(a,b){return!1},tryToPushLiLevel:function(e,b){var g,h,f,d,k,l=!1;b.executeAndRestoreRangy(function(){for(var b=e.length;b--;)d=e[b],g="OL"===d.parentNode.nodeName?"OL":"UL",h=d.ownerDocument.createElement(g),k=(f=a.dom.domNode(d).prev({nodeTypes:[a.ELEMENT_NODE]}))?f.querySelector("ul, ol"):null,f&&(k?k.appendChild(d):(h.appendChild(d),
f.appendChild(h)),l=!0)});return l}}})(wysihtml);(function(a){a.commands.insertHTML={exec:function(a,b,g){a.selection.insertHTML(g)},state:function(){return!1}}})(wysihtml);(function(a){var e="<br>"+(a.browser.needsSpaceAfterLineBreak()?" ":"");a.commands.insertLineBreak={exec:function(a,g){a.selection.insertHTML(e)},state:function(){return!1}}})(wysihtml);
wysihtml.commands.insertList=function(a){var e=function(a,b){if(a&&a.nodeName){"string"===typeof b&&(b=[b]);for(var d=b.length;d--;)if(a.nodeName===b[d])return!0}return!1},b=function(d,b,f){var g={el:null,other:!1};if(d){var k=a.dom.getParentElement(d,{query:"li"},!1,f.element),h="UL"===b?"OL":"UL";e(d,b)?g.el=d:e(d,h)?g={el:d,other:!0}:k&&(e(k.parentNode,b)?g.el=k.parentNode:e(k.parentNode,h)&&(g={el:k.parentNode,other:!0}))}g.el&&!f.element.contains(g.el)&&(g.el=null);return g},g=function(d,b,e){var g=
"UL"===b?"OL":"UL",k,h;e.selection.executeAndRestoreRangy(function(){k=f(g,e);if(k.length)for(var l=k.length;l--;)a.dom.renameElement(k[l],b.toLowerCase());else{h=f(["OL","UL"],e);for(l=h.length;l--;)a.dom.resolveList(h[l],e.config.useLineBreaks);0===h.length&&a.dom.resolveList(d,e.config.useLineBreaks)}})},h=function(d,b,e){var g="UL"===b?"OL":"UL";e.selection.executeAndRestoreRangy(function(){for(var k=[d].concat(f(g,e)),h=k.length;h--;)a.dom.renameElement(k[h],b.toLowerCase())})},f=function(a,
b){b=b.selection.getOwnRanges();for(var d=[],f=b.length;f--;)d=d.concat(b[f].getNodes([1],function(d){return e(d,a)}));return d};return{exec:function(d,e,f){e=d.doc;var k="OL"===f?"insertOrderedList":"insertUnorderedList",l=d.selection.getSelection(),p=1===l.anchorNode.nodeType&&l.anchorNode.firstChild?l.anchorNode.childNodes[l.anchorOffset]:l.anchorNode,q=1===l.focusNode.nodeType&&l.focusNode.firstChild?l.focusNode.childNodes[l.focusOffset]||l.focusNode.lastChild:l.focusNode;l.isBackwards()&&(p=
[q,q=p][0]);a.dom.domNode(q).is.emptyTextNode(!0)&&q&&(q=a.dom.domNode(q).prev({nodeTypes:[1,3],ignoreBlankTexts:!0}));a.dom.domNode(p).is.emptyTextNode(!0)&&p&&(p=a.dom.domNode(p).next({nodeTypes:[1,3],ignoreBlankTexts:!0}));l=p&&q?p===q?p:a.dom.domNode(p).commonAncestor(q,d.element):d.selection.getSelectedNode();l=b(l,f,d);l.el?l.other?h(l.el,f,d):g(l.el,f,d):d.commands.support(k)?e.execCommand(k,!1,null):(e=rangy.saveSelection(d.win),k="_wysihtml-temp-"+(new Date).getTime(),d.commands.exec("formatBlock",
{nodeName:"div",className:k}),l=d.element.querySelector("."+k),l.innerHTML=l.innerHTML.replace(a.INVISIBLE_SPACE_REG_EXP,""),l&&(k=/^(\s|(<br>))+$/i.test(l.innerHTML),f=a.dom.convertToList(l,f.toLowerCase(),d.parent.config.classNames.uneditableContainer),e&&rangy.restoreSelection(e),k&&d.selection.selectNode(f.querySelector("li"),!0)))},state:function(a,e,f){e=a.selection.getSelectedNode();a=b(e,f,a);return a.el&&!a.other?a.el:!1}}}(wysihtml);
(function(a){a.commands.outdentList={exec:function(a,b,g){return(b=a.selection.getSelectionParentsByTag("LI"))?this.tryToPullLiLevel(b,a):!1},state:function(a,b){return!1},tryToPullLiLevel:function(e,b){var g,h,f,d,k,l=!1,n=this;b.selection.executeAndRestoreRangy(function(){for(var m=e.length;m--;)if(d=e[m],d.parentNode&&(g=d.parentNode,"OL"===g.tagName||"UL"===g.tagName)){l=!0;h=a.dom.getParentElement(g.parentNode,{query:"ol, ul"},!1,b.element);f=a.dom.getParentElement(g.parentNode,{query:"li"},
!1,b.element);if(h&&f)d.nextSibling&&(k=n.getAfterList(g,d),d.appendChild(k)),h.insertBefore(d,f.nextSibling);else{d.nextSibling&&(k=n.getAfterList(g,d),d.appendChild(k));for(var p=d.childNodes.length;p--;)g.parentNode.insertBefore(d.childNodes[p],g.nextSibling);g.parentNode.insertBefore(document.createElement("br"),g.nextSibling);d.parentNode.removeChild(d)}0===g.childNodes.length&&g.parentNode.removeChild(g)}});return l},getAfterList:function(a,b){for(a=document.createElement(a.nodeName);b.nextSibling;)a.appendChild(b.nextSibling);
return a}}})(wysihtml);(function(a){a.commands.redo={exec:function(a){return a.undoManager.redo()},state:function(a){return!1}}})(wysihtml);(function(a){var e={nodeName:"A"};a.commands.removeLink={exec:function(b,g){a.commands.formatInline.remove(b,g,e)},state:function(b,g){return a.commands.formatInline.state(b,g,e)}}})(wysihtml);(function(a){a.commands.undo={exec:function(a){return a.undoManager.undo()},state:function(a){return!1}}})(wysihtml);
(function(a){var e=a.dom;a.UndoManager=a.lang.Dispatcher.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.element=this.composer.element;this.position=0;this.historyStr=[];this.historyDom=[];this.transact();this._observe()},_observe:function(){var a=this;this.composer.sandbox.getDocument();var g;e.observe(this.element,"keydown",function(b){if(!b.altKey&&(b.ctrlKey||b.metaKey)){var e=b.keyCode,d=90===e&&b.shiftKey||89===e;90!==e||b.shiftKey?d&&(a.redo(),b.preventDefault()):
(a.undo(),b.preventDefault())}});e.observe(this.element,"keydown",function(b){b=b.keyCode;b!==g&&(g=b,8!==b&&46!==b||a.transact())});this.editor.on("newword:composer",function(){a.transact()}).on("beforecommand:composer",function(){a.transact()})},transact:function(){var b=this.historyStr[this.position-1],e=this.composer.getValue(!1,!1),h=0<this.element.offsetWidth&&0<this.element.offsetHeight,f;if(e!==b){25<(this.historyStr.length=this.historyDom.length=this.position)&&(this.historyStr.shift(),this.historyDom.shift(),
this.position--);this.position++;if(h){b=(f=this.composer.selection.getRange())&&f.startContainer?f.startContainer:this.element;h=f&&f.startOffset?f.startOffset:0;if(b.nodeType===a.ELEMENT_NODE)f=b;else{f=b.parentNode;var d=this.getChildNodeIndex(f,b)}f.setAttribute("data-wysihtml-selection-offset",h);"undefined"!==typeof d&&f.setAttribute("data-wysihtml-selection-node",d)}d=this.element.cloneNode(!!e);this.historyDom.push(d);this.historyStr.push(e);f&&(f.removeAttribute("data-wysihtml-selection-offset"),
f.removeAttribute("data-wysihtml-selection-node"))}},undo:function(){this.transact();this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return 1<this.position},redoPossible:function(){return this.position<this.historyStr.length},set:function(a){this.element.innerHTML="";for(var b=0,e=a.childNodes,f=a.childNodes.length;b<
f;b++)this.element.appendChild(e[b].cloneNode(!0));a.hasAttribute("data-wysihtml-selection-offset")?(b=a.getAttribute("data-wysihtml-selection-offset"),e=a.getAttribute("data-wysihtml-selection-node"),a=this.element):(a=this.element.querySelector("[data-wysihtml-selection-offset]")||this.element,b=a.getAttribute("data-wysihtml-selection-offset"),e=a.getAttribute("data-wysihtml-selection-node"),a.removeAttribute("data-wysihtml-selection-offset"),a.removeAttribute("data-wysihtml-selection-node"));null!==
e&&(a=this.getChildNodeByIndex(a,+e));this.composer.selection.set(a,b)},getChildNodeIndex:function(a,e){var b=0;a=a.childNodes;for(var f=a.length;b<f;b++)if(a[b]===e)return b},getChildNodeByIndex:function(a,e){return a.childNodes[e]}})})(wysihtml);
wysihtml.views.View=Base.extend({constructor:function(a,e,b){this.parent=a;this.element=e;this.config=b;this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var a=this;this.parent.on("beforeload",function(){a.parent.on("change_view",function(e){e===a.name?(a.parent.currentView=a,a.show(),setTimeout(function(){a.focus()},0)):a.hide()})})},focus:function(){if(!this.element||!this.element.ownerDocument||this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element&&
this.element.focus()}catch(a){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});
(function(a){var e=a.dom,b=a.browser;a.views.Composer=a.views.View.extend({name:"composer",constructor:function(a,b,e){this.base(a,b,e);this.config.noTextarea?this.editableArea=b:this.textarea=this.parent.textarea;this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=b.displaysCaretInEmptyContentEditableCorrectly()?"":"<br>"},getValue:function(b,e){var f=this.isEmpty()?"":a.quirks.getCorrectInnerHTML(this.element);!1!==b&&(f=this.parent.parse(f,
!1===e?!1:!0));return f},setValue:function(a,b){!1!==b&&(a=this.parent.parse(a));try{this.element.innerHTML=a}catch(f){this.element.innerText=a}},cleanUp:function(a){var b;this.selection&&this.selection.isInThisEditable()&&(b=rangy.saveSelection(this.win));this.parent.parse(this.element,void 0,a);b&&rangy.restoreSelection(b)},show:function(){this.editableArea.style.display=this._displayStyle||"";this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=
e.getStyle("display").from(this.editableArea);"none"===this._displayStyle&&(this._displayStyle=null);this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer");this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer");this.element.setAttribute("contentEditable","true")},focus:function(b){a.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear();this.base();var e=this.element.lastChild;b&&e&&this.selection&&
("BR"===e.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getScrollPos:function(){if(this.doc&&this.win){var a={};a.y="undefined"!==typeof this.win.pageYOffset?this.win.pageYOffset:(this.doc.documentElement||this.doc.body.parentNode||this.doc.body).scrollTop;a.x="undefined"!==typeof this.win.pageXOffset?this.win.pageXOffset:(this.doc.documentElement||this.doc.body.parentNode||this.doc.body).scrollLeft;return a}},setScrollPos:function(a){a&&
"undefined"!==typeof a.x&&"undefined"!==typeof a.y&&this.win.scrollTo(a.x,a.y)},getTextContent:function(){return e.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var a=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(a)||""===a||"<br>"===a||"<p></p>"===a||"<p><br></p>"===
a||this.hasPlaceholderSet()},_initContentEditableArea:function(){var a=this;this.config.noTextarea?this.sandbox=new e.ContentEditableArea(function(){a._create()},{className:this.config.classNames.sandbox},this.editableArea):(this.sandbox=new e.ContentEditableArea(function(){a._create()},{className:this.config.classNames.sandbox}),this.editableArea=this.sandbox.getContentEditable(),e.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var a=
this;this.sandbox=new e.Sandbox(function(){a._create()},{stylesheets:this.config.stylesheets,className:this.config.classNames.sandbox});this.editableArea=this.sandbox.getIframe();var b=this.textarea.element;e.insert(this.editableArea).after(b);this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var a=document.createElement("input");a.type="hidden";a.name="_wysihtml_mode";a.value=1;e.insert(a).after(this.textarea.element)}},_create:function(){var g=this;
this.doc=this.sandbox.getDocument();this.win=this.sandbox.getWindow();this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body;this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1));this.selection=new a.Selection(this.parent,this.element,this.config.classNames.uneditableContainer);this.commands=new a.Commands(this.parent);this.config.noTextarea||e.copyAttributes("className spellcheck title lang dir accessKey".split(" ")).from(this.textarea.element).to(this.element);
this._initAutoLinking();e.addClass(this.element,this.config.classNames.composer);this.config.style&&!this.config.contentEditableMode&&this.style();this.observe();var h=this.config.name;h&&(e.addClass(this.element,h),this.config.contentEditableMode||e.addClass(this.editableArea,h));this.enable();!this.config.noTextarea&&this.textarea.element.disabled&&this.disable();(h="string"===typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):
this.textarea.element.getAttribute("placeholder"))&&e.simulatePlaceholder(this.parent,this,h,this.config.classNames.placeholder);this.commands.exec("styleWithCSS",!1);this._initObjectResizing();this._initUndoManager();this._initLineBreaking();this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||b.isIos()||setTimeout(function(){g.focus(!0)},100);b.clearsContentEditableCorrectly()||a.quirks.ensureProperClearing(this);this.initSync&&
this.config.sync&&this.initSync();this.config.noTextarea||this.textarea.hide();this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var g=this,h=b.canDisableAutoLinking(),f=b.doesAutoLinkingInContentEditable();h&&this.commands.exec("AutoUrlDetect",!1,!1);if(this.config.autoLink){if(!f||f&&h)this.parent.on("newword:composer",function(){if(e.getTextContent(g.element).match(e.autoLink.URL_REG_EXP)){for(var d=g.selection.getSelectedNode(),b=g.element.querySelectorAll("."+g.config.classNames.uneditableContainer),
f=!1,k=b.length;k--;)a.dom.contains(b[k],d)&&(f=!0);f||e.autoLink(d,[g.config.classNames.uneditableContainer])}}),e.observe(this.element,"blur",function(){e.autoLink(g.element,[g.config.classNames.uneditableContainer])});var d=this.sandbox.getDocument().getElementsByTagName("a"),k=e.autoLink.URL_REG_EXP,l=function(d){d=a.lang.string(e.getTextContent(d)).trim();"www."===d.substr(0,4)&&(d="http://"+d);return d};e.observe(this.element,"keydown",function(a){if(d.length){a=g.selection.getSelectedNode(a.target.ownerDocument);
var b=e.getParentElement(a,{query:"a"},4);if(b){var f=l(b);setTimeout(function(){var a=l(b);a!==f&&a.match(k)&&b.setAttribute("href",a)},0)}}})}},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",!0);if(b.supportsEvent("resizeend")){var g=["width","height"],h=g.length,f=this.element;e.observe(f,"resizeend",function(d){d=d.target||d.srcElement;var b=d.style,e=0;if("IMG"===d.nodeName){for(;e<h;e++){var n=g[e];b[n]&&(d.setAttribute(n,parseInt(b[n],10)),b[n]="")}a.quirks.redraw(f)}})}},
_initUndoManager:function(){this.undoManager=new a.UndoManager(this.parent)},_initLineBreaking:function(){function g(a){var d=e.getParentElement(a,{query:"p, div"},2);d&&e.contains(h.element,d)&&h.selection.executeAndRestoreRangy(function(){h.config.useLineBreaks?((!d.firstChild||d.firstChild===d.lastChild&&1===d.firstChild.nodeType&&d.firstChild.classList.contains("rangySelectionBoundary"))&&d.appendChild(h.doc.createElement("br")),e.replaceWithChildNodes(d)):"P"!==d.nodeName&&e.renameElement(d,
"p")})}var h=this;this.config.useLineBreaks||e.observe(this.element,["focus"],function(){h.isEmpty()&&setTimeout(function(){var a=h.doc.createElement("P");h.element.innerHTML="";h.element.appendChild(a);b.displaysCaretInEmptyContentEditableCorrectly()?h.selection.selectNode(a,!0):(a.innerHTML="<br>",h.selection.setBefore(a.firstChild))},0)});e.observe(this.element,"keydown",function(b){var d=b.keyCode;if(!(b.shiftKey||b.ctrlKey||b.defaultPrevented||d!==a.ENTER_KEY&&d!==a.BACKSPACE_KEY)){var f=e.getParentElement(h.selection.getSelectedNode(),
{query:"li, p, h1, h2, h3, h4, h5, h6"},4);f?setTimeout(function(){var b=h.selection.getSelectedNode(),k;if("LI"===f.nodeName){if(!b)return;(k=e.getParentElement(b,{query:"ul, ol, menu"},2))||g(b)}d===a.ENTER_KEY&&f.nodeName.match(/^H[1-6]$/)&&g(b)},0):h.config.useLineBreaks&&d===a.ENTER_KEY&&!a.browser.insertsLineBreaksOnReturn()&&(b.preventDefault(),h.commands.exec("insertLineBreak"))}})}})})(wysihtml);
(function(a){var e=a.dom,b=document,g=window,h=b.createElement("div"),f="background-color color cursor font-family font-size font-style font-variant font-weight line-height letter-spacing text-align text-decoration text-indent text-rendering word-break word-wrap word-spacing".split(" "),d="background-color border-collapse border-bottom-color border-bottom-style border-bottom-width border-left-color border-left-style border-left-width border-right-color border-right-style border-right-width border-top-color border-top-style border-top-width clear display float margin-bottom margin-left margin-right margin-top outline-color outline-offset outline-width outline-style padding-left padding-right padding-top padding-bottom position top left right bottom z-index vertical-align text-align -webkit-box-sizing -moz-box-sizing -ms-box-sizing box-sizing -webkit-box-shadow -moz-box-shadow -ms-box-shadow box-shadow -webkit-border-top-right-radius -moz-border-radius-topright border-top-right-radius -webkit-border-bottom-right-radius -moz-border-radius-bottomright border-bottom-right-radius -webkit-border-bottom-left-radius -moz-border-radius-bottomleft border-bottom-left-radius -webkit-border-top-left-radius -moz-border-radius-topleft border-top-left-radius width height".split(" "),
k=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml-temp     { display: none; }",a.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],l=function(a){if(a.setActive)try{a.setActive()}catch(x){}else{var d=a.style,f=b.documentElement.scrollTop||
b.body.scrollTop,k=b.documentElement.scrollLeft||b.body.scrollLeft;d={position:d.position,top:d.top,left:d.left,WebkitUserSelect:d.WebkitUserSelect};e.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(a);a.focus();e.setStyles(d).on(a);g.scrollTo&&g.scrollTo(k,f)}};a.views.Composer.prototype.style=function(){var g=this,m=b.querySelector(":focus"),p=this.textarea.element,q=p.hasAttribute("placeholder"),x=q&&p.getAttribute("placeholder"),y=p.style.display,w=p.disabled,
B;this.focusStylesHost=h.cloneNode(!1);this.blurStylesHost=h.cloneNode(!1);this.disabledStylesHost=h.cloneNode(!1);q&&p.removeAttribute("placeholder");p===m&&p.blur();p.disabled=!1;p.style.display=B="none";if(p.getAttribute("rows")&&"auto"===e.getStyle("height").from(p)||p.getAttribute("cols")&&"auto"===e.getStyle("width").from(p))p.style.display=B=y;e.copyStyles(d).from(p).to(this.editableArea).andTo(this.blurStylesHost);e.copyStyles(f).from(p).to(this.element).andTo(this.blurStylesHost);e.insertCSS(k).into(this.element.ownerDocument);
p.disabled=!0;e.copyStyles(d).from(p).to(this.disabledStylesHost);e.copyStyles(f).from(p).to(this.disabledStylesHost);p.disabled=w;p.style.display=y;l(p);p.style.display=B;e.copyStyles(d).from(p).to(this.focusStylesHost);e.copyStyles(f).from(p).to(this.focusStylesHost);p.style.display=y;e.copyStyles(["display"]).from(p).to(this.editableArea);var C=a.lang.array(d).without(["display"]);m?l(m):p.blur();q&&p.setAttribute("placeholder",x);this.parent.on("focus:composer",function(){e.copyStyles(C).from(g.focusStylesHost).to(g.editableArea);
e.copyStyles(f).from(g.focusStylesHost).to(g.element)});this.parent.on("blur:composer",function(){e.copyStyles(C).from(g.blurStylesHost).to(g.editableArea);e.copyStyles(f).from(g.blurStylesHost).to(g.element)});this.parent.observe("disable:composer",function(){e.copyStyles(C).from(g.disabledStylesHost).to(g.editableArea);e.copyStyles(f).from(g.disabledStylesHost).to(g.element)});this.parent.observe("enable:composer",function(){e.copyStyles(C).from(g.blurStylesHost).to(g.editableArea);e.copyStyles(f).from(g.blurStylesHost).to(g.element)});
return this}})(wysihtml);
(function(a){var e=a.dom,b=e.domNode,g=a.browser,h={66:"bold",73:"italic",85:"underline"},f={addListeners:function(a,d,b){for(var e=0,f=d.length;e<f;e++)a.addEventListener(d[e],b,!1)},removeListeners:function(a,d,b){for(var e=0,f=d.length;e<f;e++)a.removeEventListener(d[e],b,!1)},fixLastBrDeletionInTable:function(d,b){if(d.selection.caretIsInTheEndOfNode()){var e=d.selection.getSelection(),f=e.anchorNode;if(f&&1===f.nodeType&&(a.dom.getParentElement(f,{query:"td, th"},!1,d.element)||b)&&(d=f.childNodes[e.anchorOffset])&&
1===d.nodeType&"BR"===d.nodeName)return d.parentNode.removeChild(d),!0}return!1},handleUneditableDeletion:function(a){var d=a.selection.getBeforeSelection(!0);if(d&&("element"===d.type||"leafnode"===d.type)&&1===d.node.nodeType&&d.node.classList.contains(a.config.classNames.uneditableContainer)){if(f.fixLastBrDeletionInTable(a,!0))return!0;try{var b=new CustomEvent("wysihtml:uneditable:delete",{bubbles:!0,cancelable:!1});d.node.dispatchEvent(b)}catch(v){}d.node.parentNode.removeChild(d.node);return!0}return!1},
fixDeleteInTheBeginningOfBlock:function(d){var e=d.selection,f=e.getPreviousNode();if(e.caretIsFirstInSelection(a.browser.usesControlRanges())&&f&&1===f.nodeType&&a.dom.domNode(f).is.block()&&!b(f).test({query:"ol, ul, table, tr, dl"})){if(/^\s*$/.test(f.textContent||f.innerText))return f.parentNode.removeChild(f),!0;if(f.lastChild){var g=f.lastChild,k=e.getSelectedNode(),h=b(f).commonAncestor(k,d.element);if(d=a.dom.getParentElement(k,{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"},!1,
h||d.element))return b(d).transferContentTo(f,!0),e.setAfter(g),!0;if(a.browser.usesControlRanges())return k=e.getCaretNode(),b(k).transferContentTo(f,!0),e.setAfter(g),!0}}return!1},fixDeleteInTheBeginningOfLi:function(d){if(a.browser.hasLiDeletingProblem()){var e=d.selection.getSelection(),f=e.anchorNode;var g=d.selection.caretIsFirstInSelection();3===f.nodeType&&0===e.anchorOffset&&f===f.parentNode.firstChild&&(f=f.parentNode,g=!0);if(g&&f&&1===f.nodeType&&"LI"===f.nodeName){e=b(f).prev({nodeTypes:[1,
3],ignoreBlankTexts:!0});if(!e&&f.parentNode&&("UL"===f.parentNode.nodeName||"OL"===f.parentNode.nodeName)){e=b(f.parentNode).prev({nodeTypes:[1,3],ignoreBlankTexts:!0});var k=f.parentNode}if(e)return g=f.firstChild,b(f).transferContentTo(e,!0),k&&0===k.children.length&&k.remove(),g?d.selection.setBefore(g):e&&(1===e.nodeType?e.lastChild?d.selection.setAfter(e.lastChild):d.selection.selectNode(e):d.selection.setAfter(e)),!0}}return!1},fixDeleteInTheBeginningOfControlSelection:function(a){var d=a.selection,
e=d.getPreviousNode(),f=d.getSelectedNode();return d.caretIsFirstInSelection()?(3===f.nodeType&&(f=f.parentNode),d=f.firstChild,b(f).transferContentTo(e,!0),d&&a.selection.setBefore(d),!0):!1},doLineBreaksModeEnterWithCaret:function(d){var f,g=!1;if(f=d.selection.getNodesNearCaret()){if(f.caretNode||f.nextNode){var k=e.getParentElement(f.caretNode||f.nextNode,{query:"p, pre, div, blockquote"},2);k===d.element&&(k=void 0)}if(k&&f.caretNode)if(b(f.caretNode).is.lineBreak()){if(d.config.doubleLineBreakEscapesBlock){g=
!0;f.caretNode.parentNode.removeChild(f.caretNode);b(f.nextNode).is.lineBreak()&&f.nextNode.parentNode.removeChild(f.nextNode);var h=d.doc.createElement("br");b(f.nextNode).is.lineBreak()&&f.nextNode===k.lastChild?k.parentNode.insertBefore(h,k.nextSibling):d.selection.splitElementAtCaret(k,h);f.nextNode&&3===f.nextNode.nodeType&&(f.nextNode.data=f.nextNode.data.replace(/^ *[\r\n]+/,""));d.selection.setBefore(h)}}else 3===f.caretNode.nodeType&&a.browser.hasCaretBlockElementIssue()&&f.textOffset===
f.caretNode.data.length&&!f.nextNode&&(g=!0,f=d.doc.createElement("br"),k=d.doc.createElement("br"),h=d.doc.createDocumentFragment(),h.appendChild(f),h.appendChild(k),d.selection.insertNode(h),d.selection.setBefore(k))}return g}},d=function(d,b){var e=b.selection;e.isCollapsed()?b.isEmpty()&&!b.config.useLineBreaks?d.preventDefault():f.handleUneditableDeletion(b)?d.preventDefault():f.fixDeleteInTheBeginningOfLi(b)?d.preventDefault():f.fixDeleteInTheBeginningOfBlock(b)?d.preventDefault():f.fixLastBrDeletionInTable(b)?
d.preventDefault():a.browser.usesControlRanges()&&f.fixDeleteInTheBeginningOfControlSelection(b)&&d.preventDefault():e.containsUneditable()&&(d.preventDefault(),e.deleteContents())},k=function(a,d){!d.config.useLineBreaks||a.shiftKey||a.ctrlKey||d.selection.isCollapsed()&&f.doLineBreaksModeEnterWithCaret(d)&&a.preventDefault();if(g.hasCaretAtLinkEndInsertionProblems()&&d.selection.caretIsInTheEndOfNode()){var b=(a=d.selection.getSelectedNode(!0))&&3===a.nodeType?a.parentNode:a;b&&b.closest("a")&&
3===a.nodeType&&a===b.lastChild&&d.selection.setAfter(b)}},l=function(a,d,b){if(!a.selection.isCollapsed())a.selection.deleteContents();else if(a.selection.caretIsInTheBeginnig("li"))if(b){if(a.commands.exec("outdentList"))return}else if(a.commands.exec("indentList"))return;a.commands.exec("insertHTML","&emsp;")},n=function(a){this.domNodeRemovedInterval&&clearInterval(domNodeRemovedInterval);this.parent.fire("destroy:composer")},m=function(a){this.parent.fire("beforeinteraction",a).fire("beforeinteraction:composer",
a);setTimeout(function(){this.parent.fire("interaction",a).fire("interaction:composer",a)}.bind(this),0)},p=function(a){this.parent.fire("focus",a).fire("focus:composer",a);setTimeout(function(){this.focusState=this.getValue(!1,!1)}.bind(this),0)},q=function(a){if(this.focusState!==this.getValue(!1,!1)){var d=a;"function"==typeof Object.create&&(d=Object.create(a,{type:{value:"change"}}));this.parent.fire("change",d).fire("change:composer",d)}this.parent.fire("blur",a).fire("blur:composer",a)},x=
function(a){this.parent.fire(a.type,a).fire(a.type+":composer",a);"paste"===a.type&&setTimeout(function(){this.parent.fire("newword:composer")}.bind(this),0)},y=function(d){this.config.copyedFromMarking&&(a.browser.supportsModernPaste()&&(d.clipboardData.setData("text/html",this.config.copyedFromMarking+this.selection.getHtml()),d.clipboardData.setData("text/plain",this.selection.getPlainText()),d.preventDefault()),this.parent.fire(d.type,d).fire(d.type+":composer",d))},w=function(d){d=d.keyCode;
d!==a.SPACE_KEY&&d!==a.ENTER_KEY||this.parent.fire("newword:composer")},B=function(d){if(!g.canSelectImagesInContentEditable()){var b=d.target,e=this.element.querySelectorAll("img"),f=this.element.querySelectorAll("."+this.config.classNames.uneditableContainer+" img");e=a.lang.array(e).without(f);"IMG"===b.nodeName&&a.lang.array(e).contains(b)&&this.selection.selectNode(b)}a.browser.usesControlRanges()&&(this.selection.lastMouseDownPos={x:d.clientX,y:d.clientY},setTimeout(function(){delete this.selection.lastMouseDownPos}.bind(this),
0))},C=function(a){var d=this.selection.lastMouseDownPos;if(d){var b=document.body.createTextRange();setTimeout(function(){try{b.moveToPoint(d.x,d.y),b.select()}catch(v){}}.bind(this),0)}},H=function(d){this.config.classNames.uneditableContainer&&(d=a.dom.getParentElement(d.target,{query:"."+this.config.classNames.uneditableContainer},!1,this.element))&&this.selection.setAfter(d)},D=function(a){g.canSelectImagesInContentEditable()||setTimeout(function(){this.selection.getSelection().removeAllRanges()}.bind(this),
0)},t=function(b){var e=b.keyCode,f=h[e],g=this.selection.getSelectedNode(!0);!b.ctrlKey&&!b.metaKey||b.altKey||65!==e?((b.ctrlKey||b.metaKey)&&!b.altKey&&f&&(this.commands.exec(f),b.preventDefault()),e===a.BACKSPACE_KEY&&d(b,this),e!==a.BACKSPACE_KEY&&e!==a.DELETE_KEY||!g||"IMG"!==g.nodeName||(b.preventDefault(),f=g.parentNode,f.removeChild(g),"A"!==f.nodeName||f.firstChild||f.parentNode.removeChild(f),setTimeout(function(){a.quirks.redraw(this.element)}.bind(this),0)),this.config.handleTabKey&&
e===a.TAB_KEY&&(b.preventDefault(),l(this,this.element,b.shiftKey)),e===a.ENTER_KEY&&k(b,this)):(this.selection.selectAll(),b.preventDefault())},z=function(d){if(0!==d.which&&this.selection.caretIsInTheEndOfNode()){var b=this.selection.getSelectedNode(!0),e=b&&3===b.nodeType?b.parentNode:b;if(e&&e.closest("a")&&b===e.lastChild)if(32!==d.which||this.selection.caretIsInTheEndOfNode(!0)&&g.hasCaretAtLinkEndInsertionProblems()){var f=this.doc.createTextNode(a.INVISIBLE_SPACE);this.selection.insertNode(f);
this.selection.setBefore(f);setTimeout(function(){1<f.textContent.length?(f.textContent=f.textContent.replace(a.INVISIBLE_SPACE_REG_EXP,""),this.selection.setAfter(f)):f.remove()}.bind(this),0)}else 32===d.which&&3===b.nodeType&&/[\u00A0 ]$/.test(b.textContent)&&(b.textContent=b.textContent.replace(/[\u00A0 ]$/,""),b=this.doc.createTextNode(" "),e.parentNode.insertBefore(b,e.nextSibling),this.selection.setAfter(b,!1),d.preventDefault())}};a.views.Composer.prototype.observeActions=f;a.views.Composer.prototype.observe=
function(){var d=this,b=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),k=g.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?this.element:this.sandbox.getWindow();this.focusState=this.getValue(!1,!1);this.actions=f;g.supportsMutationObserver()?(new MutationObserver(function(a){a.forEach(function(a){0<a.removedNodes.length&&!e.contains(document.documentElement,b)&&n.call(d)})})).observe(b.parentNode,{childList:!0}):g.supportsMutationEvents()?b.addEventListener(["DOMNodeRemoved"],
n.bind(this),!1):this.domNodeRemovedInterval=setInterval(function(){e.contains(document.documentElement,b)||n.call(this)},250);f.addListeners(k,["drop","paste","mouseup","focus","keyup"],m.bind(this));k.addEventListener("focus",p.bind(this),!1);k.addEventListener("blur",q.bind(this),!1);f.addListeners(this.element,["drop","paste","beforepaste"],x.bind(this),!1);this.element.addEventListener("copy",y.bind(this),!1);this.element.addEventListener("mousedown",B.bind(this),!1);this.element.addEventListener("click",
H.bind(this),!1);this.element.addEventListener("drop",D.bind(this),!1);this.element.addEventListener("keyup",w.bind(this),!1);this.element.addEventListener("keydown",t.bind(this),!1);this.element.addEventListener("keypress",z.bind(this),!1);a.browser.usesControlRanges()&&this.element.addEventListener("mscontrolselect",C.bind(this),!1);this.element.addEventListener("dragenter",function(){this.parent.fire("unset_placeholder")}.bind(this),!1)}})(wysihtml);
(function(a){a.views.Synchronizer=Base.extend({constructor:function(a,b,g){this.editor=a;this.textarea=b;this.composer=g;this._observe()},fromComposerToTextarea:function(e){this.textarea.setValue(a.lang.string(this.composer.getValue(!1,!1)).trim(),e)},fromTextareaToComposer:function(a){var b=this.textarea.getValue(!1,!1);b?this.composer.setValue(b,a):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(a){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(a):
this.fromComposerToTextarea(a)},_observe:function(){var e,b=this,g=this.textarea.element.form,h=function(){e=setInterval(function(){b.fromComposerToTextarea()},400)},f=function(){clearInterval(e);e=null};h();g&&(a.dom.observe(g,"submit",function(){b.sync(!0)}),a.dom.observe(g,"reset",function(){setTimeout(function(){b.fromTextareaToComposer()},0)}));this.editor.on("change_view",function(a){"composer"!==a||e?"textarea"===a&&(b.fromComposerToTextarea(!0),f()):(b.fromTextareaToComposer(!0),h())});this.editor.on("destroy:composer",
f)}})})(wysihtml);
(function(a){a.views.SourceView=Base.extend({constructor:function(a,b){this.editor=a;this.composer=b;this._observe()},switchToTextarea:function(a){var b=this.composer.win.getComputedStyle(this.composer.element),e=parseFloat(b.width);b=Math.max(parseFloat(b.height),100);this.textarea||(this.textarea=this.composer.doc.createElement("textarea"),this.textarea.className="wysihtml-source-view");this.textarea.style.width=e+"px";this.textarea.style.height=b+"px";this.textarea.value=this.editor.getValue(a,!0);
this.composer.element.parentNode.insertBefore(this.textarea,this.composer.element);this.editor.currentView="source";this.composer.element.style.display="none"},switchToComposer:function(a){var b=this.textarea.value;b?this.composer.setValue(b,a):(this.composer.clear(),this.editor.fire("set_placeholder"));this.textarea.parentNode.removeChild(this.textarea);this.editor.currentView=this.composer;this.composer.element.style.display=""},_observe:function(){this.editor.on("change_view",function(a){"composer"===
a?this.switchToComposer(!0):"textarea"===a&&this.switchToTextarea(!0)}.bind(this))}})})(wysihtml);
wysihtml.views.Textarea=wysihtml.views.View.extend({name:"textarea",constructor:function(a,e,b){this.base(a,e,b);this._observe()},clear:function(){this.element.value=""},getValue:function(a){var e=this.isEmpty()?"":this.element.value;!1!==a&&(e=this.parent.parse(e));return e},setValue:function(a,e){!1!==e&&(a=this.parent.parse(a));this.element.value=a},cleanUp:function(a){a=this.parent.parse(this.element.value,void 0,a);this.element.value=a},hasPlaceholderSet:function(){var a=wysihtml.browser.supportsPlaceholderAttributeOn(this.element),
e=this.element.getAttribute("placeholder")||null,b=this.element.value;return a&&!b||b===e},isEmpty:function(){return!wysihtml.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var a=this.element,e=this.parent,b={focusin:"focus",focusout:"blur"},g=wysihtml.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.on("beforeload",function(){wysihtml.dom.observe(a,g,function(a){a=b[a.type]||a.type;e.fire(a).fire(a+":textarea")});
wysihtml.dom.observe(a,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}});
(function(a){a.Editor=a.lang.Dispatcher.extend({defaults:{name:void 0,style:!0,autoLink:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{},b:{},i:{},u:{}},classes:{}},pasteParserRulesets:null,parser:a.dom.parse,useLineBreaks:!0,doubleLineBreakEscapesBlock:!0,stylesheets:[],placeholderText:void 0,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,classNames:{composer:"wysihtml-editor",body:"wysihtml-supported",sandbox:"wysihtml-sandbox",placeholder:"wysihtml-placeholder",uneditableContainer:"wysihtml-uneditable-container"},
copyedFromMarking:'<meta name="copied-from" content="wysihtml">'},constructor:function(e,b){this.editableElement="string"===typeof e?document.getElementById(e):e;this.config=a.lang.object({}).merge(this.defaults).merge(b).get();this._isCompatible=a.browser.supported();b&&b.classNames&&a.lang.object(this.config.classNames).merge(b.classNames);"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0);this.config.noTextarea||(this.currentView=
this.textarea=new a.views.Textarea(this,this.editableElement,this.config));if(!this._isCompatible||!this.config.supportTouchDevices&&a.browser.isTouchDevice()){var g=this;setTimeout(function(){g.fire("beforeload").fire("load")},0)}else a.dom.addClass(document.body,this.config.classNames.body),this.currentView=this.composer=new a.views.Composer(this,this.editableElement,this.config),"function"===typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea?
this.sourceView=new a.views.SourceView(this,this.composer):this.synchronizer=new a.views.Synchronizer(this,this.textarea,this.composer);this.runEditorExtenders()},runEditorExtenders:function(){a.editorExtenders.forEach(function(a){a(this)}.bind(this))},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(a,b){return this.currentView.getValue(a,b)},setValue:function(a,b){this.fire("unset_placeholder");if(!a)return this.clear();
this.currentView.setValue(a,b);return this},cleanUp:function(a){this.currentView.cleanUp(a)},focus:function(a){this.currentView.focus(a);return this},disable:function(){this.currentView.disable();return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},destroy:function(){this.composer&&this.composer.sandbox&&this.composer.sandbox.destroy();this.fire("destroy:composer");
this.off()},parse:function(e,b,g){var h=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null;b=this.config.parser(e,{rules:g||this.config.parserRules,cleanUp:this.config.cleanUp,context:h,uneditableClass:this.config.classNames.uneditableContainer,clearInternals:b});"object"===typeof e&&a.quirks.redraw(e);return b},_initParser:function(){var e;if(a.browser.supportsModernPaste())this.on("paste:composer",function(b){b.preventDefault();(e=a.dom.getPastedHtml(b))&&
this._cleanAndPaste(e)}.bind(this));else this.on("beforepaste:composer",function(b){b.preventDefault();var e=this.composer.getScrollPos();a.dom.getPastedHtmlWithDiv(this.composer,function(a){a&&this._cleanAndPaste(a);this.composer.setScrollPos(e)}.bind(this))}.bind(this))},_cleanAndPaste:function(e){e=a.quirks.cleanPastedHTML(e,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],uneditableClass:this.config.classNames.uneditableContainer});this.composer.selection.deleteContents();
this.composer.selection.insertHTML(e)}})})(wysihtml);wysihtml.commands.alignCenterStyle=function(){var a={styleProperty:"textAlign",styleValue:"center",toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.alignJustifyStyle=function(){var a={styleProperty:"textAlign",styleValue:"justify",toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.alignLeftStyle=function(){var a={styleProperty:"textAlign",styleValue:"left",toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.alignRightStyle=function(){var a={styleProperty:"textAlign",styleValue:"right",toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.bgColorStyle=function(){return{exec:function(a,e,b){if(b=wysihtml.quirks.styleParser.parseColor("background-color:"+(b.color||b),"background-color"))b=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")",wysihtml.commands.formatInline.exec(a,e,{styleProperty:"backgroundColor",styleValue:b})},state:function(a,e,b){b=b?wysihtml.quirks.styleParser.parseColor("background-color:"+(b.color||b),"background-color"):null;var g;b&&(g=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):
"rgba("+b.join(", "))+")");return wysihtml.commands.formatInline.state(a,e,{styleProperty:"backgroundColor",styleValue:g})},remove:function(a,e){return wysihtml.commands.formatInline.remove(a,e,{styleProperty:"backgroundColor"})},stateValue:function(a,e,b){(a=this.state(a,e))&&wysihtml.lang.object(a).isArray()&&(a=a[0]);return a&&(a=a.getAttribute("style"))?(a=wysihtml.quirks.styleParser.parseColor(a,"background-color"),wysihtml.quirks.styleParser.unparseColor(a,b)):!1}}}();
wysihtml.commands.bold=function(){var a={nodeName:"B",toggle:!0};return{exec:function(e,b){wysihtml.commands.formatInline.exec(e,b,a)},state:function(e,b){return wysihtml.commands.formatInline.state(e,b,a)}}}();
wysihtml.commands.formatCode=function(){return{exec:function(a,e,b){var g=this.state(a)[0];if(g)a.selection.executeAndRestore(function(){f=g.querySelector("code");wysihtml.dom.replaceWithChildNodes(g);f&&wysihtml.dom.replaceWithChildNodes(f)});else{e=a.selection.getRange();var h=e.extractContents();g=a.doc.createElement("pre");var f=a.doc.createElement("code");b&&(f.className=b);g.appendChild(f);f.appendChild(h);e.insertNode(g);a.selection.selectNode(g)}},state:function(a){return(a=a.selection.getSelectedNode())&&
a.nodeName&&"PRE"==a.nodeName&&a.firstChild&&a.firstChild.nodeName&&"CODE"==a.firstChild.nodeName?[a]:(a=wysihtml.dom.getParentElement(a,{query:"pre code"}))?[a.parentNode]:!1}}}();
wysihtml.commands.insertImage=function(){return{exec:function(a,e,b){b="object"===typeof b?b:{src:b};var g=a.doc;if((e=this.state(a))&&!b.src)a.selection.setBefore(e),b=e.parentNode,b.removeChild(e),wysihtml.dom.removeEmptyTextNodes(b),"A"!==b.nodeName||b.firstChild||(a.selection.setAfter(b),b.parentNode.removeChild(b)),wysihtml.quirks.redraw(a.element);else if(e)for(var h in b)b.hasOwnProperty(h)&&e.setAttribute("className"===h?"class":h,b[h]);else{e=g.createElement("IMG");for(var f in b)e.setAttribute("className"===
f?"class":f,b[f]);a.selection.insertNode(e);wysihtml.browser.hasProblemsSettingCaretAfterImg()?(b=g.createTextNode(wysihtml.INVISIBLE_SPACE),a.selection.insertNode(b),a.selection.setAfter(b)):a.selection.setAfter(e)}},state:function(a){if(!wysihtml.dom.hasElementWithTagName(a.doc,"IMG"))return!1;var e=a.selection.getSelectedNode();if(!e)return!1;if("IMG"===e.nodeName)return e;if(e.nodeType!==wysihtml.ELEMENT_NODE)return!1;e=a.selection.getText();if(e=wysihtml.lang.string(e).trim())return!1;a=a.selection.getNodes(wysihtml.ELEMENT_NODE,
function(a){return"IMG"===a.nodeName});return 1!==a.length?!1:a[0]}}}();wysihtml.commands.fontSize=function(){var a=/wysiwyg-font-size-[0-9a-z\-]+/g;return{exec:function(e,b,g){wysihtml.commands.formatInline.exec(e,b,{className:"wysiwyg-font-size-"+g,classRegExp:a,toggle:!0})},state:function(a,b,g){return wysihtml.commands.formatInline.state(a,b,{className:"wysiwyg-font-size-"+g})}}}();
wysihtml.commands.fontSizeStyle=function(){return{exec:function(a,e,b){b=b.size||b;/^\s*$/.test(b)||wysihtml.commands.formatInline.exec(a,e,{styleProperty:"fontSize",styleValue:b,toggle:!1})},state:function(a,e,b){return wysihtml.commands.formatInline.state(a,e,{styleProperty:"fontSize",styleValue:b||void 0})},remove:function(a,e){return wysihtml.commands.formatInline.remove(a,e,{styleProperty:"fontSize"})},stateValue:function(a,e){(a=this.state(a,e))&&wysihtml.lang.object(a).isArray()&&(a=a[0]);
return a&&(a=a.getAttribute("style"))?wysihtml.quirks.styleParser.parseFontSize(a):!1}}}();wysihtml.commands.foreColor=function(){var a=/wysiwyg-color-[0-9a-z]+/g;return{exec:function(e,b,g){wysihtml.commands.formatInline.exec(e,b,{className:"wysiwyg-color-"+g,classRegExp:a,toggle:!0})},state:function(a,b,g){return wysihtml.commands.formatInline.state(a,b,{className:"wysiwyg-color-"+g})}}}();
wysihtml.commands.foreColorStyle=function(){return{exec:function(a,e,b){b&&(b=wysihtml.quirks.styleParser.parseColor("color:"+(b.color||b),"color"))&&(b=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")",wysihtml.commands.formatInline.exec(a,e,{styleProperty:"color",styleValue:b}))},state:function(a,e,b){b=b?wysihtml.quirks.styleParser.parseColor("color:"+(b.color||b),"color"):null;var g;b&&(g=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")");return wysihtml.commands.formatInline.state(a,
e,{styleProperty:"color",styleValue:g})},remove:function(a,e){return wysihtml.commands.formatInline.remove(a,e,{styleProperty:"color"})},stateValue:function(a,e,b){(a=this.state(a,e))&&wysihtml.lang.object(a).isArray()&&(a=a[0]);return a&&(a=a.getAttribute("style"))?(a=wysihtml.quirks.styleParser.parseColor(a,"color"),wysihtml.quirks.styleParser.unparseColor(a,b)):!1}}}();
wysihtml.commands.insertBlockQuote=function(){var a={nodeName:"BLOCKQUOTE",toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.insertHorizontalRule=function(){return{exec:function(a){var e=a.selection.getSelectedNode();e=wysihtml.dom.getParentElement(e,{query:wysihtml.PERMITTED_PHRASING_CONTENT_ONLY},null,a.editableArea);var b=document.createElement("hr");e?a.selection.splitElementAtCaret(e,b):a.selection.insertNode(b);b.nextSibling?a.selection.setBefore(b.nextSibling):a.selection.setAfter(b)},state:function(){return!1}}}();
wysihtml.commands.insertOrderedList=function(){return{exec:function(a,e){wysihtml.commands.insertList.exec(a,e,"OL")},state:function(a,e){return wysihtml.commands.insertList.state(a,e,"OL")}}}();wysihtml.commands.insertUnorderedList=function(){return{exec:function(a,e){wysihtml.commands.insertList.exec(a,e,"UL")},state:function(a,e){return wysihtml.commands.insertList.state(a,e,"UL")}}}();
wysihtml.commands.italic=function(){var a={nodeName:"I",toggle:!0};return{exec:function(e,b){wysihtml.commands.formatInline.exec(e,b,a)},state:function(e,b){return wysihtml.commands.formatInline.state(e,b,a)}}}();
wysihtml.commands.justifyCenter=function(){var a={className:"wysiwyg-text-align-center",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.justifyFull=function(){var a={className:"wysiwyg-text-align-justify",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.justifyLeft=function(){var a={className:"wysiwyg-text-align-left",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.justifyRight=function(){var a={className:"wysiwyg-text-align-right",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};return{exec:function(e,b){return wysihtml.commands.formatBlock.exec(e,"formatBlock",a)},state:function(e,b){return wysihtml.commands.formatBlock.state(e,"formatBlock",a)}}}();
wysihtml.commands.subscript=function(){var a={nodeName:"SUB",toggle:!0};return{exec:function(e,b){wysihtml.commands.formatInline.exec(e,b,a)},state:function(e,b){return wysihtml.commands.formatInline.state(e,b,a)}}}();wysihtml.commands.superscript=function(){var a={nodeName:"SUP",toggle:!0};return{exec:function(e,b){wysihtml.commands.formatInline.exec(e,b,a)},state:function(e,b){return wysihtml.commands.formatInline.state(e,b,a)}}}();
wysihtml.commands.underline=function(){var a={nodeName:"U",toggle:!0};return{exec:function(e,b){wysihtml.commands.formatInline.exec(e,b,a)},state:function(e,b){return wysihtml.commands.formatInline.state(e,b,a)}}}();wysihtml.commands.addTableCells={exec:function(a,e,b){if(a.tableSelection&&a.tableSelection.start&&a.tableSelection.end){var g=wysihtml.dom.table.orderSelectionEnds(a.tableSelection.start,a.tableSelection.end);"before"==b||"above"==b?wysihtml.dom.table.addCells(g.start,b):("after"==b||"below"==b)&&wysihtml.dom.table.addCells(g.end,b);setTimeout(function(){a.tableSelection.select(g.start,g.end)},0)}},state:function(a,e){return!1}};
wysihtml.commands.createTable={exec:function(a,e,b){var g;if(b&&b.cols&&b.rows&&0<parseInt(b.cols,10)&&0<parseInt(b.rows,10)){var h=b.tableStyle?'<table style="'+b.tableStyle+'">':"<table>";h+="<tbody>";for(g=0;g<b.rows;g++){h+="<tr>";for(e=0;e<b.cols;e++)h+="<td><br></td>";h+="</tr>"}a.commands.exec("insertHTML",h+"</tbody></table>")}},state:function(a,e){return!1}};
wysihtml.commands.deleteTableCells={exec:function(a,e,b){if(a.tableSelection&&a.tableSelection.start&&a.tableSelection.end){e=wysihtml.dom.table.orderSelectionEnds(a.tableSelection.start,a.tableSelection.end);var g=wysihtml.dom.table.indexOf(e.start),h,f=a.tableSelection.table;wysihtml.dom.table.removeCells(e.start,b);setTimeout(function(){h=wysihtml.dom.table.findCell(f,g);h||("row"==b&&(h=wysihtml.dom.table.findCell(f,{row:g.row-1,col:g.col})),"column"==b&&(h=wysihtml.dom.table.findCell(f,{row:g.row,
col:g.col-1})));h&&a.tableSelection.select(h,h)},0)}},state:function(a,e){return!1}};
wysihtml.commands.mergeTableCells={exec:function(a,e){a.tableSelection&&a.tableSelection.start&&a.tableSelection.end&&(this.state(a,e)?wysihtml.dom.table.unmergeCell(a.tableSelection.start):wysihtml.dom.table.mergeCellsBetween(a.tableSelection.start,a.tableSelection.end))},state:function(a,e){return a.tableSelection&&(e=a.tableSelection.start,a=a.tableSelection.end,e&&a&&e==a&&(wysihtml.dom.getAttribute(e,"colspan")&&1<parseInt(wysihtml.dom.getAttribute(e,"colspan"),10)||wysihtml.dom.getAttribute(e,
"rowspan")&&1<parseInt(wysihtml.dom.getAttribute(e,"rowspan"),10)))?[e]:!1}};
(function(){function a(a,b){for(var d=[],e,f=0,g=a.length;f<g;f++)if(e=a[f].querySelectorAll(b))for(var k=e.length;k--;d.unshift(e[k]));return d}function e(a){a.parentNode.removeChild(a)}function b(a,b){a.parentNode.insertBefore(b,a.nextSibling)}var g=wysihtml.dom,h=function(a){this.el=a;this.isRowspan=this.isColspan=!1;this.isReal=this.lastRow=this.firstRow=this.lastCol=this.firstCol=!0;this.spanCollection=[];this.modified=!1},f=function(a,b){a?(this.cell=a,this.table=g.getParentElement(a,{query:"table"})):
b&&(this.table=b,this.cell=this.table.querySelectorAll("th, td")[0])};f.prototype={addSpannedCellToMap:function(a,b,e,f,g,p){for(var d=[],k=e+(p?parseInt(p,10)-1:0),l=f+(g?parseInt(g,10)-1:0),n=e;n<=k;n++){"undefined"==typeof b[n]&&(b[n]=[]);for(var m=f;m<=l;m++)b[n][m]=new h(a),b[n][m].isColspan=g&&1<parseInt(g,10),b[n][m].isRowspan=p&&1<parseInt(p,10),b[n][m].firstCol=m==f,b[n][m].lastCol=m==l,b[n][m].firstRow=n==e,b[n][m].lastRow=n==k,b[n][m].isReal=m==f&&n==e,b[n][m].spanCollection=d,d.push(b[n][m])}},
setCellAsModified:function(a){a.modified=!0;if(0<a.spanCollection.length)for(var d=0,b=a.spanCollection.length;d<b;d++)a.spanCollection[d].modified=!0},setTableMap:function(){var a=[],b=this.getTableRows(),e,f,m;for(e=0;e<b.length;e++){var p=b[e];p=this.getRowCells(p);var q=0;"undefined"==typeof a[e]&&(a[e]=[]);for(f=0;f<p.length;f++){for(m=p[f];"undefined"!=typeof a[e][q];)q++;var x=g.getAttribute(m,"colspan");var y=g.getAttribute(m,"rowspan");x||y?(this.addSpannedCellToMap(m,a,e,q,x,y),q+=x?parseInt(x,
10):1):(a[e][q]=new h(m),q++)}}return this.map=a},getRowCells:function(d){var b=this.table.querySelectorAll("table");b=b?a(b,"th, td"):[];d=d.querySelectorAll("th, td");return 0<b.length?wysihtml.lang.array(d).without(b):d},getTableRows:function(){var d=this.table.querySelectorAll("table");d=d?a(d,"tr"):[];var b=this.table.querySelectorAll("tr");return 0<d.length?wysihtml.lang.array(b).without(d):b},getMapIndex:function(a){for(var d=this.map.length,b=this.map&&this.map[0]?this.map[0].length:0,e=0;e<
d;e++)for(var f=0;f<b;f++)if(this.map[e][f].el===a)return{row:e,col:f};return!1},getElementAtIndex:function(a){this.setTableMap();return this.map[a.row]&&this.map[a.row][a.col]&&this.map[a.row][a.col].el?this.map[a.row][a.col].el:null},getMapElsTo:function(a){var d=[];this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(a);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=
this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);if(null!=this.idx_start&&null!=this.idx_end){a=this.idx_start.row;for(var b=this.idx_end.row;a<=b;a++)for(var e=this.idx_start.col,f=this.idx_end.col;e<=f;e++)d.push(this.map[a][e].el)}return d},orderSelectionEnds:function(a){this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(a);if(this.idx_start.row>this.idx_end.row||
this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(a,b,e){for(var d=this.table.ownerDocument,f=d.createDocumentFragment(),g,k=0;k<b;k++){g=d.createElement(a);if(e)for(var h in e)e.hasOwnProperty(h)&&
g.setAttribute(h,e[h]);g.appendChild(document.createTextNode("\u00a0"));f.appendChild(g)}return f},correctColIndexForUnreals:function(a,b){b=this.map[b];for(var d=-1,e=0;e<a;e++)b[e].isReal&&d++;return d},getLastNewCellOnRow:function(a,b){a=this.getRowCells(a);for(var d,e,f=0,g=a.length;f<g;f++)if(d=a[f],e=this.getMapIndex(d),!1===e||"undefined"!=typeof b&&e.row!=b)return d;return null},removeEmptyTable:function(){var a=this.table.querySelectorAll("td, th");if(a&&0!=a.length)return!1;e(this.table);
return!0},splitRowToCells:function(a){if(a.isColspan){var d=parseInt(g.getAttribute(a.el,"colspan")||1,10),e=a.el.tagName.toLowerCase();1<d&&(d=this.createCells(e,d-1),b(a.el,d));a.el.removeAttribute("colspan")}},getRealRowEl:function(a,b){var d=null;b=b||this.idx;for(var e=0,f=this.map[b.row].length;e<f;e++){var k=this.map[b.row][e];if(k.isReal&&(d=g.getParentElement(k.el,{query:"tr"})))return d}null===d&&a&&(d=g.getParentElement(this.map[b.row][b.col].el,{query:"tr"})||null);return d},injectRowAt:function(a,
e,f,h,m){var d=this.getRealRowEl(!1,{row:a,col:e});f=this.createCells(h,f);d?(m=this.correctColIndexForUnreals(e,a),0<=m?b(this.getRowCells(d)[m],f):d.insertBefore(f,d.firstChild)):(d=this.table.ownerDocument.createElement("tr"),d.appendChild(f),b(g.getParentElement(m.el,{query:"tr"}),d))},canMerge:function(a){this.to=a;this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(this.to);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&
this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);a=this.idx_start.row;for(var d=this.idx_end.row;a<=d;a++)for(var b=this.idx_start.col,e=this.idx_end.col;b<=e;b++)if(this.map[a][b].isColspan||this.map[a][b].isRowspan)return!1;return!0},decreaseCellSpan:function(a,b){var d=parseInt(g.getAttribute(a.el,b),10)-1;1<=d?a.el.setAttribute(b,d):
(a.el.removeAttribute(b),"colspan"==b&&(a.isColspan=!1),"rowspan"==b&&(a.isRowspan=!1),a.firstCol=!0,a.lastCol=!0,a.firstRow=!0,a.lastRow=!0,a.isReal=!0)},removeSurplusLines:function(){var a,b;this.setTableMap();if(this.map){var f=0;for(a=this.map.length;f<a;f++){var h=this.map[f];var m=!0;var p=0;for(b=h.length;p<b;p++){var q=h[p];if(!(g.getAttribute(q.el,"rowspan")&&1<parseInt(g.getAttribute(q.el,"rowspan"),10)&&!0!==q.firstRow)){m=!1;break}}if(m)for(p=0;p<b;p++)this.decreaseCellSpan(h[p],"rowspan")}q=
this.getTableRows();f=0;for(a=q.length;f<a;f++)h=q[f],0==h.childNodes.length&&/^\s*$/.test(h.textContent||h.innerText)&&e(h)}},fillMissingCells:function(){var a=0,e;this.setTableMap();if(this.map){var f=this.map.length;for(e=0;e<f;e++)this.map[e].length>a&&(a=this.map[e].length);for(var g=0;g<f;g++)for(var m=0;m<a;m++)this.map[g]&&!this.map[g][m]&&0<m&&(this.map[g][m]=new h(this.createCells("td",1)),(e=this.map[g][m-1])&&e.el&&e.el.parent&&b(this.map[g][m-1].el,this.map[g][m].el))}},rectify:function(){if(this.removeEmptyTable())return!1;
this.removeSurplusLines();this.fillMissingCells();return!0},unmerge:function(){if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell))){var a=this.map[this.idx.row][this.idx.col],b=g.getAttribute(a.el,"colspan")?parseInt(g.getAttribute(a.el,"colspan"),10):1,e=a.el.tagName.toLowerCase();if(a.isRowspan){var f=parseInt(g.getAttribute(a.el,"rowspan"),10);if(1<f){var h=1;for(--f;h<=f;h++)this.injectRowAt(this.idx.row+h,this.idx.col,b,e,a)}a.el.removeAttribute("rowspan")}this.splitRowToCells(a)}},
merge:function(a){if(this.rectify())if(this.canMerge(a)){a=this.idx_end.row-this.idx_start.row+1;for(var d=this.idx_end.col-this.idx_start.col+1,b=this.idx_start.row,f=this.idx_end.row;b<=f;b++)for(var g=this.idx_start.col,h=this.idx_end.col;g<=h;g++)b==this.idx_start.row&&g==this.idx_start.col?(1<a&&this.map[b][g].el.setAttribute("rowspan",a),1<d&&this.map[b][g].el.setAttribute("colspan",d)):(/^\s*<br\/?>\s*$/.test(this.map[b][g].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=
" "+this.map[b][g].el.innerHTML),e(this.map[b][g].el));this.rectify()}else window.console&&console.log("Do not know how to merge allready merged cells.")},collapseCellToNextRow:function(a){var d=this.getMapIndex(a.el),e=d.row+1,f={row:e,col:d.col};e<this.map.length&&(d=this.getRealRowEl(!1,f),null!==d&&(f=this.correctColIndexForUnreals(f.col,f.row),0<=f?b(this.getRowCells(d)[f],a.el):(e=this.getLastNewCellOnRow(d,e),null!==e?b(e,a.el):d.insertBefore(a.el,d.firstChild)),2<parseInt(g.getAttribute(a.el,
"rowspan"),10)?a.el.setAttribute("rowspan",parseInt(g.getAttribute(a.el,"rowspan"),10)-1):a.el.removeAttribute("rowspan")))},removeRowCell:function(a){a.isReal?a.isRowspan?this.collapseCellToNextRow(a):e(a.el):2<parseInt(g.getAttribute(a.el,"rowspan"),10)?a.el.setAttribute("rowspan",parseInt(g.getAttribute(a.el,"rowspan"),10)-1):a.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var a=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=this.map[this.idx.row],
e=0,f=b.length;e<f;e++)b[e].isReal&&a.push(b[e].el);return a},getColumnElementsByCell:function(){var a=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=0,e=this.map.length;b<e;b++)this.map[b][this.idx.col]&&this.map[b][this.idx.col].isReal&&a.push(this.map[b][this.idx.col].el);return a},removeRow:function(){var a=g.getParentElement(this.cell,{query:"tr"});if(a){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=this.map[this.idx.row],
f=0,h=b.length;f<h;f++)b[f].modified||(this.setCellAsModified(b[f]),this.removeRowCell(b[f]));e(a)}},removeColCell:function(a){a.isColspan?2<parseInt(g.getAttribute(a.el,"colspan"),10)?a.el.setAttribute("colspan",parseInt(g.getAttribute(a.el,"colspan"),10)-1):a.el.removeAttribute("colspan"):a.isReal&&e(a.el)},removeColumn:function(){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var a=0,b=this.map.length;a<b;a++)this.map[a][this.idx.col].modified||(this.setCellAsModified(this.map[a][this.idx.col]),
this.removeColCell(this.map[a][this.idx.col]))},remove:function(a){if(this.rectify()){switch(a){case "row":this.removeRow();break;case "column":this.removeColumn()}this.rectify()}},addRow:function(a){var d=this.table.ownerDocument;this.setTableMap();this.idx=this.getMapIndex(this.cell);"below"==a&&g.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(g.getAttribute(this.cell,"rowspan"),10)-1);if(!1!==this.idx){var e=this.map[this.idx.row];d=d.createElement("tr");for(var f=0,h=e.length;f<
h;f++)e[f].modified||(this.setCellAsModified(e[f]),this.addRowCell(e[f],d,a));switch(a){case "below":b(this.getRealRowEl(!0),d);break;case "above":(a=g.getParentElement(this.map[this.idx.row][this.idx.col].el,{query:"tr"}))&&a.parentNode.insertBefore(d,a)}}},addRowCell:function(a,b,e){var d=a.isColspan?{colspan:g.getAttribute(a.el,"colspan")}:null;a.isReal?"above"!=e&&a.isRowspan?a.el.setAttribute("rowspan",parseInt(g.getAttribute(a.el,"rowspan"),10)+1):b.appendChild(this.createCells("td",1,d)):"above"!=
e&&a.isRowspan&&a.lastRow?b.appendChild(this.createCells("td",1,d)):c.isRowspan&&a.el.attr("rowspan",parseInt(g.getAttribute(a.el,"rowspan"),10)+1)},add:function(a){this.rectify()&&("below"!=a&&"above"!=a||this.addRow(a),"before"!=a&&"after"!=a||this.addColumn(a))},addColCell:function(a,e,f){var d=a.el.tagName.toLowerCase();switch(f){case "before":var k=!a.isColspan||a.firstCol;break;case "after":k=!a.isColspan||a.lastCol||a.isColspan&&a.el==this.cell}if(k){switch(f){case "before":a.el.parentNode.insertBefore(this.createCells(d,
1),a.el);break;case "after":b(a.el,this.createCells(d,1))}a.isRowspan&&this.handleCellAddWithRowspan(a,e+1,f)}else a.el.setAttribute("colspan",parseInt(g.getAttribute(a.el,"colspan"),10)+1)},addColumn:function(a){this.setTableMap();this.idx=this.getMapIndex(this.cell);"after"==a&&g.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(g.getAttribute(this.cell,"colspan"),10)-1);if(!1!==this.idx)for(var b=0,d=this.map.length;b<d;b++){var e=this.map[b];e[this.idx.col]&&(e=e[this.idx.col],
e.modified||(this.setCellAsModified(e),this.addColCell(e,b,a)))}},handleCellAddWithRowspan:function(a,e,f){var d=parseInt(g.getAttribute(this.cell,"rowspan"),10)-1,k=g.getParentElement(a.el,{query:"tr"});a=a.el.tagName.toLowerCase();for(var h,l,x=this.table.ownerDocument,y=0;y<d;y++){h=this.correctColIndexForUnreals(this.idx.col,e+y);a:{for(k=k.nextSibling;1!=k.nodeType;)if(k=k.nextSibling,"tr"==k.tagName.toLowerCase())break a;k=null}if(k)if(0<h)switch(f){case "before":l=this.getRowCells(k);0<h&&
this.map[e+y][this.idx.col].el!=l[h]&&h==l.length-1?b(l[h],this.createCells(a,1)):l[h].parentNode.insertBefore(this.createCells(a,1),l[h]);break;case "after":b(this.getRowCells(k)[h],this.createCells(a,1))}else k.insertBefore(this.createCells(a,1),k.firstChild);else h=x.createElement("tr"),h.appendChild(this.createCells(a,1)),this.table.appendChild(h)}}};g.table={getCellsBetween:function(a,b){return(new f(a)).getMapElsTo(b)},addCells:function(a,b){(new f(a)).add(b)},removeCells:function(a,b){(new f(a)).remove(b)},
mergeCellsBetween:function(a,b){(new f(a)).merge(b)},unmergeCell:function(a){(new f(a)).unmerge()},orderSelectionEnds:function(a,b){return(new f(a)).orderSelectionEnds(b)},indexOf:function(a){var b=new f(a);b.setTableMap();return b.getMapIndex(a)},findCell:function(a,b){return(new f(null,a)).getElementAtIndex(b)},findRowByCell:function(a){return(new f(a)).getRowElementsByCell()},findColumnByCell:function(a){return(new f(a)).getColumnElementsByCell()},canMerge:function(a,b){return(new f(a)).canMerge(b)}}})();
(function(){var a=wysihtml.views.Composer.prototype.observe,e=function(){var a=function(){this.win.removeEventListener("load",a);this.doc.execCommand("enableObjectResizing",!1,"false");this.doc.execCommand("enableInlineTableEditing",!1,"false")}.bind(this),e=function(){a.call(this);this.actions.removeListeners(this.sandbox.getIframe(),["focus","mouseup","mouseover"],e)}.bind(this);this.doc.execCommand&&wysihtml.browser.supportsCommand(this.doc,"enableObjectResizing")&&wysihtml.browser.supportsCommand(this.doc,
"enableInlineTableEditing")&&(this.sandbox.getIframe?this.actions.addListeners(this.sandbox.getIframe(),["focus","mouseup","mouseover"],e):this.win.addEventListener("load",a));this.tableSelection=wysihtml.quirks.tableCellsSelection(this.element,this.parent)};wysihtml.Editor.prototype.defaults.handleTables=!0;wysihtml.quirks.tableCellsSelection=function(a,e){var b=function(){if(a){var b=a.querySelectorAll("."+p);if(0<b.length)for(var d=0;d<b.length;d++)n.removeClass(b[d],p)}},f=function(a){for(var b=
0;b<a.length;b++)n.addClass(a[b],p)},d=function(d){var g;(d=n.getParentElement(d.target,{query:"td, th"},!1,a))&&m.table&&m.start&&(g=n.getParentElement(d,{query:"table"},!1,a))&&g===m.table&&(b(),g=m.end,m.end=d,m.cells=n.table.getCellsBetween(m.start,d),1<m.cells.length&&e.composer.selection.deselect(),f(m.cells),m.end!==g&&e.fire("tableselectchange").fire("tableselectchange:composer"))},g=function(b){a.removeEventListener("mousemove",d);a.removeEventListener("mouseup",g);e.fire("tableselect").fire("tableselect:composer");
setTimeout(function(){a.ownerDocument.addEventListener("click",l)},0)},l=function(d){a.ownerDocument.removeEventListener("click",l);n.getParentElement(d.target,{query:"table"},!1,a)!=m.table&&(b(),m.table=null,m.start=null,m.end=null,e.fire("tableunselect").fire("tableunselect:composer"))},n=wysihtml.dom,m={table:null,start:null,end:null,cells:null,select:function(b,d){m.start=b;m.end=d;m.table=n.getParentElement(m.start,{query:"table"},!1,a);selectedCells=n.table.getCellsBetween(m.start,m.end);f(selectedCells);
a.ownerDocument.addEventListener("click",l);e.fire("tableselect").fire("tableselect:composer")}},p="wysiwyg-tmp-selected-cell";a.addEventListener("mousedown",function(f){if(f=wysihtml.dom.getParentElement(f.target,{query:"td, th"},!1,a))m.start=f,m.end=f,m.cells=[f],m.table=n.getParentElement(m.start,{query:"table"},!1,a),m.table&&(b(),n.addClass(f,p),a.addEventListener("mousemove",d),a.addEventListener("mouseup",g),e.fire("tableselectstart").fire("tableselectstart:composer"))});return m};wysihtml.views.Composer.prototype.observe=
function(){a.call(this);this.config.handleTables&&e.call(this)}})();(function(a){var e=a.dom;a.toolbar.Dialog=a.lang.Dispatcher.extend({constructor:function(a,e){this.link=a;this.container=e},_observe:function(){if(!this._observed){var b=this,g=function(a){var e=b._serialize();b.fire("save",e);b.hide();a.preventDefault();a.stopPropagation()};e.observe(b.link,"click",function(){e.hasClass(b.link,"wysihtml-command-dialog-opened")&&setTimeout(function(){b.hide()},0)});e.observe(this.container,"keydown",function(e){var f=e.keyCode;f===a.ENTER_KEY&&g(e);f===a.ESCAPE_KEY&&
b.cancel()});e.delegate(this.container,"[data-wysihtml-dialog-action=save]","click",g);e.delegate(this.container,"[data-wysihtml-dialog-action=cancel]","click",function(a){b.cancel();a.preventDefault();a.stopPropagation()});this._observed=!0}},_serialize:function(){for(var a={},e=this.container.querySelectorAll("[data-wysihtml-dialog-field]"),h=e.length,f=0;f<h;f++)a[e[f].getAttribute("data-wysihtml-dialog-field")]=e[f].value;return a},_interpolate:function(a){for(var b,e,f=document.querySelector(":focus"),
d=this.container.querySelectorAll("[data-wysihtml-dialog-field]"),k=d.length,l=0;l<k;l++)b=d[l],b===f||a&&"hidden"===b.type||(e=b.getAttribute("data-wysihtml-dialog-field"),e=this.elementToChange&&"boolean"!==typeof this.elementToChange?this.elementToChange.getAttribute(e)||"":b.defaultValue,b.value=e)},update:function(a){this.elementToChange=a?a:this.elementToChange;this._interpolate();this.fire("change")},show:function(a){var b=this.container.querySelector("input, select, textarea");this._observe();
this.update(a);e.addClass(this.link,"wysihtml-command-dialog-opened");this.container.style.display="";this.isOpen=!0;this.fire("show");if(b&&!a)try{b.focus()}catch(h){}},_hide:function(a){this.elementToChange=null;e.removeClass(this.link,"wysihtml-command-dialog-opened");this.container.style.display="none";this.isOpen=!1},hide:function(){this._hide();this.fire("hide")},cancel:function(){this._hide();this.fire("cancel")}})})(wysihtml);
(function(a){a.toolbar.Dialog_bgColorStyle=a.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var a={},b=this.container.querySelectorAll("[data-wysihtml-dialog-field]"),g=b.length,h=0;h<g;h++)a[b[h].getAttribute("data-wysihtml-dialog-field")]=b[h].value;return a},_interpolate:function(e){for(var b,g=document.querySelector(":focus"),h=this.container.querySelectorAll("[data-wysihtml-dialog-field]"),f=h.length,d=0,k=(b=(b=this.elementToChange?a.lang.object(this.elementToChange).isArray()?
this.elementToChange[0]:this.elementToChange:null)?b.getAttribute("style"):null)?a.quirks.styleParser.parseColor(b,"background-color"):null;d<f;d++)b=h[d],b===g||e&&"hidden"===b.type||"color"!==b.getAttribute("data-wysihtml-dialog-field")||(b.value=k?k[3]&&1!=k[3]?"rgba("+k[0]+","+k[1]+","+k[2]+","+k[3]+");":"rgb("+k[0]+","+k[1]+","+k[2]+");":"rgb(0,0,0);")}})})(wysihtml);(function(a){a.toolbar.Dialog_createTable=a.toolbar.Dialog.extend({show:function(a){this.base(a)}})})(wysihtml);
(function(a){a.toolbar.Dialog_fontSizeStyle=a.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml-dialog-field="size"]').value}},_interpolate:function(e){e=document.querySelector(":focus");var b=this.container.querySelector("[data-wysihtml-dialog-field='size']"),g=this.elementToChange?a.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null;g=(g=g?g.getAttribute("style"):null)?a.quirks.styleParser.parseFontSize(g):
null;b&&b!==e&&g&&!/^\s*$/.test(g)&&(b.value=g)}})})(wysihtml);
(function(a){a.toolbar.Dialog_foreColorStyle=a.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var a={},b=this.container.querySelectorAll("[data-wysihtml-dialog-field]"),g=b.length,h=0;h<g;h++)a[b[h].getAttribute("data-wysihtml-dialog-field")]=b[h].value;return a},_interpolate:function(e){for(var b,g,h=a.quirks.styleParser,f=document.querySelector(":focus"),d=this.container.querySelectorAll("[data-wysihtml-dialog-field]"),k=d.length,l=0,n=(b=(b=this.elementToChange?a.lang.object(this.elementToChange).isArray()?
this.elementToChange[0]:this.elementToChange:null)?b.getAttribute("style"):null)?h.parseColor(b,"color"):null;l<k;l++)b=d[l],b===f||e&&"hidden"===b.type||"color"!==b.getAttribute("data-wysihtml-dialog-field")||(g=(b.dataset.colormode||"rgb").toLowerCase(),g="hex"===g?"hash":g,b.value=n?h.unparseColor(n,g):h.unparseColor([0,0,0],g))}})})(wysihtml);
(function(a){var e=a.dom,b={position:"relative"},g={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},h={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},f={"x-webkit-speech":"",speech:""};a.toolbar.Speech=function(d,k){var l=document.createElement("input");if(a.browser.supportsSpeechApiOn(l)){var n=d.editor.textarea.element.getAttribute("lang");n&&(f.lang=n);n=document.createElement("div");
a.lang.object(g).merge({width:k.offsetWidth+"px",height:k.offsetHeight+"px"});e.insert(l).into(n);e.insert(n).into(k);e.setStyles(h).on(l);e.setAttributes(f).on(l);e.setStyles(g).on(n);e.setStyles(b).on(k);e.observe(l,"onwebkitspeechchange"in l?"webkitspeechchange":"speechchange",function(){d.execCommand("insertText",l.value);l.value=""});e.observe(l,"click",function(a){e.hasClass(k,"wysihtml-command-disabled")&&a.preventDefault();a.stopPropagation()})}else k.style.display="none"}})(wysihtml);
(function(a){function e(b,d){b=b.commands.state(d.name,d.value);!d.dialog.multiselect&&a.lang.object(b).isArray()&&(b=1===b.length?b[0]:!0);return b}var b="wysihtml-command-disabled",g="wysihtml-commands-disabled",h="wysihtml-command-active",f="wysihtml-action-active",d=a.dom;a.toolbar.Toolbar=Base.extend({constructor:function(d,e,n){this.editor=d;this.container="string"===typeof e?document.getElementById(e):e;this.composer=d.composer;this._getLinks("command");this._getLinks("action");this._observe();
n&&this.show();null!=d.config.classNameCommandDisabled&&(b=d.config.classNameCommandDisabled);null!=d.config.classNameCommandsDisabled&&(g=d.config.classNameCommandsDisabled);null!=d.config.classNameCommandActive&&(h=d.config.classNameCommandActive);null!=d.config.classNameActionActive&&(f=d.config.classNameActionActive);d=this.container.querySelectorAll("[data-wysihtml-command=insertSpeech]");e=d.length;for(n=0;n<e;n++)new a.toolbar.Speech(this,d[n])},_getLinks:function(b){for(var d=this[b+"Links"]=
a.lang.array(this.container.querySelectorAll("[data-wysihtml-"+b+"]")).get(),e=d.length,f=0,g=this[b+"Mapping"]={},h,k,y,w,B,C;f<e;f++)h=d[f],y=h.getAttribute("data-wysihtml-"+b),w=h.getAttribute("data-wysihtml-"+b+"-value"),C=h.getAttribute("data-wysihtml-"+b+"-blank-value"),k=this.container.querySelector("[data-wysihtml-"+b+"-group='"+y+"']"),B=this._getDialog(h,y),g[y+":"+w]={link:h,group:k,name:y,value:w,tracksBlankValue:C,dialog:B,state:!1}},_getDialog:function(b,d){var e=this,f=this.container.querySelector("[data-wysihtml-dialog='"+
d+"']"),g;if(f){var h=a.toolbar["Dialog_"+d]?new a.toolbar["Dialog_"+d](b,f):new a.toolbar.Dialog(b,f);h.on("show",function(){g=e.composer.selection.getBookmark();e.editor.fire("show:dialog",{command:d,dialogContainer:f,commandLink:b})});h.on("change",function(){g=e.composer.selection.getBookmark();e.editor.fire("change:dialog",{command:d,dialogContainer:f,commandLink:b})});h.on("save",function(a){g&&e.composer.selection.setBookmark(g);e._execCommand(d,a);e.editor.fire("save:dialog",{command:d,dialogContainer:f,
commandLink:b});e._hideAllDialogs();e._preventInstantFocus();g=void 0});h.on("cancel",function(){g&&e.composer.selection.setBookmark(g);e.editor.fire("cancel:dialog",{command:d,dialogContainer:f,commandLink:b});g=void 0;e._preventInstantFocus()});h.on("hide",function(){e.editor.fire("hide:dialog",{command:d,dialogContainer:f,commandLink:b});g=void 0})}return h},execCommand:function(a,b){this.commandsDisabled||this._execCommand(a,b)},_execCommand:function(a,b){this.editor.focus(!1);this.composer.commands.exec(a,
b);this._updateLinkStates()},execAction:function(a){var b=this.editor;"change_view"===a&&(b.currentView===b.textarea||"source"===b.currentView?b.fire("change_view","composer"):b.fire("change_view","textarea"));"showSource"==a&&b.fire("showSource")},_observe:function(){for(var b=this,f=this.editor,h=this.container,m=this.commandLinks.concat(this.actionLinks),p=m.length,q=0;q<p;q++)if("A"===m[q].nodeName)d.setAttributes({href:"javascript:;",unselectable:"on"}).on(m[q]);else d.setAttributes({unselectable:"on"}).on(m[q]);
d.delegate(h,"[data-wysihtml-command], [data-wysihtml-action]","mousedown",function(a){a.preventDefault()});d.delegate(h,"[data-wysihtml-command]","click",function(a){var d=this.getAttribute("data-wysihtml-command");var f=this.getAttribute("data-wysihtml-command-value"),g=b.commandMapping[d+":"+f];f||!g.dialog?b.execCommand(d,f):(d=e(b.composer,g),g.dialog.show(d));a.preventDefault()});d.delegate(h,"[data-wysihtml-action]","click",function(a){var d=this.getAttribute("data-wysihtml-action");b.execAction(d);
a.preventDefault()});f.on("interaction:composer",function(a){b.preventFocus||b._updateLinkStates()});this._ownerDocumentClick=function(d){a.dom.contains(b.container,d.target)||a.dom.contains(b.composer.element,d.target)||(b._updateLinkStates(),b._preventInstantFocus())};this.container.ownerDocument.addEventListener("click",this._ownerDocumentClick,!1);this.editor.on("destroy:composer",this.destroy.bind(this));this.editor.config.handleTables&&(f.on("tableselect:composer",function(){b.container.querySelectorAll('[data-wysihtml-hiddentools="table"]')[0].style.display=
""}),f.on("tableunselect:composer",function(){b.container.querySelectorAll('[data-wysihtml-hiddentools="table"]')[0].style.display="none"}));f.on("change_view",function(a){setTimeout(function(){b.commandsDisabled="composer"!==a;b._updateLinkStates();b.commandsDisabled?d.addClass(h,g):d.removeClass(h,g)},0)})},destroy:function(){this.container.ownerDocument.removeEventListener("click",this._ownerDocumentClick,!1)},_hideAllDialogs:function(){var a=this.commandMapping,b;for(b in a)a[b].dialog&&a[b].dialog.hide()},
_preventInstantFocus:function(){this.preventFocus=!0;setTimeout(function(){this.preventFocus=!1}.bind(this),0)},_updateLinkStates:function(){var a,g=this.commandMapping,n=this.composer,m=this.actionMapping;for(a in g){var p=g[a];if(this.commandsDisabled){var q=!1;d.removeClass(p.link,h);p.group&&d.removeClass(p.group,h);p.dialog&&p.dialog.hide()}else q=this.composer.commands.state(p.name,p.value),d.removeClass(p.link,b),p.group&&d.removeClass(p.group,b);if(p.state!==q||p.tracksBlankValue)if(p.state=
q)if(p.tracksBlankValue)d.removeClass(p.link,h);else{if(d.addClass(p.link,h),p.group&&d.addClass(p.group,h),p.dialog&&("undefined"===typeof p.value||null===p.value))if(q&&"object"===typeof q){q=e(n,p);p.state=q;var x=p.dialog.container.dataset?p.dialog.container.dataset.showdialogonselection:!1;n.config.showToolbarDialogsOnSelection||x?p.dialog.show(q):p.dialog.update(q)}else p.dialog.hide()}else p.tracksBlankValue?d.addClass(p.link,h):(d.removeClass(p.link,h),p.group&&d.removeClass(p.group,h),p.dialog&&
!p.value&&p.dialog.hide())}for(a in m)q=m[a],"change_view"===q.name&&(q.state=this.editor.currentView===this.editor.textarea||"source"===this.editor.currentView,q.state?d.addClass(q.link,f):d.removeClass(q.link,f))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}});a.Editor.prototype.defaults.toolbar=void 0;a.Editor.prototype.defaults.showToolbarAfterInit=!0;a.Editor.prototype.defaults.showToolbarDialogsOnSelection=!0;a.extendEditor(function(b){b.config.toolbar&&
(b.toolbar=new a.toolbar.Toolbar(b,b.config.toolbar,b.config.showToolbarAfterInit),b.on("destroy:composer",function(){b&&b.toolbar&&b.toolbar.destroy()}))})})(wysihtml);var wysihtmlParserRulesDefaults={blockLevelEl:{keep_styles:{textAlign:/^((left)|(right)|(center)|(justify))$/i,"float":1,marginLeft:1},add_style:{align:"align_text"},check_attributes:{id:"any"}},makeDiv:{rename_tag:"div",one_of_type:{alignment_object:1},remove_action:"unwrap",keep_styles:{textAlign:1,"float":1},add_style:{align:"align_text"},check_attributes:{id:"any"}}},wysihtmlParserRules={classes:"any",classes_blacklist:{"Apple-interchange-newline":1,MsoNormal:1,MsoPlainText:1},type_definitions:{alignment_object:{classes:{"wysiwyg-text-align-center":1,
"wysiwyg-text-align-justify":1,"wysiwyg-text-align-left":1,"wysiwyg-text-align-right":1,"wysiwyg-float-left":1,"wysiwyg-float-right":1},styles:{"float":["left","right"],"text-align":["left","right","center"]}},valid_image_src:{attrs:{src:/^(https?|data):/i}},text_color_object:{classes:{"wysiwyg-color-indianred":1,"wysiwyg-color-lightcoral":1,"wysiwyg-color-salmon":1,"wysiwyg-color-darksalmon":1,"wysiwyg-color-lightsalmon":1,"wysiwyg-color-crimson":1,"wysiwyg-color-red":1,"wysiwyg-color-fireBrick":1,
"wysiwyg-color-darkred":1,"wysiwyg-color-pink":1,"wysiwyg-color-lightpink":1,"wysiwyg-color-hotpink":1,"wysiwyg-color-deeppink":1,"wysiwyg-color-mediumvioletred":1,"wysiwyg-color-palevioletred":1,"wysiwyg-color-coral":1,"wysiwyg-color-tomato":1,"wysiwyg-color-orangered":1,"wysiwyg-color-darkorange":1,"wysiwyg-color-orange":1,"wysiwyg-color-gold":1,"wysiwyg-color-yellow":1,"wysiwyg-color-lightyellow":1,"wysiwyg-color-lemonchiffon":1,"wysiwyg-color-lightgoldenrodyellow":1,"wysiwyg-color-papayawhip":1,
"wysiwyg-color-moccasin":1,"wysiwyg-color-peachpuff":1,"wysiwyg-color-palegoldenrod":1,"wysiwyg-color-khaki":1,"wysiwyg-color-darkkhaki":1,"wysiwyg-color-lavender":1,"wysiwyg-color-thistle":1,"wysiwyg-color-plum":1,"wysiwyg-color-violet":1,"wysiwyg-color-orchid":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-mediumorchid":1,"wysiwyg-color-mediumpurple":1,"wysiwyg-color-amethyst":1,"wysiwyg-color-rebeccapurple":1,"wysiwyg-color-blueviolet":1,"wysiwyg-color-darkviolet":1,"wysiwyg-color-darkorchid":1,"wysiwyg-color-darkmagenta":1,
"wysiwyg-color-purple":1,"wysiwyg-color-indigo":1,"wysiwyg-color-slateblue":1,"wysiwyg-color-darkslateblue":1,"wysiwyg-color-mediumslateblue":1,"wysiwyg-color-greenyellow":1,"wysiwyg-color-chartreuse":1,"wysiwyg-color-lawngreen":1,"wysiwyg-color-lime":1,"wysiwyg-color-limegreen":1,"wysiwyg-color-palegreen":1,"wysiwyg-color-lightgreen":1,"wysiwyg-color-mediumspringgreen":1,"wysiwyg-color-springgreen":1,"wysiwyg-color-mediumseagreen":1,"wysiwyg-color-seagreen":1,"wysiwyg-color-forestgreen":1,"wysiwyg-color-green":1,
"wysiwyg-color-darkgreen":1,"wysiwyg-color-yellowgreen":1,"wysiwyg-color-olivedrab":1,"wysiwyg-color-olive":1,"wysiwyg-color-darkolivegreen":1,"wysiwyg-color-mediumaquamarine":1,"wysiwyg-color-darkseagreen":1,"wysiwyg-color-lightseagreen":1,"wysiwyg-color-darkcyan":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-lightcyan":1,"wysiwyg-color-paleturquoise":1,"wysiwyg-color-aquamarine":1,"wysiwyg-color-turquoise":1,"wysiwyg-color-mediumturquoise":1,"wysiwyg-color-darkturquoise":1,"wysiwyg-color-cadetblue":1,
"wysiwyg-color-steelblue":1,"wysiwyg-color-lightsteelblue":1,"wysiwyg-color-powderblue":1,"wysiwyg-color-lightblue":1,"wysiwyg-color-skyblue":1,"wysiwyg-color-lightskyblue":1,"wysiwyg-color-deepskyblue":1,"wysiwyg-color-dodgerblue":1,"wysiwyg-color-cornflowerblue":1,"wysiwyg-color-royalblue":1,"wysiwyg-color-blue":1,"wysiwyg-color-mediumblue":1,"wysiwyg-color-darkblue":1,"wysiwyg-color-navy":1,"wysiwyg-color-midnightblue":1,"wysiwyg-color-cornsilk":1,"wysiwyg-color-blanchedalmond":1,"wysiwyg-color-bisque":1,
"wysiwyg-color-navajowhite":1,"wysiwyg-color-wheat":1,"wysiwyg-color-burlywood":1,"wysiwyg-color-tan":1,"wysiwyg-color-rosybrown":1,"wysiwyg-color-sandybrown":1,"wysiwyg-color-goldenrod":1,"wysiwyg-color-darkgoldenrod":1,"wysiwyg-color-Peru":1,"wysiwyg-color-chocolate":1,"wysiwyg-color-saddlebrown":1,"wysiwyg-color-sienna":1,"wysiwyg-color-brown":1,"wysiwyg-color-maroon":1,"wysiwyg-color-white":1,"wysiwyg-color-snow":1,"wysiwyg-color-honeydew":1,"wysiwyg-color-mintcream":1,"wysiwyg-color-azure":1,
"wysiwyg-color-aliceblue":1,"wysiwyg-color-ghostwhite":1,"wysiwyg-color-whitesmoke":1,"wysiwyg-color-seashell":1,"wysiwyg-color-beige":1,"wysiwyg-color-oldlace":1,"wysiwyg-color-floralwhite":1,"wysiwyg-color-ivory":1,"wysiwyg-color-antiquewhite":1,"wysiwyg-color-linen":1,"wysiwyg-color-lavenderblush":1,"wysiwyg-color-mistyrose":1,"wysiwyg-color-gainsboro":1,"wysiwyg-color-lightgrey":1,"wysiwyg-color-silver":1,"wysiwyg-color-darkgray":1,"wysiwyg-color-gray":1,"wysiwyg-color-dimgray":1,"wysiwyg-color-lightslategray":1,
"wysiwyg-color-slategray":1,"wysiwyg-color-darkslategray":1,"wysiwyg-color-black":1},styles:{color:!0}},text_fontsize_object:{classes:{"wysiwyg-font-size-large":1,"wysiwyg-font-size-larger":1,"wysiwyg-font-size-medium":1,"wysiwyg-font-size-small":1,"wysiwyg-font-size-smaller":1,"wysiwyg-font-size-x-large":1,"wysiwyg-font-size-x-small":1,"wysiwyg-font-size-xx-large":1,"wysiwyg-font-size-xx-small":1},styles:{"font-size":!0}},text_fontname_object:{classes:{"wysiwig-font-name-couriernew":1,"wysiwig-font-name-arial":1,
"wysiwig-font-name-bookman":1,"wysiwig-font-name-comicsansms":1,"wysiwig-font-name-garamond":1,"wysiwig-font-name-georgia":1,"wysiwig-font-name-helvetica":1,"wysiwig-font-name-impact":1,"wysiwig-font-name-palatino":1,"wysiwig-font-name-timesnewroman":1,"wysiwig-font-name-trebuchetms":1,"wysiwig-font-name-verdana":1},styles:{"font-family":!0}},text_hilite_object:{classes:{"wysiwyg-hilite-color-indianred":1,"wysiwyg-hilite-color-lightcoral":1,"wysiwyg-hilite-color-salmon":1,"wysiwyg-hilite-color-darksalmon":1,
"wysiwyg-hilite-color-lightsalmon":1,"wysiwyg-hilite-color-crimson":1,"wysiwyg-hilite-color-red":1,"wysiwyg-hilite-color-firebrick":1,"wysiwyg-hilite-color-darkred":1,"wysiwyg-hilite-color-pink":1,"wysiwyg-hilite-color-lightpink":1,"wysiwyg-hilite-color-hotpink":1,"wysiwyg-hilite-color-deeppink":1,"wysiwyg-hilite-color-mediumvioletred":1,"wysiwyg-hilite-color-palevioletred":1,"wysiwyg-hilite-color-coral":1,"wysiwyg-hilite-color-tomato":1,"wysiwyg-hilite-color-orangered":1,"wysiwyg-hilite-color-darkorange":1,
"wysiwyg-hilite-color-orange":1,"wysiwyg-hilite-color-gold":1,"wysiwyg-hilite-color-yellow":1,"wysiwyg-hilite-color-lightyellow":1,"wysiwyg-hilite-color-lemonchiffon":1,"wysiwyg-hilite-color-lightgoldenrodyellow":1,"wysiwyg-hilite-color-papayawhip":1,"wysiwyg-hilite-color-moccasin":1,"wysiwyg-hilite-color-peachpuff":1,"wysiwyg-hilite-color-palegoldenrod":1,"wysiwyg-hilite-color-khaki":1,"wysiwyg-hilite-color-darkkhaki":1,"wysiwyg-hilite-color-lavender":1,"wysiwyg-hilite-color-thistle":1,"wysiwyg-hilite-color-plum":1,
"wysiwyg-hilite-color-violet":1,"wysiwyg-hilite-color-orchid":1,"wysiwyg-hilite-color-fuchsia":1,"wysiwyg-hilite-color-mediumorchid":1,"wysiwyg-hilite-color-mediumpurple":1,"wysiwyg-hilite-color-amethyst":1,"wysiwyg-hilite-color-rebeccapurple":1,"wysiwyg-hilite-color-blueviolet":1,"wysiwyg-hilite-color-darkviolet":1,"wysiwyg-hilite-color-darkorchid":1,"wysiwyg-hilite-color-darkmagenta":1,"wysiwyg-hilite-color-purple":1,"wysiwyg-hilite-color-indigo":1,"wysiwyg-hilite-color-slateblue":1,"wysiwyg-hilite-color-darkslateblue":1,
"wysiwyg-hilite-color-mediumslateblue":1,"wysiwyg-hilite-color-greenyellow":1,"wysiwyg-hilite-color-chartreuse":1,"wysiwyg-hilite-color-lawngreen":1,"wysiwyg-hilite-color-lime":1,"wysiwyg-hilite-color-limegreen":1,"wysiwyg-hilite-color-palegreen":1,"wysiwyg-hilite-color-lightgreen":1,"wysiwyg-hilite-color-mediumspringgreen":1,"wysiwyg-hilite-color-springgreen":1,"wysiwyg-hilite-color-mediumseagreen":1,"wysiwyg-hilite-color-seagreen":1,"wysiwyg-hilite-color-forestgreen":1,"wysiwyg-hilite-color-green":1,
"wysiwyg-hilite-color-darkgreen":1,"wysiwyg-hilite-color-yellowgreen":1,"wysiwyg-hilite-color-olivedrab":1,"wysiwyg-hilite-color-olive":1,"wysiwyg-hilite-color-darkolivegreen":1,"wysiwyg-hilite-color-mediumaquamarine":1,"wysiwyg-hilite-color-darkseagreen":1,"wysiwyg-hilite-color-lightseagreen":1,"wysiwyg-hilite-color-darkcyan":1,"wysiwyg-hilite-color-teal":1,"wysiwyg-hilite-color-aqua":1,"wysiwyg-hilite-color-lightcyan":1,"wysiwyg-hilite-color-paleturquoise":1,"wysiwyg-hilite-color-aquamarine":1,
"wysiwyg-hilite-color-turquoise":1,"wysiwyg-hilite-color-mediumturquoise":1,"wysiwyg-hilite-color-darkturquoise":1,"wysiwyg-hilite-color-cadetblue":1,"wysiwyg-hilite-color-steelblue":1,"wysiwyg-hilite-color-lightsteelblue":1,"wysiwyg-hilite-color-powderblue":1,"wysiwyg-hilite-color-lightblue":1,"wysiwyg-hilite-color-skyblue":1,"wysiwyg-hilite-color-lightskyblue":1,"wysiwyg-hilite-color-deepskyblue":1,"wysiwyg-hilite-color-dodgerblue":1,"wysiwyg-hilite-color-cornflowerblue":1,"wysiwyg-hilite-color-royalblue":1,
"wysiwyg-hilite-color-blue":1,"wysiwyg-hilite-color-mediumblue":1,"wysiwyg-hilite-color-darkblue":1,"wysiwyg-hilite-color-navy":1,"wysiwyg-hilite-color-midnightblue":1,"wysiwyg-hilite-color-cornsilk":1,"wysiwyg-hilite-color-blanchedalmond":1,"wysiwyg-hilite-color-bisque":1,"wysiwyg-hilite-color-navajowhite":1,"wysiwyg-hilite-color-wheat":1,"wysiwyg-hilite-color-burlywood":1,"wysiwyg-hilite-color-tan":1,"wysiwyg-hilite-color-rosybrown":1,"wysiwyg-hilite-color-sandybrown":1,"wysiwyg-hilite-color-goldenrod":1,
"wysiwyg-hilite-color-darkgoldenrod":1,"wysiwyg-hilite-color-peru":1,"wysiwyg-hilite-color-chocolate":1,"wysiwyg-hilite-color-saddlebrown":1,"wysiwyg-hilite-color-sienna":1,"wysiwyg-hilite-color-brown":1,"wysiwyg-hilite-color-maroon":1,"wysiwyg-hilite-color-white":1,"wysiwyg-hilite-color-snow":1,"wysiwyg-hilite-color-honeydew":1,"wysiwyg-hilite-color-mintcream":1,"wysiwyg-hilite-color-azure":1,"wysiwyg-hilite-color-aliceblue":1,"wysiwyg-hilite-color-ghostwhite":1,"wysiwyg-hilite-color-whitesmoke":1,
"wysiwyg-hilite-color-seashell":1,"wysiwyg-hilite-color-beige":1,"wysiwyg-hilite-color-oldlace":1,"wysiwyg-hilite-color-floralwhite":1,"wysiwyg-hilite-color-ivory":1,"wysiwyg-hilite-color-antiquewhite":1,"wysiwyg-hilite-color-linen":1,"wysiwyg-hilite-color-lavenderblush":1,"wysiwyg-hilite-color-mistyrose":1,"wysiwyg-hilite-color-gainsboro":1,"wysiwyg-hilite-color-lightgrey":1,"wysiwyg-hilite-color-silver":1,"wysiwyg-hilite-color-darkgray":1,"wysiwyg-hilite-color-gray":1,"wysiwyg-hilite-color-dimgray":1,
"wysiwyg-hilite-color-lightslategray":1,"wysiwyg-hilite-color-slategray":1,"wysiwyg-hilite-color-darkslategray":1,"wysiwyg-hilite-color-black":1},styles:{"background-color":!0}},text_formatting_object:{classes:{}}},comments:1,tags:{tr:{add_style:{align:"align_text"},check_attributes:{id:"any"}},strike:{unwrap:1},form:{unwrap:1},rt:{rename_tag:"span"},code:{},acronym:{rename_tag:"span"},br:{add_class:{clear:"clear_br"}},details:{unwrap:1},h4:wysihtmlParserRulesDefaults.blockLevelEl,em:{},title:{remove:1},
multicol:{unwrap:1},figure:{unwrap:1},xmp:{unwrap:1},small:{rename_tag:"span",set_class:"wysiwyg-font-size-smaller"},area:{remove:1},time:{unwrap:1},dir:{rename_tag:"ul"},bdi:{unwrap:1},command:{unwrap:1},ul:{check_attributes:{id:"any"}},progress:{rename_tag:"span"},dfn:{unwrap:1},iframe:{check_attributes:{src:"any",width:"any",height:"any",frameborder:"any",style:"any",id:"any"}},figcaption:{unwrap:1},a:{check_attributes:{href:"href",rel:"any",target:"any",title:"any",id:"any"}},img:{one_of_type:{valid_image_src:1},
check_attributes:{width:"dimension",alt:"alt",src:"any",height:"dimension","data-local":"any",id:"any"},add_class:{align:"align_img"}},rb:{unwrap:1},footer:wysihtmlParserRulesDefaults.makeDiv,noframes:{remove:1},abbr:{unwrap:1},u:{},bgsound:{remove:1},sup:{},address:{unwrap:1},basefont:{remove:1},nav:{unwrap:1},h1:wysihtmlParserRulesDefaults.blockLevelEl,head:{unwrap:1},tbody:wysihtmlParserRulesDefaults.blockLevelEl,dd:{unwrap:1},s:{unwrap:1},li:{},td:{check_attributes:{rowspan:"numbers",colspan:"numbers",
valign:"any",align:"any",id:"any","class":"any"},keep_styles:{backgroundColor:1,width:1,height:1},add_style:{align:"align_text"}},object:{remove:1},div:{rename_tag:"p",one_of_type:{alignment_object:1},remove_action:"unwrap",keep_styles:{textAlign:1,"float":1},add_style:{align:"align_text"},check_attributes:{id:"any",contenteditable:"any"}},option:{remove:1},select:{remove:1},i:{rename_tag:"em"},track:{remove:1},wbr:{remove:1},fieldset:{unwrap:1},big:{rename_tag:"span",set_class:"wysiwyg-font-size-larger"},
button:{unwrap:1},noscript:{remove:1},svg:{remove:1},input:{remove:1},table:{keep_styles:{width:1,textAlign:1,marginLeft:1,marginRight:1,"float":1},check_attributes:{id:"any"}},keygen:{remove:1},h5:wysihtmlParserRulesDefaults.blockLevelEl,meta:{remove:1},map:{remove:1},isindex:{remove:1},mark:{unwrap:1},caption:wysihtmlParserRulesDefaults.blockLevelEl,tfoot:wysihtmlParserRulesDefaults.blockLevelEl,base:{remove:1},video:{remove:1},strong:{},canvas:{remove:1},output:{unwrap:1},marquee:{unwrap:1},b:{rename_tag:"strong"},
q:{check_attributes:{cite:"url",id:"any"}},applet:{remove:1},span:{one_of_type:{text_formatting_object:1,text_color_object:1,text_hilite_object:1,text_fontname_object:1,text_fontsize_object:1},keep_styles:{color:1,backgroundColor:1,fontFamily:1,fontSize:1},remove_action:"unwrap",check_attributes:{id:"any"}},rp:{unwrap:1},spacer:{remove:1},source:{remove:1},aside:wysihtmlParserRulesDefaults.makeDiv,frame:{remove:1},section:wysihtmlParserRulesDefaults.makeDiv,body:{unwrap:1},ol:{},nobr:{unwrap:1},html:{unwrap:1},
summary:{unwrap:1},"var":{unwrap:1},del:{unwrap:1},blockquote:{keep_styles:{textAlign:1,"float":1},add_style:{align:"align_text"},check_attributes:{cite:"url",id:"any"}},style:{check_attributes:{type:"any",src:"any",charset:"any"}},device:{remove:1},meter:{unwrap:1},h3:wysihtmlParserRulesDefaults.blockLevelEl,textarea:{unwrap:1},embed:{remove:1},hgroup:{unwrap:1},font:{rename_tag:"span",add_class:{size:"size_font"}},tt:{unwrap:1},noembed:{remove:1},thead:{add_style:{align:"align_text"},check_attributes:{id:"any"}},
blink:{unwrap:1},plaintext:{unwrap:1},xml:{remove:1},h6:wysihtmlParserRulesDefaults.blockLevelEl,param:{remove:1},th:{check_attributes:{rowspan:"numbers",colspan:"numbers",valign:"any",align:"any",id:"any"},keep_styles:{backgroundColor:1,width:1,height:1},add_style:{align:"align_text"}},legend:{unwrap:1},hr:{},label:{unwrap:1},dl:{unwrap:1},kbd:{unwrap:1},listing:{unwrap:1},dt:{unwrap:1},nextid:{remove:1},pre:{},center:wysihtmlParserRulesDefaults.makeDiv,audio:{remove:1},datalist:{unwrap:1},samp:{unwrap:1},
col:{remove:1},article:wysihtmlParserRulesDefaults.makeDiv,cite:{},link:{remove:1},script:{remove:1},bdo:{unwrap:1},menu:{rename_tag:"ul"},colgroup:{remove:1},ruby:{unwrap:1},h2:wysihtmlParserRulesDefaults.blockLevelEl,ins:{unwrap:1},p:wysihtmlParserRulesDefaults.blockLevelEl,sub:{},comment:{remove:1},frameset:{remove:1},optgroup:{unwrap:1},header:wysihtmlParserRulesDefaults.makeDiv}};
(function(){var a=wysihtml.lang.object(wysihtmlParserRules).clone(!0);a.comments=!1;a.selectors={"a u":"unwrap"};a.tags.style={remove:1};a.tags.script={remove:1};a.tags.head={remove:1};var e=wysihtml.lang.object(a).clone(!0);e.tags.div.one_of_type.alignment_object=1;e.tags.div.remove_action="unwrap";e.tags.div.check_attributes.style=!1;e.tags.div.keep_styles={textAlign:/^((left)|(right)|(center)|(justify))$/i,"float":1};e.tags.span.keep_styles=!1;var b=wysihtml.lang.object(e).clone(!0);b.classes=
{};window.wysihtmlParserPasteRulesets=[{condition:/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument|class="OutlineElement|id="?docs\-internal\-guid\-/i,set:b},{condition:/<meta name="copied-from" content="wysihtml">/i,set:a},{set:e}]})();(function(a){function e(a){this.base="undefined"==typeof a?!1:a}var b=[["indianred","Indian Red","#CD5C5C",!1],["lightcoral","Light Coral","#F08080",!1],["salmon","Salmon","#FA8072",!1],["darksalmon","Dark Salmon","#E9967A",!1],["lightsalmon","Light Salmon","#FFA07A",!1],["crimson","Crimson","#DC143C",!1],["red","Red","#FF0000",!0],["fireBrick","Fire Brick","#B22222",!1],["darkred","Dark Red","#8B0000",!1],["pink","Pink","#FFC0CB",!1],["lightpink","Light Pink","#FFB6C1",!1],["hotpink","Hot Pink",
"#FF69B4",!1],["deeppink","Deep Pink","#FF1493",!1],["mediumvioletred","Medium Violet Red","#C71585",!1],["palevioletred","Pale Violet Red","#DB7093",!1],["coral","Coral","#FF7F50",!1],["tomato","Tomato","#FF6347",!1],["orangered","Orange Red","#FF4500",!1],["darkorange","Dark Orange","#FF8C00",!1],["orange","Orange","#FFA500",!1],["gold","Gold","#FFD700",!1],["yellow","Yellow","#FFFF00",!0],["lightyellow","Light Yellow","#FFFFE0",!1],["lemonchiffon","Lemon Chiffon","#FFFACD",!1],["lightgoldenrodyellow",
"Light Goldenrod Yellow","#FAFAD2",!1],["papayawhip","Papaya Whip","#FFEFD5",!1],["moccasin","Moccasin","#FFE4B5",!1],["peachpuff","Peach Puff","#FFDAB9",!1],["palegoldenrod","Pale Goldenrod","#EEE8AA",!1],["khaki","Khaki","#F0E68C",!1],["darkkhaki","Dark Khaki","#BDB76B",!1],["lavender","Lavender","#E6E6FA",!1],["thistle","Thistle","#D8BFD8",!1],["plum","Plum","#DDA0DD",!1],["violet","Violet","#EE82EE",!1],["orchid","Orchid","#DA70D6",!1],["fuchsia","Fuchsia","#FF00FF",!0],["mediumorchid","Medium Orchid",
"#BA55D3",!1],["mediumpurple","Medium Purple","#9370DB",!1],["amethyst","Amethyst","#9966CC",!1],["rebeccapurple","Rebecca Purple","#663399",!1],["blueviolet","Blue Violet","#8A2BE2",!1],["darkviolet","Dark Violet","#9400D3",!1],["darkorchid","Dark Orchid","#9932CC",!1],["darkmagenta","Dark Magenta","#8B008B",!1],["purple","Purple","#800080",!0],["indigo","Indigo","#4B0082",!1],["slateblue","SlateBlue","#6A5ACD",!1],["darkslateblue","Dark Slate Blue","#483D8B",!1],["mediumslateblue","Medium Slate Blue",
"#7B68EE",!1],["greenyellow","Green Yellow","#ADFF2F",!1],["chartreuse","Chartreuse","#7FFF00",!1],["lawngreen","Lawn Green","#7CFC00",!1],["lime","Lime","#00FF00",!0],["limegreen","Lime Green","#32CD32",!1],["palegreen","Pale Green","#98FB98",!1],["lightgreen","Light Green","#90EE90",!1],["mediumspringgreen","Medium Spring Green","#00FA9A",!1],["springgreen","Spring Green","#00FF7F",!1],["mediumseagreen","Medium Sea Green","#3CB371",!1],["seagreen","Sea Green","#2E8B57",!1],["forestgreen","Forest Green",
"#228B22",!1],["green","Green","#008000",!0],["darkgreen","Dark Green","#006400",!1],["yellowgreen","Yellow Green","#9ACD32",!1],["olivedrab","Olive Drab","#6B8E23",!1],["olive","Olive","#808000",!0],["darkolivegreen","Dark Olive Green","#556B2F",!1],["mediumaquamarine","Medium Aquamarine","#66CDAA",!1],["darkseagreen","Dark Sea Green","#8FBC8F",!1],["lightseagreen","Light Sea Green","#20B2AA",!1],["darkcyan","Dark Cyan","#008B8B",!1],["teal","Teal","#008080",!0],["aqua","Aqua","#00FFFF",!0],["lightcyan",
"Light Cyan","#E0FFFF",!1],["paleturquoise","Pale Turquoise","#AFEEEE",!1],["aquamarine","Aquamarine","#7FFFD4",!1],["turquoise","Turquoise","#40E0D0",!1],["mediumturquoise","Medium Turquoise","#48D1CC",!1],["darkturquoise","Dark Turquoise","#00CED1",!1],["cadetblue","Cadet Blue","#5F9EA0",!1],["steelblue","Steel Blue","#4682B4",!1],["lightsteelblue","Light Steel Blue","#B0C4DE",!1],["powderblue","Powder Blue","#B0E0E6",!1],["lightblue","Light Blue","#ADD8E6",!1],["skyblue","Sky Blue","#87CEEB",!1],
["lightskyblue","Light Sky Blue","#87CEFA",!1],["deepskyblue","Deep Sky Blue","#00BFFF",!1],["dodgerblue","Dodger Blue","#1E90FF",!1],["cornflowerblue","Cornflower Blue","#6495ED",!1],["royalblue","Royal Blue","#4169E1",!1],["blue","Blue","#0000FF",!0],["mediumblue","Medium Blue","#0000CD",!1],["darkblue","Dark Blue","#00008B",!1],["navy","Navy","#000080",!0],["midnightblue","Midnight Blue","#191970",!1],["cornsilk","Cornsilk","#FFF8DC",!1],["blanchedalmond","Blanched Almond","#FFEBCD",!1],["bisque",
"Bisque","#FFE4C4",!1],["navajowhite","Navajo White","#FFDEAD",!1],["wheat","Wheat","#F5DEB3",!1],["burlywood","Burly Wood","#DEB887",!1],["tan","Tan","#D2B48C",!1],["rosybrown","Rosy Brown","#BC8F8F",!1],["sandybrown","Sandy Brown","#F4A460",!1],["goldenrod","Goldenrod","#DAA520",!1],["darkgoldenrod","Dark Goldenrod","#B8860B",!1],["peru","Peru","#CD853F",!1],["chocolate","Chocolate","#D2691E",!1],["saddlebrown","Saddle Brown","#8B4513",!1],["sienna","Sienna","#A0522D",!1],["brown","Brown","#A52A2A",
!1],["maroon","Maroon","#800000",!0],["white","White","#FFFFFF",!0],["snow","Snow","#FFFAFA",!1],["honeydew","Honeydew","#F0FFF0",!1],["mintcream","Mint Cream","#F5FFFA",!1],["azure","Azure","#F0FFFF",!1],["aliceblue","Alice Blue","#F0F8FF",!1],["ghostwhite","Ghost White","#F8F8FF",!1],["whitesmoke","White Smoke","#F5F5F5",!1],["seashell","Sea shell","#FFF5EE",!1],["beige","Beige","#F5F5DC",!1],["oldlace","Old Lace","#FDF5E6",!1],["floralwhite","Floral White","#FFFAF0",!1],["ivory","Ivory","#FFFFF0",
!1],["antiquewhite","Antique White","#FAEBD7",!1],["linen","Linen","#FAF0E6",!1],["lavenderblush","Lavender Blush","#FFF0F5",!1],["mistyrose","Misty Rose","#FFE4E1",!1],["gainsboro","Gainsboro","#DCDCDC",!1],["lightgrey","Light Grey","#D3D3D3",!1],["silver","Silver","#C0C0C0",!0],["darkgray","Dark Gray","#A9A9A9",!1],["gray","Gray","#808080",!0],["dimgray","Dim Gray","#696969",!1],["lightslategray","Light Slate Gray","#778899",!1],["slategray","Slate Gray","#708090",!1],["darkslategray","Dark Slate Gray",
"#2F4F4F",!1],["black","Black","#000000",!0]],g=[],h={},f={};$.each(b,function(a,b){a=b[0];var d=b[1],e=b[2];b=b[3];h[a]=[e,d,b];f[e]=[a,d,b];b&&g.push([a,d,e])});var d=function(a){a=parseInt(a,10);if(isNaN(a))return"00";a=Math.max(0,Math.min(a,255));return"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16)};e.prototype.isBase=function(){return this.base};e.prototype.setBase=function(a){this.base="undefined"==typeof a?!0:a};e.prototype.getColors=function(){return this.base?g:b};
e.prototype.nameToHex=function(a){return h[a]?h[a][0]:""};e.prototype.hexToName=function(a){/^rgb\s*\(/.test(a)&&(a=a.match(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/),a="#"+d(a[1])+d(a[2])+d(a[3]));return f[a]?f[a][0]:""};e.prototype.isBaseColor=function(a){/^#/.test(a)&&(a=this.hexToName(a));return h[a]?h[a][2]:!1};a.BootStrapWysiHtmlPalette=e})(this);
(function(a){function e(){}var b=[["arial","Arial","sans-serif"],["bookman","Bookman","serif"],["comicsansms","Comic Sans MS","cursive"],["couriernew","Courier New","monospace"],["garamond","Garamond","serif"],["georgia","Georgia","serif"],["helvetica","Helvetica","sans-serif"],["impact","Impact","fantasy"],["palatino","Palatino","serif"],["timesnewroman","Times New Roman","serif"],["trebuchetms","Trebuchet MS","sans-serif"],["verdana","Verdana","sans-serif"]],g={},h={};$.each(b,function(a,b){a=b[0];
var d=b[1];b=b[2];g[a]=[d,b];h[d]=[a,b]});e.prototype.getFonts=function(){return b};e.prototype.getName=function(a){return h[a]?h[a][0]:""};e.prototype.getLabel=function(a){return g[a]?g[a][0]:""};e.prototype.getFamily=function(a){return'"'+this.getLabel(a)+'", '+this.getGenericFamily(a)};e.prototype.getGenericFamily=function(a){return g[a]?g[a][1]:""};e.prototype.isSerif=function(a){return g[a]?"serif"==g[a][1]:!1};a.BootStrapWysiHtmlFonts=e})(this);
(function(a){if("function"===typeof define&&define.amd)define(["jquery"],a);else if("object"===typeof exports)a(require("jquery"));else{if("undefined"===typeof jQuery)throw Error("BootStrapWysiHtml's JavaScript requires jQuery");a(jQuery)}})(function(a,e){var b=function(d,e){this.editable=a(d);this.palette=new BootStrapWysiHtmlPalette(!1);this.fonts=new BootStrapWysiHtmlFonts;this.options=a.extend({},b.DEFAULTS,e);I(this)},g={emphasis:'<div class="btn-group">\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="bold" title="Bold [CTRL+B]">bold</a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="italic" title="Italic [CTRL+I]">italic</a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="underline" title="Underline [CTRL+U]">underline</a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="superscript" title="Superscript"><span class="fa fa-superscript">\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="subscript" title="Subscript"><span class="fa fa-subscript">\n\t\t\t</div>',
link:'<div class="btn-group">\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="createLink" title="Add a hyperlink"><span class="fa fa-link"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="removeLink" title="Delete hyperlink"><span class="fa fa-unlink"></span></a>\n\t\t\t</div>',image:'<a class="btn btn-default" data-wysihtml-command="insertImage" title="Add an image"><span class="fa fa-image"></span></a>',lists:'<div class="btn-group">\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="insertUnorderedList" title="Create / delete a bulleted list"><span class="fa fa-list-ul"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="insertOrderedList" title="Create / delete a numbered list"><span class="fa fa-list-ol"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="indent" title="Indent"><span class="fa fa-indent"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="outdent" title="Deindent"><span class="fa fa-outdent"></span></a>\n\t\t\t</div>',
align:'<div class="btn-group">\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="alignLeftStyle" title="Align to the left"><span class="fa fa-align-left"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="alignCenterStyle" title="Center the content"><span class="fa fa-align-center"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="alignRightStyle" title="Align to the right"><span class="fa fa-align-right"></span></a>\n\t\t\t\t<a class="btn btn-default" data-wysihtml-command="justifyFull" title="Justify"><span class="fa fa-align-justify"></span></a>\n\t\t\t</div>',
hilite:'<button style="padding: 4px 6px 4px 6px" type="button" class="btn btn-default" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t<span style="display: inline-table; margin: 0; padding: 0; height: 20px;">\n\t\t\t\t\t<span style="display: table-row; margin: 0; padding: 0;">\n\t\t\t\t\t\t<span class="fa fa-font" style="display: table-cell; color: black;"></span>\n\t\t\t\t\t\t<b style="display: table-cell; vertical-align: middle; float:right; margin: 0" class="caret"></b>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span style="display: table-row; margin: 0; padding: 0; margin-top: -2px">\n\t\t\t\t\t\t<span class="current-color" style="display: table-row; background: black; width: 15px; height: 1px; line-height: 1px; padding: 0; margin: 0;">&nbsp;&nbsp;&nbsp;</span>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<div class="colors-16 dropdown-menu popover bottom">\n\t\t\t\t<div class="arrow"></div>\n\t\t\t\t<table style="table-layout:fixed; border: 1px solid #444">\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan="3" style="border: 1px solid #444;" class="wysihtml-background-transparent"><a title="No color" data-wysihtml-command="foreColor" data-wysihtml-command-blank-value="true">&nbsp;</a></td>\n\t\t\t\t\t\t\t<td style="background:white;text-align:center;border:1px solid #444;"><a class="close-popover" href="" title="Close">&nbsp;<span class="fa fa-close"></span></a></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>',
color:'<button style="padding: 4px 6px 4px 6px" type="button" class="btn btn-default" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t<span style="display: inline-table; margin: 0; padding: 0; height: 20px;">\n\t\t\t\t\t<span style="display: table-row; margin: 0; padding: 0;">\n\t\t\t\t\t\t<span class="fa fa-font" style="display: table-cell; color: black;"></span>\n\t\t\t\t\t\t<b style="display: table-cell; vertical-align: middle; float:right; margin: 0" class="caret"></b>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span style="display: table-row; margin: 0; padding: 0; margin-top: -2px">\n\t\t\t\t\t\t<span class="current-color" style="display: table-row; background: black; width: 15px; height: 1px; line-height: 1px; padding: 0; margin: 0;">&nbsp;&nbsp;&nbsp;</span>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<div class="colors-140 dropdown-menu popover bottom">\n\t\t\t\t<div class="arrow"></div>\n\t\t\t\t<table style="table-layout:fixed; border: 1px solid #444;">\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan="16" style="border: 1px solid #444;" class="wysihtml-background-transparent"><a title="no color" data-wysihtml-command="foreColor" data-wysihtml-command-blank-value="true">&nbsp;</a></td>\n\t\t\t\t\t\t\t<td colspan="4" style="background:white;text-align:center;border:1px solid #444;"><a class="close-popover" href="" title="Close">&nbsp;<span class="fa fa-close"></span></a></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>',
blocks:'<button title="Styles" id="wysiwyg-font-style" type="button" data-wysihtml-command-group="formatBlock" class="btn btn-default dropdown-toggle" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t<span class="fa fa-font"></span>\n\t\t\t\t<span class="current-block">Normal text</span>\n\t\t\t\t<b class="caret"></b>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu" aria-labelledby="wysiwyg-font-style" style="display: none;">\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-blank-value="true">Normal text</a></li>\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-value="h1">Heading 1</a></li>\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-value="h2">Heading 2</a></li>\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-value="h3">Heading 3</a></li>\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-value="h4">Heading 4</a></li>\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-value="h5">Heading 5</a></li>\n\t\t\t\t<li><a data-wysihtml-command="formatBlock" data-wysihtml-command-value="h6">Heading 6</a></li>\n\t\t\t</ul>',
"font-named-sizes":'<button title="Font size" id="wysiwyg-font-size" type="button" data-wysihtml-command-group="fontSize" class="btn btn-default dropdown-toggle" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t<span class="glyphicon glyphicon-text-size"></span>\n\t\t\t\t<span class="current-font-named-size">Normal</span>\n\t\t\t\t<b class="caret"></b>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu" aria-labelledby="wysiwyg-font-size" style="display: none;">\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-blank-value="true">Normal</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="smaller">smaller</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="larger">larger</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="small">small</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="x-small">x-small</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="xx-small">xx-small</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="medium">medium</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="large">large</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="x-large">x-large</a></li>\n\t\t\t\t<li><a data-wysihtml-command="fontSize" data-wysihtml-command-value="xx-large">xx-large</a></li>\n\t\t\t</ul>',
"font-names":'<div class="btn-group">\n\t\t\t\t<div>\n\t\t\t\t\t<button title="Fonts" id="wysiwyg-font-name" type="button" data-wysihtml-command-group="fontNameStyle" class="btn btn-default dropdown-toggle" aria-haspopup="true" aria-expanded="false">\n\t\t\t\t\t\t<span class="current-font-name">Font...</span>\n\t\t\t\t\t\t<b class="caret"></b>\n\t\t\t\t\t</button>\n\t\t\t\t\t<ul class="dropdown-menu" aria-labelledby="wysiwyg-font-name" style="display: none;">\n\t\t\t\t\t\t<li><a class="sr-only" data-wysihtml-command="fontNameStyle" data-wysihtml-command-blank-value="true">Font...</a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>',
"font-fixed-sizes":'<div class="btn-group">\n\t\t\t\t<div>\n\t\t\t\t\t<input title="Font size" type="text" list="wysihtml-size-list" class="wysihtml-size-input form-control input-sm value="10.5">\n\t\t\t\t\t<datalist id="wysihtml-size-list">\n\t\t\t\t\t\t<option value="8">\n\t\t\t\t\t\t<option value="9">\n\t\t\t\t\t\t<option value="10">\n\t\t\t\t\t\t<option value="11">\n\t\t\t\t\t\t<option value="12">\n\t\t\t\t\t\t<option value="14">\n\t\t\t\t\t\t<option value="16">\n\t\t\t\t\t\t<option value="18">\n\t\t\t\t\t\t<option value="20">\n\t\t\t\t\t\t<option value="22">\n\t\t\t\t\t\t<option value="24">\n\t\t\t\t\t\t<option value="26">\n\t\t\t\t\t\t<option value="28">\n\t\t\t\t\t\t<option value="36">\n\t\t\t\t\t\t<option value="48">\n\t\t\t\t\t\t<option value="72">\n\t\t\t\t\t</datalist>\n\t\t\t\t</div>\n\t\t\t</div>',
code:'<a title="Add a piece of computer code" class="btn btn-default" data-wysihtml-command="formatCode" data-wysihtml-command-value="language-html"><span class="fa fa-code"></span></a>',table:'<a title="Create table" class="btn btn-default" data-wysihtml-command="createTable"><span class="fa fa-table"></span></a>',undo:'<div class="btn-group">\n\t\t\t\t<a title="Undo" class="btn btn-default" data-wysihtml-command="undo"><span class="fa fa-undo"></span></a>\n\t\t\t\t<a title="Redo" class="btn btn-default" data-wysihtml-command="redo"><span class="fa fa-repeat"></span></a>\n\t\t\t</div>',
html:'<a title="HTML view" class="btn btn-default" data-wysihtml-action="change_view"><span class="fa fa-chevron-left"></span><span class="fa fa-chevron-right"></span></a>'},h={createLink:'<div class="row" data-wysihtml-dialog="createLink" style="display: none;">\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Link:</span>\n\t\t\t\t\t<input type="url" class="form-control input-sm" data-wysihtml-dialog-field="href" value="http://">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Open in:</span>\n\t\t\t\t\t<select class="form-control input-sm" data-wysihtml-dialog-field="target">\n\t\t\t\t\t\t<option value="">the same window</option>\n\t\t\t\t\t\t<option value="_blank">a new window</option>\n\t\t\t\t\t</select>\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Title:</span>\n\t\t\t\t\t<input class="form-control input-sm" data-wysihtml-dialog-field="title" value="">\n\t\t\t\t</label>\n\t\t\t\t<a class="btn btn-primary btn-sm" data-wysihtml-dialog-action="save">OK</a>&nbsp;<a class="btn btn-default btn-sm" data-wysihtml-dialog-action="cancel">Cancel</a>\n\t\t\t\t<div class="alert" role="alert" style="display: none;"></div>\n\t\t\t\t</div>',
insertImage:'<div class="row" data-wysihtml-dialog="insertImage" style="display: none;">\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Local ?</span>\n\t\t\t\t\t<input type="checkbox" class="form-control input-sm" data-wysihtml-dialog-field="data-local" style="display: inline; margin-top: -1px" value="false">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Image:</span>\n\t\t\t\t\t<span class="local-image-name form-control btn btn-default input-sm" tabindex="0"></span>\n\t\t\t\t\t<input type="text" class="form-control input-sm" data-wysihtml-dialog-field="src" value="http://">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Alignment:</span>\n\t\t\t\t\t<select class="form-control input-sm" data-wysihtml-dialog-field="className">\n\t\t\t\t\t\t<option value="">default</option>\n\t\t\t\t\t\t<option value="wysiwyg-float-left">left</option>\n\t\t\t\t\t\t<option value="wysiwyg-float-right">right</option>\n\t\t\t\t\t</select>\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Alt:</span>\n\t\t\t\t\t<input class="form-control input-sm" data-wysihtml-dialog-field="alt" value="">\n\t\t\t\t</label>\n\t\t\t\t<a class="btn btn-primary btn-sm" data-wysihtml-dialog-action="save">OK</a>&nbsp;<a class="btn btn-default btn-sm" data-wysihtml-dialog-action="cancel">Cancel</a>\n\t\t\t\t<div class="alert" role="alert" style="display: none;"></div>\n\t\t\t</div>',
createTable:'<div class="row" data-wysihtml-dialog="createTable" style="display: none;">\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Rows:</span>\n\t\t\t\t\t<input class="form-control input-sm" data-wysihtml-dialog-field="rows" value="2">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Cols:</span>\n\t\t\t\t\t<input class="form-control input-sm" data-wysihtml-dialog-field="cols" value="2">\n\t\t\t\t</label>\n\t\t\t\t<a class="btn btn-primary btn-sm" data-wysihtml-dialog-action="save">OK</a>&nbsp;<a class="btn btn-default btn-sm" data-wysihtml-dialog-action="cancel">Cancel</a>\n\t\t\t\t<div class="alert" role="alert" style="display: none;"></div>\n\t\t\t</div>',
tableTools:'<div class="popover data-wysihtml-hiddentools" data-placement="top" style="display: none;">\n\t\t\t\t<div class="arrow"></div>\n\t\t\t\t<ul data-wysihtml-hiddentools="table" style="display: none;">\n\t\t\t\t\t<li><a title="Table properties" data-wysihtml-extra-command="tableProperties"><span class="wysicon wysicon-table-properties"></span></a></li>\n\t\t\t\t\t<li><a title="Insert a row before" data-wysihtml-command="addTableCells" data-wysihtml-command-value="above"><span class="wysicon wysicon-row-before"></span></a></li>\n\t\t\t\t\t<li><a title="Add a row after" data-wysihtml-command="addTableCells" data-wysihtml-command-value="below"><span class="wysicon wysicon-row-after"></span></a></li>\n\t\t\t\t\t<li><a title="Insert a column before" data-wysihtml-command="addTableCells" data-wysihtml-command-value="before"><span class="wysicon wysicon-column-before"></span></a></li>\n\t\t\t\t\t<li><a title="Add a column after" data-wysihtml-command="addTableCells" data-wysihtml-command-value="after"><span class="wysicon wysicon-column-after"></span></a></li>\n\t\t\t\t\t<li><a title="Merge table cells" data-wysihtml-command="mergeTableCells"><span class="wysicon wysicon-merge-cells"></span></a></li>\n\t\t\t\t\t<li><a title="Delete the selected row" data-wysihtml-command="deleteTableCells" data-wysihtml-command-value="row"><span class="wysicon wysicon-delete-row"></span></a></li>\n\t\t\t\t\t<li><a title="Delete the selected column" data-wysihtml-command="deleteTableCells" data-wysihtml-command-value="column"><span class="wysicon wysicon-delete-column"></span></a></li>\n\t\t\t\t\t<li><a title="Delete this table" data-wysihtml-extra-command="deleteTable"><span class="wysicon wysicon-delete-table"></span></a></li>\n\t\t\t\t</ul>\n\t\t\t</div>',
tableProperties:'<div class="row" data-wysihtml-dialog="tableProperties" style="display: none;">\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Caption</span>\n\t\t\t\t\t<input name="caption" type="checkbox" class="form-control input-sm">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Header</span>\n\t\t\t\t\t<input name="thead" type="checkbox" class="form-control input-sm">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Full width</span>\n\t\t\t\t\t<input name="full-width" type="checkbox" class="form-control input-sm">\n\t\t\t\t</label>\n\t\t\t\t<label class="control-label">\n\t\t\t\t\t<span>Alignment</span>\n\t\t\t\t\t<select name="align" class="form-control input-sm">\n\t\t\t\t\t\t<option value=\'\'>None</option>\n\t\t\t\t\t\t<option value=\'left\'>Left</option>\n\t\t\t\t\t\t<option value=\'center\'>Center</option>\n\t\t\t\t\t\t<option value=\'right\'>Right</option>\n\t\t\t\t\t</select>\n\t\t\t\t</label>\n\t\t\t</div>',
modalDialog:'<div class="modal" data-wysihtml-dialog="modalDialog" tabindex="-1" role="dialog" aria-labelledby="wysihtml-modal-title" aria-hidden="true">\n\t\t\t\t<div class="modal-dialog" role="document">\n\t\t\t\t\t<div class="modal-content">\n\t\t\t\t\t\t<div class="modal-header">\n\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close">\n\t\t\t\t\t\t\t\t<span aria-hidden="true">&nbsp;<span class="fa fa-close"></span></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<h4 id="wysihtml-modal-title" class="modal-title">TITLE</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="modal-body">\n\t\t\t\t\t\t\t<div class="body-content"></div>\n\t\t\t\t\t\t\t<div class="alert" role="alert" style="display: none;"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="modal-footer">\n\t\t\t\t\t\t\t<button class="btn btn-default modal-cancel" data-dismiss="modal" aria-hidden="true">Cancel</button>\n\t\t\t\t\t\t\t<button class="btn btn-primary modal-ok">OK</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>'},
f=function(b){b=b.iframe.contents().find("head");var d=b.find("style");0==d.length&&(d=a("<style>",{type:"text/css"}),b.append(d));d.append('\n\t\t.wysiwyg-color-indianred { color: indianred; }\n\t\t.wysiwyg-color-lightcoral { color: lightcoral; }\n\t\t.wysiwyg-color-salmon { color: salmon; }\n\t\t.wysiwyg-color-darksalmon { color: darksalmon; }\n\t\t.wysiwyg-color-lightsalmon { color: lightsalmon; }\n\t\t.wysiwyg-color-crimson { color: crimson; }\n\t\t.wysiwyg-color-red { color: red; }\n\t\t.wysiwyg-color-firebrick { color: firebrick; }\n\t\t.wysiwyg-color-darkred { color: darkred; }\n\t\t.wysiwyg-color-pink { color: pink; }\n\t\t.wysiwyg-color-lightpink { color: lightpink; }\n\t\t.wysiwyg-color-hotpink { color: hotpink; }\n\t\t.wysiwyg-color-deeppink { color: deeppink; }\n\t\t.wysiwyg-color-mediumvioletred { color: mediumvioletred; }\n\t\t.wysiwyg-color-palevioletred { color: palevioletred; }\n\t\t.wysiwyg-color-coral { color: coral; }\n\t\t.wysiwyg-color-tomato { color: tomato; }\n\t\t.wysiwyg-color-orangered { color: orangered; }\n\t\t.wysiwyg-color-darkorange { color: darkorange; }\n\t\t.wysiwyg-color-orange { color: orange; }\n\t\t.wysiwyg-color-gold { color: gold; }\n\t\t.wysiwyg-color-yellow { color: yellow; }\n\t\t.wysiwyg-color-lightyellow { color: lightyellow; }\n\t\t.wysiwyg-color-lemonchiffon { color: lemonchiffon; }\n\t\t.wysiwyg-color-lightgoldenrodyellow { color: lightgoldenrodyellow; }\n\t\t.wysiwyg-color-papayawhip { color: papayawhip; }\n\t\t.wysiwyg-color-moccasin { color: moccasin; }\n\t\t.wysiwyg-color-peachpuff { color: peachpuff; }\n\t\t.wysiwyg-color-palegoldenrod { color: palegoldenrod; }\n\t\t.wysiwyg-color-khaki { color: khaki; }\n\t\t.wysiwyg-color-darkkhaki { color: darkkhaki; }\n\t\t.wysiwyg-color-lavender { color: lavender; }\n\t\t.wysiwyg-color-thistle { color: thistle; }\n\t\t.wysiwyg-color-plum { color: plum; }\n\t\t.wysiwyg-color-violet { color: violet; }\n\t\t.wysiwyg-color-orchid { color: orchid; }\n\t\t.wysiwyg-color-fuchsia { color: fuchsia; }\n\t\t.wysiwyg-color-mediumorchid { color: mediumorchid; }\n\t\t.wysiwyg-color-mediumpurple { color: mediumpurple; }\n\t\t.wysiwyg-color-amethyst { color: amethyst; }\n\t\t.wysiwyg-color-rebeccapurple { color: rebeccapurple; }\n\t\t.wysiwyg-color-blueviolet { color: blueviolet; }\n\t\t.wysiwyg-color-darkviolet { color: darkviolet; }\n\t\t.wysiwyg-color-darkorchid { color: darkorchid; }\n\t\t.wysiwyg-color-darkmagenta{ color: darkmagenta; }\n\t\t.wysiwyg-color-purple { color: purple; }\n\t\t.wysiwyg-color-indigo { color: indigo; }\n\t\t.wysiwyg-color-slateblue { color: slateblue; }\n\t\t.wysiwyg-color-darkslateblue { color: darkslateblue; }\n\t\t.wysiwyg-color-mediumslateblue { color: mediumslateblue; }\n\t\t.wysiwyg-color-greenyellow { color: greenyellow; }\n\t\t.wysiwyg-color-chartreuse { color: chartreuse; }\n\t\t.wysiwyg-color-lawngreen { color: lawngreen; }\n\t\t.wysiwyg-color-lime { color: lime; }\n\t\t.wysiwyg-color-limegreen { color: limegreen; }\n\t\t.wysiwyg-color-palegreen { color: palegreen; }\n\t\t.wysiwyg-color-lightgreen { color: lightgreen; }\n\t\t.wysiwyg-color-mediumspringgreen { color: mediumspringgreen; }\n\t\t.wysiwyg-color-springgreen { color: springgreen; }\n\t\t.wysiwyg-color-mediumseagreen { color: mediumseagreen; }\n\t\t.wysiwyg-color-seagreen { color: seagreen; }\n\t\t.wysiwyg-color-forestgreen { color: forestgreen; }\n\t\t.wysiwyg-color-green { color: green; }\n\t\t.wysiwyg-color-darkgreen { color: darkgreen; }\n\t\t.wysiwyg-color-yellowgreen { color: yellowgreen; }\n\t\t.wysiwyg-color-olivedrab { color: olivedrab; }\n\t\t.wysiwyg-color-olive { color: olive; }\n\t\t.wysiwyg-color-darkolivegreen { color: darkolivegreen; }\n\t\t.wysiwyg-color-mediumaquamarine { color: mediumaquamarine; }\n\t\t.wysiwyg-color-darkseagreen { color: darkseagreen; }\n\t\t.wysiwyg-color-lightseagreen { color: lightseagreen; }\n\t\t.wysiwyg-color-darkcyan { color: darkcyan; }\n\t\t.wysiwyg-color-teal { color: teal; }\n\t\t.wysiwyg-color-aqua { color: aqua; }\n\t\t.wysiwyg-color-lightcyan { color: lightcyan; }\n\t\t.wysiwyg-color-paleturquoise { color: paleturquoise; }\n\t\t.wysiwyg-color-aquamarine { color: aquamarine; }\n\t\t.wysiwyg-color-turquoise { color: turquoise; }\n\t\t.wysiwyg-color-mediumturquoise { color: mediumturquoise; }\n\t\t.wysiwyg-color-darkturquoise { color: darkturquoise; }\n\t\t.wysiwyg-color-cadetblue { color: cadetblue; }\n\t\t.wysiwyg-color-steelblue { color: steelblue; }\n\t\t.wysiwyg-color-lightsteelblue { color: lightsteelblue; }\n\t\t.wysiwyg-color-powderblue { color: powderblue; }\n\t\t.wysiwyg-color-lightblue { color: lightblue; }\n\t\t.wysiwyg-color-skyblue { color: skyblue; }\n\t\t.wysiwyg-color-lightskyblue { color: lightskyblue; }\n\t\t.wysiwyg-color-deepskyblue { color: deepskyblue; }\n\t\t.wysiwyg-color-dodgerblue { color: dodgerblue; }\n\t\t.wysiwyg-color-cornflowerblue { color: cornflowerblue; }\n\t\t.wysiwyg-color-royalblue { color: royalblue; }\n\t\t.wysiwyg-color-blue { color: blue; }\n\t\t.wysiwyg-color-mediumblue { color: mediumblue; }\n\t\t.wysiwyg-color-darkblue { color: darkblue; }\n\t\t.wysiwyg-color-navy { color: navy; }\n\t\t.wysiwyg-color-midnightblue { color: midnightblue; }\n\t\t.wysiwyg-color-cornsilk { color: cornsilk; }\n\t\t.wysiwyg-color-blanchedalmond { color: blanchedalmond; }\n\t\t.wysiwyg-color-bisque { color: bisque; }\n\t\t.wysiwyg-color-navajowhite { color: navajowhite; }\n\t\t.wysiwyg-color-wheat { color: wheat; }\n\t\t.wysiwyg-color-burlywood { color: burlywood; }\n\t\t.wysiwyg-color-tan { color: tan; }\n\t\t.wysiwyg-color-rosybrown { color: rosybrown; }\n\t\t.wysiwyg-color-sandybrown { color: sandybrown; }\n\t\t.wysiwyg-color-goldenrod { color: goldenrod; }\n\t\t.wysiwyg-color-darkgoldenrod { color: darkgoldenrod; }\n\t\t.wysiwyg-color-peru { color: peru; }\n\t\t.wysiwyg-color-chocolate { color: chocolate; }\n\t\t.wysiwyg-color-saddlebrown { color: saddlebrown; }\n\t\t.wysiwyg-color-sienna { color: sienna; }\n\t\t.wysiwyg-color-brown { color: brown; }\n\t\t.wysiwyg-color-maroon { color: maroon; }\n\t\t.wysiwyg-color-white { color: white; }\n\t\t.wysiwyg-color-snow { color: snow; }\n\t\t.wysiwyg-color-honeydew { color: honeydew; }\n\t\t.wysiwyg-color-mintcream { color: mintcream; }\n\t\t.wysiwyg-color-azure { color: azure; }\n\t\t.wysiwyg-color-aliceblue { color: aliceblue; }\n\t\t.wysiwyg-color-ghostwhite { color: ghostwhite; }\n\t\t.wysiwyg-color-whitesmoke { color: whitesmoke; }\n\t\t.wysiwyg-color-seashell { color: seashell; }\n\t\t.wysiwyg-color-beige { color: beige; }\n\t\t.wysiwyg-color-oldlace { color: oldlace; }\n\t\t.wysiwyg-color-floralwhite { color: floralwhite; }\n\t\t.wysiwyg-color-ivory { color: ivory; }\n\t\t.wysiwyg-color-antiquewhite { color: antiquewhite; }\n\t\t.wysiwyg-color-linen { color: linen; }\n\t\t.wysiwyg-color-lavenderblush { color: lavenderblush; }\n\t\t.wysiwyg-color-mistyrose { color: mistyrose; }\n\t\t.wysiwyg-color-gainsboro { color: gainsboro; }\n\t\t.wysiwyg-color-lightgrey { color: lightgrey; }\n\t\t.wysiwyg-color-silver { color: silver; }\n\t\t.wysiwyg-color-darkgray { color: darkgray; }\n\t\t.wysiwyg-color-gray { color: gray; }\n\t\t.wysiwyg-color-dimgray { color: dimgray; }\n\t\t.wysiwyg-color-lightslategray { color: lightslategray; }\n\t\t.wysiwyg-color-slategray { color: slategray; }\n\t\t.wysiwyg-color-darkslategray { color: darkslategray; }\n\t\t.wysiwyg-color-black { color: black; }\n\t\t.wysiwyg-hilite-color-indianred { background-color: indianred; }\n\t\t.wysiwyg-hilite-color-lightcoral { background-color: lightcoral; }\n\t\t.wysiwyg-hilite-color-salmon { background-color: salmon; }\n\t\t.wysiwyg-hilite-color-darksalmon { background-color: darksalmon; }\n\t\t.wysiwyg-hilite-color-lightsalmon { background-color: lightsalmon; }\n\t\t.wysiwyg-hilite-color-crimson { background-color: crimson; }\n\t\t.wysiwyg-hilite-color-red { background-color: red; }\n\t\t.wysiwyg-hilite-color-firebrick { background-color: firebrick; }\n\t\t.wysiwyg-hilite-color-darkred { background-color: darkred; }\n\t\t.wysiwyg-hilite-color-pink { background-color: pink; }\n\t\t.wysiwyg-hilite-color-lightpink { background-color: lightpink; }\n\t\t.wysiwyg-hilite-color-hotpink { background-color: hotpink; }\n\t\t.wysiwyg-hilite-color-deeppink { background-color: deeppink; }\n\t\t.wysiwyg-hilite-color-mediumvioletred { background-color: mediumvioletred; }\n\t\t.wysiwyg-hilite-color-palevioletred { background-color: palevioletred; }\n\t\t.wysiwyg-hilite-color-coral { background-color: coral; }\n\t\t.wysiwyg-hilite-color-tomato { background-color: tomato; }\n\t\t.wysiwyg-hilite-color-orangered { background-color: orangered; }\n\t\t.wysiwyg-hilite-color-darkorange { background-color: darkorange; }\n\t\t.wysiwyg-hilite-color-orange { background-color: orange; }\n\t\t.wysiwyg-hilite-color-gold { background-color: gold; }\n\t\t.wysiwyg-hilite-color-yellow { background-color: yellow; }\n\t\t.wysiwyg-hilite-color-lightyellow { background-color: lightyellow; }\n\t\t.wysiwyg-hilite-color-lemonchiffon { background-color: lemonchiffon; }\n\t\t.wysiwyg-hilite-color-lightgoldenrodyellow { background-color: lightgoldenrodyellow; }\n\t\t.wysiwyg-hilite-color-papayawhip { background-color: papayawhip; }\n\t\t.wysiwyg-hilite-color-moccasin { background-color: moccasin; }\n\t\t.wysiwyg-hilite-color-peachpuff { background-color: peachpuff; }\n\t\t.wysiwyg-hilite-color-palegoldenrod { background-color: palegoldenrod; }\n\t\t.wysiwyg-hilite-color-khaki { background-color: khaki; }\n\t\t.wysiwyg-hilite-color-darkkhaki { background-color: darkkhaki; }\n\t\t.wysiwyg-hilite-color-lavender { background-color: lavender; }\n\t\t.wysiwyg-hilite-color-thistle { background-color: thistle; }\n\t\t.wysiwyg-hilite-color-plum { background-color: plum; }\n\t\t.wysiwyg-hilite-color-violet { background-color: violet; }\n\t\t.wysiwyg-hilite-color-orchid { background-color: orchid; }\n\t\t.wysiwyg-hilite-color-fuchsia { background-color: fuchsia; }\n\t\t.wysiwyg-hilite-color-mediumorchid { background-color: mediumorchid; }\n\t\t.wysiwyg-hilite-color-mediumpurple { background-color: mediumpurple; }\n\t\t.wysiwyg-hilite-color-amethyst { background-color: amethyst; }\n\t\t.wysiwyg-hilite-color-blueviolet { background-color: blueviolet; }\n\t\t.wysiwyg-hilite-color-darkviolet { background-color: darkviolet; }\n\t\t.wysiwyg-hilite-color-darkorchid { background-color: darkorchid; }\n\t\t.wysiwyg-hilite-color-darkmagenta{ background-color: darkmagenta; }\n\t\t.wysiwyg-hilite-color-purple { background-color: purple; }\n\t\t.wysiwyg-hilite-color-indigo { background-color: indigo; }\n\t\t.wysiwyg-hilite-color-slateblue { background-color: slateblue; }\n\t\t.wysiwyg-hilite-color-darkslateblue { background-color: darkslateblue; }\n\t\t.wysiwyg-hilite-color-mediumslateblue { background-color: mediumslateblue; }\n\t\t.wysiwyg-hilite-color-greenyellow { background-color: greenyellow; }\n\t\t.wysiwyg-hilite-color-chartreuse { background-color: chartreuse; }\n\t\t.wysiwyg-hilite-color-lawngreen { background-color: lawngreen; }\n\t\t.wysiwyg-hilite-color-lime { background-color: lime; }\n\t\t.wysiwyg-hilite-color-limegreen { background-color: limegreen; }\n\t\t.wysiwyg-hilite-color-palegreen { background-color: palegreen; }\n\t\t.wysiwyg-hilite-color-lightgreen { background-color: lightgreen; }\n\t\t.wysiwyg-hilite-color-mediumspringgreen { background-color: mediumspringgreen; }\n\t\t.wysiwyg-hilite-color-springgreen { background-color: springgreen; }\n\t\t.wysiwyg-hilite-color-mediumseagreen { background-color: mediumseagreen; }\n\t\t.wysiwyg-hilite-color-seagreen { background-color: seagreen; }\n\t\t.wysiwyg-hilite-color-forestgreen { background-color: forestgreen; }\n\t\t.wysiwyg-hilite-color-green { background-color: green; }\n\t\t.wysiwyg-hilite-color-darkgreen { background-color: darkgreen; }\n\t\t.wysiwyg-hilite-color-yellowgreen { background-color: yellowgreen; }\n\t\t.wysiwyg-hilite-color-olivedrab { background-color: olivedrab; }\n\t\t.wysiwyg-hilite-color-olive { background-color: olive; }\n\t\t.wysiwyg-hilite-color-darkolivegreen { background-color: darkolivegreen; }\n\t\t.wysiwyg-hilite-color-mediumaquamarine { background-color: mediumaquamarine; }\n\t\t.wysiwyg-hilite-color-darkseagreen { background-color: darkseagreen; }\n\t\t.wysiwyg-hilite-color-lightseagreen { background-color: lightseagreen; }\n\t\t.wysiwyg-hilite-color-darkcyan { background-color: darkcyan; }\n\t\t.wysiwyg-hilite-color-teal { background-color: teal; }\n\t\t.wysiwyg-hilite-color-aqua { background-color: aqua; }\n\t\t.wysiwyg-hilite-color-lightcyan { background-color: lightcyan; }\n\t\t.wysiwyg-hilite-color-paleturquoise { background-color: paleturquoise; }\n\t\t.wysiwyg-hilite-color-aquamarine { background-color: aquamarine; }\n\t\t.wysiwyg-hilite-color-turquoise { background-color: turquoise; }\n\t\t.wysiwyg-hilite-color-mediumturquoise { background-color: mediumturquoise; }\n\t\t.wysiwyg-hilite-color-darkturquoise { background-color: darkturquoise; }\n\t\t.wysiwyg-hilite-color-cadetblue { background-color: cadetblue; }\n\t\t.wysiwyg-hilite-color-steelblue { background-color: steelblue; }\n\t\t.wysiwyg-hilite-color-lightsteelblue { background-color: lightsteelblue; }\n\t\t.wysiwyg-hilite-color-powderblue { background-color: powderblue; }\n\t\t.wysiwyg-hilite-color-lightblue { background-color: lightblue; }\n\t\t.wysiwyg-hilite-color-skyblue { background-color: skyblue; }\n\t\t.wysiwyg-hilite-color-lightskyblue { background-color: lightskyblue; }\n\t\t.wysiwyg-hilite-color-deepskyblue { background-color: deepskyblue; }\n\t\t.wysiwyg-hilite-color-dodgerblue { background-color: dodgerblue; }\n\t\t.wysiwyg-hilite-color-cornflowerblue { background-color: cornflowerblue; }\n\t\t.wysiwyg-hilite-color-royalblue { background-color: royalblue; }\n\t\t.wysiwyg-hilite-color-blue { background-color: blue; }\n\t\t.wysiwyg-hilite-color-mediumblue { background-color: mediumblue; }\n\t\t.wysiwyg-hilite-color-darkblue { background-color: darkblue; }\n\t\t.wysiwyg-hilite-color-navy { background-color: navy; }\n\t\t.wysiwyg-hilite-color-midnightblue { background-color: midnightblue; }\n\t\t.wysiwyg-hilite-color-cornsilk { background-color: cornsilk; }\n\t\t.wysiwyg-hilite-color-blanchedalmond { background-color: blanchedalmond; }\n\t\t.wysiwyg-hilite-color-bisque { background-color: bisque; }\n\t\t.wysiwyg-hilite-color-navajowhite { background-color: navajowhite; }\n\t\t.wysiwyg-hilite-color-wheat { background-color: wheat; }\n\t\t.wysiwyg-hilite-color-burlywood { background-color: burlywood; }\n\t\t.wysiwyg-hilite-color-tan { background-color: tan; }\n\t\t.wysiwyg-hilite-color-rosybrown { background-color: rosybrown; }\n\t\t.wysiwyg-hilite-color-sandybrown { background-color: sandybrown; }\n\t\t.wysiwyg-hilite-color-goldenrod { background-color: goldenrod; }\n\t\t.wysiwyg-hilite-color-darkgoldenrod { background-color: darkgoldenrod; }\n\t\t.wysiwyg-hilite-color-peru { background-color: peru; }\n\t\t.wysiwyg-hilite-color-chocolate { background-color: chocolate; }\n\t\t.wysiwyg-hilite-color-saddlebrown { background-color: saddlebrown; }\n\t\t.wysiwyg-hilite-color-sienna { background-color: sienna; }\n\t\t.wysiwyg-hilite-color-brown { background-color: brown; }\n\t\t.wysiwyg-hilite-color-maroon { background-color: maroon; }\n\t\t.wysiwyg-hilite-color-white { background-color: white; }\n\t\t.wysiwyg-hilite-color-snow { background-color: snow; }\n\t\t.wysiwyg-hilite-color-honeydew { background-color: honeydew; }\n\t\t.wysiwyg-hilite-color-mintcream { background-color: mintcream; }\n\t\t.wysiwyg-hilite-color-azure { background-color: azure; }\n\t\t.wysiwyg-hilite-color-aliceblue { background-color: aliceblue; }\n\t\t.wysiwyg-hilite-color-ghostwhite { background-color: ghostwhite; }\n\t\t.wysiwyg-hilite-color-whitesmoke { background-color: whitesmoke; }\n\t\t.wysiwyg-hilite-color-seashell { background-color: seashell; }\n\t\t.wysiwyg-hilite-color-beige { background-color: beige; }\n\t\t.wysiwyg-hilite-color-oldlace { background-color: oldlace; }\n\t\t.wysiwyg-hilite-color-floralwhite { background-color: floralwhite; }\n\t\t.wysiwyg-hilite-color-ivory { background-color: ivory; }\n\t\t.wysiwyg-hilite-color-antiquewhite { background-color: antiquewhite; }\n\t\t.wysiwyg-hilite-color-linen { background-color: linen; }\n\t\t.wysiwyg-hilite-color-lavenderblush { background-color: lavenderblush; }\n\t\t.wysiwyg-hilite-color-mistyrose { background-color: mistyrose; }\n\t\t.wysiwyg-hilite-color-gainsboro { background-color: gainsboro; }\n\t\t.wysiwyg-hilite-color-lightgrey { background-color: lightgrey; }\n\t\t.wysiwyg-hilite-color-silver { background-color: silver; }\n\t\t.wysiwyg-hilite-color-darkgray { background-color: darkgray; }\n\t\t.wysiwyg-hilite-color-gray { background-color: gray; }\n\t\t.wysiwyg-hilite-color-dimgray { background-color: dimgray; }\n\t\t.wysiwyg-hilite-color-lightslategray { background-color: lightslategray; }\n\t\t.wysiwyg-hilite-color-slategray { background-color: slategray; }\n\t\t.wysiwyg-hilite-color-darkslategray { background-color: darkslategray; }\n\t\t.wysiwyg-hilite-color-black { background-color: black; }\n\n\t\t.wysiwig-font-name-couriernew { font-family: "Courier New", monospace; }\n\t\t.wysiwig-font-name-arial { font-family: "Arial", sans-serif; }\n\t\t.wysiwig-font-name-bookman { font-family: "Bookman", serif; }\n\t\t.wysiwig-font-name-comicsansms { font-family: "Comic Sans MS", cursive; }\n\t\t.wysiwig-font-name-garamond { font-family: "Garamond", serif; }\n\t\t.wysiwig-font-name-georgia { font-family: "Georgia", serif; }\n\t\t.wysiwig-font-name-helvetica { font-family: "Helvetica", sans-serif; }\n\t\t.wysiwig-font-name-impact { font-family: "Impact", fantasy; }\n\t\t.wysiwig-font-name-palatino { font-family: "Palatino", serif; }\n\t\t.wysiwig-font-name-timesnewroman { font-family: "Times New Roman", serif; }\n\t\t.wysiwig-font-name-trebuchetms { font-family: "Trebuchet MS", sans-serif; }\n\t\t.wysiwig-font-name-verdana { font-family: "Verdana", sans-serif; }\n\n\t\t.wysiwyg-font-size-smaller { font-size: smaller; }\n\t\t.wysiwyg-font-size-larger { font-size: larger; }\n\t\t.wysiwyg-font-size-xx-large { font-size: xx-large; }\n\t\t.wysiwyg-font-size-x-large { font-size: x-large; }\n\t\t.wysiwyg-font-size-large { font-size: large; }\n\t\t.wysiwyg-font-size-medium { font-size: medium; }\n\t\t.wysiwyg-font-size-small { font-size: small; }\n\t\t.wysiwyg-font-size-x-small { font-size: x-small; }\n\t\t.wysiwyg-font-size-xx-small { font-size: xx-small; }\n\n\t\t.wysiwyg-text-align-right { text-align: right; }\n\t\t.wysiwyg-text-align-center { text-align: center; }\n\t\t.wysiwyg-text-align-left { text-align: left; }\n\t\t.wysiwyg-text-align-justify { text-align: justify; }\n\t\t.wysiwyg-float-left { float: left; margin: 0 8px 8px 0; }\n\t\t.wysiwyg-float-right { float: right; margin: 0 0 8px 8px; }\n\t\t.wysiwyg-clear-right { clear: right; }\n\t\t.wysiwyg-clear-left { clear: left; }\n\t\t.wysihtml-editor table caption {min-height: 1em;background: #eee;font-weight: bold; }\n\t\t.wysihtml-editor table thead th { background: #ddd; }\n\t\t.wysihtml-editor table th, .wysihtml-editor table td, .wysihtml-editor table caption { outline: 1px dotted #abc;min-width: 5em;min-height: 1em;}\n\t\t.wysihtml-editor table th.wysiwyg-tmp-selected-cell, .wysihtml-editor table td.wysiwyg-tmp-selected-cell {\toutline: 2px solid green;}\n\n\t\ta[target="_blank"]:after { content: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAGYktHRAD/AP8A/6C9p5MAAAAHdElNRQfiBB0VEhso1+EPAAAAHWlUWHRDb21tZW50AAAAAABDcmVhdGVkIHdpdGggR0lNUGQuZQcAAACzSURBVChTjY9BCsJADEV/xlZFulGh7b4LryNeSvBEvYFXEXVmoMthNGZSlVa68MHPZD5JSGDtkwE70vkcuGm8qvccE2Z35rjFFEROYhRlMOr8gdk12TsdQ3SRGBBCiaKQwviQFX4gukqcg7lGngNdt0625SHATQ+QxVX7Q6c+9eYmdSip1Binb4IoSl5OHzNs/GAWKxk6gL7fNCOpH21Ox6Us7FRV5VGWHnXtpYFVbZumAy/r82LbZKakwAAAAABJRU5ErkJggg=="); }\n\t\t')},
d=function(b,d,e,f){d=d||"foreColor";b.palette.setBase(e);e=/Style$/.test(d);var h=b.palette.getColors(),k=0,u=a("<li>",{"class":"color-picker dropdown"});if(b.palette.isBase()){u.attr("data-wysihtml-template","hilite");u.append(a(g.hilite));var l=4}else u.attr("data-wysihtml-template","color"),u.append(a(g.color)),l=20;u.find("button").attr("title",f).attr("data-wysihtml-command-group",d);/^(hiliteColor|bgColor)/.test(d)?(u.attr("data-wysihtml-option","hilite"),u.find("button span.fa-font").attr("class",
"glyphicon glyphicon-text-background")):u.attr("data-wysihtml-option","color");f=h.length/l;for(var m=u.find("tbody tr:last-child"),n=0;n<f;n++){for(var p=a("<tr>"),wa=0;wa<l;wa++){var S=a("<td>"),fa=a("<a>",{"data-wysihtml-command":d}),q=h[k++];if(q){var r=e?b.palette.nameToHex(q[0]):q[0];fa.attr("data-wysihtml-command-value",r);S.attr("title",b.options.translate(q[1]));S.css({background:r,border:"1px solid #444"})}else fa.attr("data-wysihtml-command-blank-value","true"),S.attr("title",b.options.translate("no color")),
S.addClass("wysihtml-background-transparent"),S.css({border:"1px solid #444"});fa.append("&nbsp;");S.append(fa);p.append(S)}m.before(p)}m.find("a[data-wysihtml-command]").attr("data-wysihtml-command",d);return u},k=function(b,d){d=d||"fontName";var e=b.fonts.getFonts(),f=a("<li>",{"class":"font-names","data-wysihtml-template":"font-names","data-wysihtml-option":"font-names"});f.append(a(g["font-names"]));f.find("button").attr("data-wysihtml-command-group",d);var h=f.find("ul.dropdown-menu"),k=a("<a>",
{"data-wysihtml-command":d,"data-wysihtml-command-blank-value":"true",text:b.options.translate("Current font")}),u=a("<li>");u.append(k);h.append(u);a.each(e,function(e,f){e=f[0];f=a("<li>");var g=a("<a>",{"data-wysihtml-command":d,"data-wysihtml-command-value":e});g.append(b.fonts.getLabel(e));f.append(g);h.append(f)});return f},l=function(a){return(new RegExp(/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i)).test(a)},
n=/(\d*\.?\d+)\s?(px|em|rem|ex|%|in|cm|mm|pt|pc+)/i,m=function(b,d){"undefined"==typeof d&&(d=2);var e=n.exec(a.trim(b));if(e){var f=e[1];e={px:72*f/96,em:11.955168*f,"%":12*f/100,"in":f/.014842519685,cm:28.3464566929*f,mm:f/.352777777778,pc:f/.0836458341698,rem:f/.0836458341698}[e[2]||"px"];if(isNaN(e))return b;e=Math.ceil(e*Math.pow(10,d))/Math.pow(10,d);return e+"pt"}return b},p=function(a,b,d){wysihtml.dom.observe(b,"keydown",function(b){var e=d[b.keyCode];if((b.ctrlKey||b.metaKey||b.altKey)&&
e&&wysihtml.commands[e]){var f=a.toolbar.commandMapping[e+":null"];f&&f.dialog&&!f.state?f.dialog.show():wysihtml.commands[e].exec(a.composer,e);b.preventDefault()}})};b.DEFAULTS={toolbar:{locale:"en",blocks:!0,"font-names":!0,"font-fixed-sizes":!0,"font-named-sizes":!0,color:!0,hilite:!0,emphasis:!0,lists:!0,align:!0,link:!0,image:!0,code:!0,table:!0,undo:!0,html:!0},customTemplates:{},customDialogs:{},shortcuts:{83:"small"},stylesheets:[],parserRules:{},events:{change:function(a){},beforeload:function(){}},
translate:function(a,b){return a},name:!0,showToolbarAfterInit:!0,showToolbarDialogsOnSelection:!1,autoLink:!0,handleTabKey:!0,handleTables:!0,tableToolsOffset:{top:0,left:0},pasteParserRulesets:null,copyedFromMarking:'<meta name="copied-from" content="wysihtml">',classNames:{composer:"wysihtml-editor",body:"wysihtml-supported",sandbox:"wysihtml-sandbox",placeholder:"wysihtml-placeholder",uneditableContainer:"wysihtml-uneditable-container"},cleanUp:!0,useLineBreaks:!0,placeholderText:e};var q=function(b){return"string"===
a.type(b)?b:b.attr("data-wysihtml-option")},x=function(b){return"string"===a.type(b)?b:b.attr("data-wysihtml-template")},y=function(b){return"string"===a.type(b)?a("<li>",{"class":b,"data-wysihtml-template":b,"data-wysihtml-option":b,html:g[b]}):b},w=function(b,d,e){x(d);var f=q(d);if(b.options.toolbar[f]){d=y(d);var g=d.find("a[data-wysihtml-command], a[data-wysihtml-action]"),h=g.length;a.isArray(b.options.toolbar[f])&&g.each(function(d){d=a(this).attr("data-wysihtml-command")||a(this).attr("data-wysihtml-action");
d=d.replace(/Style$/,"");0>a.inArray(d,b.options.toolbar[f])&&(a(this).remove(),h--)});0<h&&e.append(d)}},B=function(b,d,e){x(d);var f=q(d);if(b.options.toolbar[f]){var g=y(d);g.addClass("dropdown");d=g.find("a[data-wysihtml-command-value]");var h=d.length;a.isArray(b.options.toolbar[f])&&d.each(function(d){d=a(this).attr("data-wysihtml-command-value");0>a.inArray(d,b.options.toolbar[f])&&(a(this).remove(),h--)});0<h&&(e.append(g),g.find("button[id]").each(function(){var d=a(this).attr("id");a(this).attr("id",
d+b.identificationNumber);g.find("[aria-labelledby="+d+"]").attr("aria-labelledby",d+b.identificationNumber)}))}},C=function(a,b,d){x(b);var e=q(b);a.options.toolbar[e]&&(a=y(b),a.addClass("dropdown"),d.append(a))},H=function(b){b.options.translate&&(b.toolbar.find("a, button span").each(function(){var d=a(this).attr("title");d&&a(this).attr("title",b.options.translate(d));(d=a.trim(a(this).text()))&&a(this).text(b.options.translate(d))}),b.toolbar.find("button").each(function(){var d=a(this).attr("title");
d&&a(this).attr("title",b.options.translate(d))}),b.toolbar.find("label.control-label > span").each(function(){var d=a(this).text();a(this).text(b.options.translate(d))}),b.toolbar.find("select > option").each(function(){var d=a(this).text();a(this).text(b.options.translate(d))}),b.modal.find("button.close").text(b.options.translate("Close")),b.modal.find("button.modal-cancel").text(b.options.translate("Cancel")),b.modal.find("button.modal-ok").text(b.options.translate("OK")))},D=function(a){a.tableTools.data("table");
var b=a.tableTools.data("cell");if(b&&b.visible(!0,a.editable)){a.tableTools.is(":hidden")&&b.hasClass("wysiwyg-tmp-selected-cell")&&(a.tableTools.find("ul[data-wysihtml-hiddentools]").show(),a.tableTools.show());var d=a.tableTools.find("li"),e=a.tableTools.find("a:visible").length,f=b.offset().top+a.options.tableToolsOffset.top+a.iframe.offset().top-a.iwindow.scrollTop(),g=b.offset().left+a.options.tableToolsOffset.left+a.iframe.offset().left-a.iwindow.scrollLeft(),h=b.outerWidth(!0);b=b.outerHeight(!0);
var k=d.outerWidth(!0);d=d.outerHeight(!0);var u=a.tableTools.width();a.tableTools.height();var l=a.editable.width();a.editable.height();var m=a.tableTools.hasClass("right")?"right":a.tableTools.hasClass("bottom")?"bottom":a.tableTools.hasClass("left")?"left":"top";"left"==m&&0>g-k?g+h+k>l?(a.tableTools.removeClass("left").addClass("top"),m="top"):(a.tableTools.removeClass("left").addClass("right"),m="right"):"right"==m&&g+h+k>l&&(0>g-u?(a.tableTools.removeClass("right").addClass("top"),m="top"):
(a.tableTools.removeClass("right").addClass("left"),m="left"));switch(m){case "right":a.tableTools.css({top:f+(b/2-d*e/2)+4,left:Math.min(l-k,g+h)+8,maxWidth:k+"px"});break;case "bottom":u=Math.max(0,g+(h/2-k*e/2));u+k*e>l&&(u=l-k*e);a.tableTools.css({top:f+b+8,left:u});e=(g+h/2-u)/(k*e)*100;a.tableTools.find(".arrow").css("left",e+"%");break;case "left":a.tableTools.css({top:f+(b/2-d*e/2)+4,left:g-k,maxWidth:k+"px"});break;default:u=Math.max(0,g+(h/2-k*e/2)),u+k*e>l&&(u=l-k*e),a.tableTools.css({top:f-
d,left:u}),e=(g+h/2-u)/(k*e)*100,a.tableTools.find(".arrow").css("left",e+"%")}}else a.tableTools.hide()},t=function(b){b.tableTools.find("[data-wysihtml-extra-command]").attr("href","javascript:;").click(function(d){d.preventDefault();var e=b.tableTools.data("table");switch(a(this).attr("data-wysihtml-extra-command")){case "deleteTable":b.tableTools.hide();va(b,b.options.translate("Table deletion"),b.options.translate("Please, confirm deletion of this table"),function(a){a?e.remove():b.tableTools.show()});
break;case "tableProperties":b.tableTools.hide();var f=b.toolbar.find('[data-wysihtml-dialog="tableProperties"]').clone(!0);0<e.find(">caption").length&&f.find("input[name=caption]").attr("checked",!0);0<e.find(">thead").length&&f.find("input[name=thead]").attr("checked",!0);e.hasStylePropertyValue("width","100%")&&f.find('input[name="full-width"]').attr("checked",!0);e.hasClass("wysiwyg-float-left")?f.find('select[name="align"]').val("left"):e.hasClass("wysiwyg-float-right")&&f.find('select[name="align"]').val("right");
e.hasStylePropertyValue("margin-left","auto")&&e.hasStylePropertyValue("margin-right","auto")&&f.find('select[name="align"]').val("center");va(b,b.options.translate("Table properties"),f,function(d){if(d){b.tableTools.show();f.find("input[name=caption]").is(":checked")?0==e.find(">caption").length&&e.prepend(a("<caption>&nbsp;</caption>")):e.find(">caption").remove();if(f.find("input[name=thead]").is(":checked")){if(0==e.find(">thead").length){var g="";e.find(">tbody > tr:first-child td").each(function(b){b=
a(this).attr("colspan")||1;for(var d=0;d<b;d++)g+="<th>&nbsp;</th>"});e.find(">tbody").before(a("<thead>"+g+"</thead>"))}}else e.find("thead").remove();f.find('input[name="full-width"]').is(":checked")?(e.css("width","100%"),e.find(">caption").css("width","100%")):(e.removeStyleProperty("width"),e.find(">caption").removeStyleProperty("width"));switch(f.find('select[name="align"]').val()){case "left":e.hasClass("wysiwyg-float-left")||(e.removeClass("wysiwyg-float-right"),e.removeStyleProperty("margin-left",
"margin-right"),e.addClass("wysiwyg-float-left"));break;case "center":e.removeClass("wysiwyg-float-left wysiwyg-float-right");e.removeStyleProperty("float");e.css({"margin-left":"auto","margin-right":"auto"});break;case "right":e.hasClass("wysiwyg-float-right")||(e.removeClass("wysiwyg-float-left"),e.removeStyleProperty("margin-left","margin-right"),e.addClass("wysiwyg-float-right"));break;default:e.removeClass("wysiwyg-float-left wysiwyg-float-right"),e.removeStyleProperty("margin-left","margin-right")}D(b)}else b.tableTools.show()},
function(){return f.find('input[name="full-width"]').is(":checked")&&f.find('select[name="align"]').val()?b.options.translate("Full width and alignment are incompatible!"):!1})}})},z=function(b){a(document).on("click",function(d){b.toolbar.find("li.dropdown button[aria-expanded=true]").each(function(){this!==d.target&&(a(this).parent().find(".dropdown-menu").hide(),a(this).attr("aria-expanded",!1))})});a(document).on("keydown",function(d){27==d.which&&b.toolbar.find("li.dropdown button[aria-expanded=true]").each(function(){a(this).parent().find(".dropdown-menu").hide();
a(this).attr("aria-expanded",!1)})})},A=function(b){var d=null;b.toolbar.find(".wysihtml-size-input").focus(function(){null==d&&(d=b.editor.composer.selection.getBookmark())});b.toolbar.find(".wysihtml-size-input").change(function(){if(d){var e=this;setTimeout(function(){var f=a.trim(a(e).val());0<f.length&&(f=parseInt(f,10)+"pt",b.editor.composer.selection.setBookmark(d),b.editor.composer.commands.exec("fontSizeStyle",f));d=null},0)}});b.toolbar.find(".wysihtml-size-input").keydown(function(b){13==
b.which&&(b.preventDefault(),a(this).trigger("blur"))});b.toolbar.find("span.local-image-name").keydown(function(b){13==(b.which||b.keyCode)&&(b.stopPropagation(),b.preventDefault(),a(this).trigger("click"))});b.toolbar.find("li.dropdown button").on("click",function(b){a(this).attr("aria-haspopup")&&"true"===a(this).attr("aria-haspopup")&&("false"===a(this).attr("aria-expanded")?(a(this).parent().find(".dropdown-menu").show(),a(this).attr("aria-expanded",!0)):(a(this).parent().find(".dropdown-menu").hide(),
a(this).attr("aria-expanded",!1)))});b.toolbar.find("[data-wysihtml-hiddentools]").on("click",function(d){b.toolbar.find("li.dropdown button[aria-expanded=true]").each(function(){a(this).parent().find(".dropdown-menu").hide();a(this).attr("aria-expanded",!1)})});b.toolbar.find("li.dropdown .dropdown-menu a").on("click",function(b){b=a(this).parents(".dropdown-menu");b.hide();b.parents("li.dropdown").find("button").attr("aria-expanded",!1)});b.toolbar.find("li.color-picker .dropdown-menu tbody tr td a").on("click",
function(b){var d=a(this).parents(".dropdown-menu");a(this).hasClass("close-popover")?b.preventDefault():d.parents("li.color-picker").find("button span.current-color").css("background",a(this).attr("data-wysihtml-command-value"))})},K=function(b,d){d.change(function(b){var d=a(this).parent().parent(),e=d.find("input[data-wysihtml-dialog-field=src]"),f=d.find("input[data-wysihtml-dialog-field=data-local]"),g=d.find("span.local-image-name"),h=b.target.files;b=new FileReader;b.onload=function(a){e.val(a.target.result);
f.val(h[0].name);g.text(h[0].name)};b.onerror=function(a){d.find("div.alert").addClass("alert-danger").text(a.target.error.name).show()};b.readAsDataURL(h[0])})},E=function(b){b.toolbar.find("div[data-wysihtml-dialog=insertImage] input[type=checkbox]").change(function(d){var e=a(this).parent().parent();d=e.find("input[data-wysihtml-dialog-field=src]");e.find("input[data-wysihtml-dialog-field=alt]");var f=e.find("span.local-image-name");a(this).is(":checked")?(0==e.find("input[type=file]").length&&
(e=a("<input>",{type:"file",accept:"image/*","class":"form-control input-sm",value:""}),d.before(e),K(b,e),e.hide()),"false"==a(this).val()?(f.text(b.options.translate("Select an image file ...")).show(),f.removeAttr("title")):(f.text(a(this).val()).show(),f.attr("title",b.options.translate("Click if you want to replace this image"))),d.hide()):(/^data:image/.test(d.val())&&d.val("http://"),a(this).val("false"),f.hide(),e.find("input[type=file]").remove(),d.show())});b.toolbar.find("div[data-wysihtml-dialog=insertImage] a[data-wysihtml-dialog-action=save]").click(function(d){var e=
a(this).parent();var f=e.find("input[data-wysihtml-dialog-field=src]").val();f=/^data:image\//.test(f)?!0:l(f);f?(f=e.find("input[data-wysihtml-dialog-field=alt]").val(),""===a.trim(f)?(e.find("div.alert").addClass("alert-danger").text(b.options.translate("The alt attribute is mandatory!")).show(),d.preventDefault(),d.stopPropagation()):(e.find("input[type=file]").remove(),e.find("span.local-image-name").hide(),e.find("div.alert").removeClass("alert-danger").text("").hide())):(e.find("input[data-wysihtml-dialog-field=data-local]").is(":checked")?
e.find("div.alert").addClass("alert-danger").text(b.options.translate("You have not selected a file or it is invalid!")).show():e.find("div.alert").addClass("alert-danger").text(b.options.translate("You have entered an invalid url!")).show(),d.preventDefault(),d.stopPropagation())});b.toolbar.find("div[data-wysihtml-dialog=insertImage] a[data-wysihtml-dialog-action=cancel]").click(function(b){b=a(this).parent();b.find("input[type=file]").remove();b.find("span.local-image-name").hide();b.find("div.alert").removeClass("alert-danger").text("").hide()});
b.toolbar.find("div[data-wysihtml-dialog=createLink] a[data-wysihtml-dialog-action=save]").click(function(d){var e=a(this).parent(),f=e.find("input[data-wysihtml-dialog-field=href]").val();if(l(f)){d=a.trim(e.find("input[data-wysihtml-dialog-field=title]").val());var g=e.find("select[data-wysihtml-dialog-field=target]").val();f=b.options.translate("New window");var h=new RegExp("\\s*-\\s*"+f+"$");"_blank"==g?""!=d&&h.test(d)||(g=b.editor.composer.selection.getText(),""==d?e.find("input[data-wysihtml-dialog-field=title]").val(g+
" - "+f):e.find("input[data-wysihtml-dialog-field=title]").val(d+" - "+f)):""!==d&&h.test(d)&&e.find("input[data-wysihtml-dialog-field=title]").val(d.replace(h,""));e.find("div.alert").removeClass("alert-danger").text("").hide()}else e.find("div.alert").addClass("alert-danger").text(b.options.translate("You have entered an invalid url!")).show(),d.preventDefault(),d.stopPropagation()});b.toolbar.find("div[data-wysihtml-dialog=tableProperties] a[data-wysihtml-dialog-action=save]").click(function(b){a(this).parent().hide()});
b.toolbar.find("div[data-wysihtml-dialog=tableProperties] a[data-wysihtml-dialog-action=cancel]").click(function(b){a(this).parent().hide()})},v=function(b){b.editor.on("tableselect",function(){setTimeout(function(){var d=b.editor.composer.selection.getSelection(),e=b.tableTools.find('a[data-wysihtml-command="mergeTableCells"]');e.is(".wysihtml-command-active")?e.attr("title",b.options.translate("Cancel table cells merging")):e.attr("title",b.options.translate("Merge table cells"));d&&d.anchorNode&&
(b.tableTools.removeClass("top right bottom left").addClass(b.tableTools.attr("data-placement")).show(),d=a(d.anchorNode),d=d.is("td, th")?d:d.parents("td, th"),e=d.parents("table"),b.tableTools.data("table",e),b.tableTools.data("cell",d),D(b));b.options.handleTables||b.tableTools.find("ul[data-wysihtml-hiddentools]").show();b.tableTools.show()},50)});b.editor.on("tableselectchange",function(){b.tableTools.find('a[data-wysihtml-command="mergeTableCells"]').attr("title",b.options.translate("Merge table cells"))});
b.editor.on("tableunselect:composer",function(){b.tableTools.hide();b.options.handleTables||b.tableTools.find("ul[data-wysihtml-hiddentools]").hide()});b.editor.on("beforeload",function(a){ta(b)});b.editor.on("change_view",function(){b.toolbar.find("a.btn, button").not('[data-wysihtml-action="change_view"]').toggleClass("disabled")});b.editor.on("interaction",function(){setTimeout(function(){a.each(["block","font-name","font-named-size"],function(d,e){b.editable.parent().find("li."+e+"s").each(function(){var b=
a(this),d=b.find("button");b=d.hasClass("wysihtml-command-active")?b.find(".dropdown-menu a.wysihtml-command-active"):b.find(".dropdown-menu a[data-wysihtml-command-blank-value]");1<b.length&&(b.first().removeClass("wysihtml-command-active"),b=b.last());d.find("span.current-"+e).text(b.text())})});b.editable.parent().find("li.color-picker").each(function(){var b=a(this),d=b.find("button");b=d.hasClass("wysihtml-command-active")?b.find(".dropdown-menu a.wysihtml-command-active").attr("data-wysihtml-command-value"):
"black";d.find("span.current-color").css("background",b)});if(b.editor.composer.commands.state("fontSizeStyle")){var d=parseInt(b.editor.composer.commands.stateValue("fontSizeStyle"),10);b.toolbar.find(".wysihtml-size-input").val(d);b.toolbar.find(".wysihtml-size-input").parent().addClass("wysihtml-command-active")}else{d="";if(b.editor.composer.commands.state("formatBlock")){var e=b.editor.composer.commands.state("formatBlock")[0];e=window.getComputedStyle(e,":first-line").getPropertyValue("font-size");
e=m(e,0);/pt$/i.test(e)&&(d=e.replace(/pt$/i,""))}b.toolbar.find(".wysihtml-size-input").val(d);b.toolbar.find(".wysihtml-size-input").parent().removeClass("wysihtml-command-active")}},20)});b.editor.on("change:dialog",function(a){if("insertImage"==a.command){a=b.toolbar.find("div[data-wysihtml-dialog=insertImage]");var d=a.find("input[data-wysihtml-dialog-field=data-local]");a.find("input[data-wysihtml-dialog-field=alt]");var e=a.find("input[data-wysihtml-dialog-field=src]");a.is(":visible")&&(d.prop("checked",
"false"!==d.val()||/^data:image/.test(e.val())),d.trigger("change"))}});b.editor.on("show:dialog",function(a){if("insertImage"==a.command){a=b.toolbar.find("div[data-wysihtml-dialog=insertImage]");var d=a.find("input[data-wysihtml-dialog-field=data-local]");""==a.find("input[data-wysihtml-dialog-field=alt]").val()?d.prop("checked",!1):"false"==d.val()||d.is(":checked")?"false"==d.val()&&d.is(":checked")&&d.prop("checked",!1):d.prop("checked",!0);d.trigger("change")}});b.editor.on("drop:composer",
function(b){for(var d=a(b.target),e={},f=0,g;g=b.dataTransfer.files[f];f++)if(g.type.match("image.*")){var h=new FileReader;h.onload=function(a){return function(b){e[a.name]=b.target.result}}(g);h.onerror=function(a){return function(a){console.log(a.target.error.name)}}(g);h.readAsDataURL(g)}setTimeout(function(){d.find("img").each(function(){if(!a(this).attr("data-local")){var b=a(this).attr("src"),d="";a.each(e,function(a,e){if(e==b)return d=a,!1});""!=d&&(a(this).attr("data-local",d),a(this).attr("alt",
d))}})},100)});b.editor.on("load",function(){f(b);b.scrollable.on("scroll",function(a){b.options.toolbar.table&&D(b)});b.iwindow.on("click",function(d){b.toolbar.find("li.dropdown button[aria-expanded=true]").each(function(){a(this).parent().find(".dropdown-menu").hide();a(this).attr("aria-expanded",!1)})})})},I=function(b){var e=a("<div>",{"class":"wysihtml-toolbar btn-toolbar",role:"toolbar",style:"display: none;"});b.identificationNumber=Math.floor(1E4*Math.random());var f=a("<ul>");w(b,"emphasis",
f);w(b,"link",f);w(b,"image",f);w(b,"lists",f);w(b,"align",f);B(b,"blocks",f);B(b,k(b,"fontNameStyle"),f);C(b,"font-fixed-sizes",f);B(b,"font-named-sizes",f);w(b,"table",f);w(b,"code",f);B(b,d(b,"foreColor",!1,"Text color"),f);B(b,d(b,"hiliteColor",!0,"Text highlight color"),f);var g={locale:b.options.locale,options:b.options};a.each(b.options.customTemplates,function(a,d){b.options.toolbar[a]&&f.append(d(g))});w(b,"undo",f);w(b,"html",f);e.append(f);a.each(h,function(a,b){e.append(b)});a.each(b.options.customDialogs,
function(a,b){b='<div class="row" data-wysihtml-dialog="'+a+'" style="display: none;">'+b+'<a class="btn btn-primary btn-sm" data-wysihtml-dialog-action="save">OK</a>&nbsp;<a class="btn btn-default btn-sm" data-wysihtml-dialog-action="cancel">Cancel</a><div class="alert" role="alert" style="display: none;"></div>';e.append(b)});e.find("[data-wysihtml-dialog=modalDialog]").each(function(){a(this).find("[id=wysihtml-modal-title]").attr("id","wysihtml-modal-title"+b.identificationNumber);a(this).attr("aria-labelledby",
"wysihtml-modal-title"+b.identificationNumber)});b.editable.wrap(a("<div>",{"class":"container-fluid",style:"padding: 0; margin: 0;"}));b.editable.before(e);b.toolbar=e;b.modal=b.toolbar.find('div[data-wysihtml-dialog="modalDialog"]').modal({show:!1});H(b);a.each(["bold","italic","underline"],function(d,e){if(!0===b.options.toolbar.emphasis||a.isArray(b.options.toolbar.emphasis)&&0<=a.inArray(e,b.options.toolbar.emphasis))d=b.toolbar.find('a[data-wysihtml-command="'+e+'"]'),d.text(d.text()[0].toUpperCase())});
var l=a.extend(!0,{},wysihtmlParserRules,b.options.parserRules);b.options.classNames.sandbox+=b.identificationNumber;b.editor=new wysihtml.Editor(b.editable.get(0),{toolbar:b.toolbar.get(0),parserRules:l,stylesheets:b.options.stylesheets,name:b.options.name,showToolbarAfterInit:b.options.showToolbarAfterInit,showToolbarDialogsOnSelection:b.options.showToolbarDialogsOnSelection,autoLink:b.options.autoLink,handleTabKey:b.options.handleTabKey,handleTables:b.options.handleTables,pasteParserRulesets:b.options.pasteParserRulesets,
copyedFromMarking:b.options.copyedFromMarking,classNames:b.options.classNames,cleanUp:b.options.cleanUp,useLineBreaks:b.options.useLineBreaks,placeholderText:b.options.placeholderText});b.iframe=a("."+b.options.classNames.sandbox);b.iframe.is("iframe")?(b.iwindow=b.scrollable=a(b.iframe[0].contentWindow),b.idocument=a(b.iwindow[0].document)):(b.scrollable=b.editable.css("overflow","scroll"),b.iframe=a("body"),b.iwindow=b.editable,b.idocument=a(document),a.each(b.options.stylesheets,function(b,d){0==
a("head").find('link[href="'+d+'"]').length&&(document.createStyleSheet?document.createStyleSheet(d):a("head").append(a("<link rel='stylesheet' href='"+d+"' type='text/css' media='screen' />")))}));b.tableTools=e.find("div.data-wysihtml-hiddentools");v(b);t(b);b.editor.composer.editableArea.contentDocument?p(b.editor,b.editor.composer.editableArea.contentDocument.body||b.editor.composer.editableArea.contentDocument,b.options.shortcuts):p(b.editor,b.editor.composer.editableArea,b.options.shortcuts);
E(b);if(b.options.events)for(var m in b.options.events)if(b.options.events.hasOwnProperty(m))b.editor.on(m,b.options.events[m]);A(b);z(b)},G=function(b,d,e){e=e||a("body");e.find(b).each(function(){var b=a("<"+d+">",{html:a(this).html()});a.each(this.attributes,function(){b.attr(this.name,this.value)});a(this).replaceWith(b)})},r=function(b){b=b.replace(/;\s*$/,"").split(/;\s*/);var d={};a.each(b,function(a,b){a=b.split(/\s*:\s*/);d[a[0]]=a[1]});return d},L=function(b){b=r(b);var d=[];a.each(b,function(a,
b){d.push(a+": "+b.replace(/"/g,"'")+";")});return d.join(" ")},M=function(b){var d={};a.each(b.attributes,function(b,e){a.each(e,function(b,e){a.each(e,function(b,e){d[b]||(d[b]="");d[b]=a.trim(d[b]+" "+e)})})});d.style&&(d.style=L(d.style));b.attributes=d},P=function(b,d){var e=[];a.each(d.prop("attributes"),function(){if(this.value){var a={};a[this.name]=this.value;e.push(a)}});b.depth++;b.attributes.push(e);b.html=d.html()},J=function(a,b,d){a=a.children();1==a.length&&a.is(b)&&(P(d,a),J(a,b,
d))},N="address article aside blockquote br caption canvas dd div dl dt fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hr li main nav noscript ol output p pre section table thead tbody tr th td tfoot ul video".split(" "),la="a abbr acronym b bdo big br button cite code dfn em i img input kbd label map object q samp script select small span strong sub sup textarea time tt var".split(" "),W="area base br col embed frame hr img input link meta param source track wbr".split(" "),X=function(b,
d){d="undefined"==typeof d?0:d;for(var e="",f="",g=0;g<d;g++)f+="    ";b.each(function(){if(this.nodeType==Node.TEXT_NODE)e+=a(this).text();else if(this.nodeType==Node.ELEMENT_NODE){var b=this.nodeName.toLowerCase();0<=a.inArray(b,N)&&(e+="\n"+f);e+="<"+b;var g="";a.each(this.attributes,function(){g+=" "+this.name+'="'+this.value+'"'});e+=g+">";if(0>a.inArray(b,W)||0<this.childNodes.length){var h=!1;a(this).contents().each(function(){this.nodeType==Node.ELEMENT_NODE&&0<=a.inArray(this.nodeName.toLowerCase(),
N)&&(h=!0);e+=X(a(this),d+1)});h&&(e+="\n"+f);e+="</"+b+">"}0<=a.inArray(b,N)&&(e+="\n")}});return e},ma=function(b){b=b.replace(/[\r\n]+/g,"").replace(/<(caption|th|td)>&nbsp;/g,"<$1>");a.each(N,function(a,d){b=b.replace(new RegExp("(\\<br\\>)+\\<\\/"+d+"\\>","g"),"</"+d+">")});a.each(la,function(a,d){b=b.replace(new RegExp("\\<"+d+"\\>\\s*\\<\\/"+d+"\\>","g"),"")});b=a("<div>",{html:b});return X(b.contents()).replace(/>[\t ]+</g,"> <").replace(/>[\r\t\n]+( *)</g,">\n$1<").replace(/<p><\/p>/g,"<br>").replace(/(<br>\s*)+$/,
"").replace(/^\s*$(?:\r\n?|\n)/gm,"").replace(/\s+$/gm,"").replace(/\s+<\/(caption|th|td)>/g,"</$1>")},ta=function(b){var d=b.editor.config.parserRules.type_definitions,e=a("<div>");e.append(b.editor.getValue());e.find("span[style]").each(function(b){b=r(a(this).attr("style"));if(1<Object.keys(b).length){var d="",e="";a.each(b,function(a,b){d+='<span style="'+a+": "+b+';">';e+="</span>"});a(this).replaceWith(d+a(this).html()+e)}});e.find("p[style*='margin-left']").each(function(b){b=a(this).getStylePropertyValue("margin-left");
if(/em$/.test(b)){b=parseFloat(b.replace(/em$/,""))/1.5;for(var d="",e="",f=0;f<b;f++)d+="<blockquote>",e+="</blockquote>";a(this).replaceWith(d+a(this).html()+e)}});e.find("[style]").each(function(e){!1!==(e=a(this).getStylePropertyValue("background-color"))&&(e=b.palette.hexToName(e),d.text_hilite_object.classes["wysiwyg-hilite-color-"+e]&&(a(this).removeStyleProperty("background-color"),a(this).addClass("wysiwyg-hilite-color-"+e)));!1!==(e=a(this).getStylePropertyValue("color"))&&(e=b.palette.hexToName(e),
d.text_color_object.classes["wysiwyg-color-"+e]&&(a(this).removeStyleProperty("color"),a(this).addClass("wysiwyg-color-"+e)));!1!==(e=a(this).getStylePropertyValue("text-align"))&&"justify"==e&&d.alignment_object.classes["wysiwyg-text-align-"+e]&&(a(this).removeStyleProperty("text-align"),a(this).addClass("wysiwyg-text-align-"+e));!1!==(e=a(this).getStylePropertyValue("float"))&&a(this).hasStyleProperty("margin")&&d.alignment_object.classes["wysiwyg-float-"+e]&&(a(this).removeStyleProperty("float"),
a(this).removeStyleProperty("margin"),a(this).addClass("wysiwyg-float-"+e));!1!==(e=a(this).getStylePropertyValue("clear"))&&(a(this).removeStyleProperty("clear"),a(this).addClass("wysiwyg-clear-"+e));!1!==(e=a(this).getStylePropertyValue("font-family"))&&(e=e.replace(/^['"]/,"").replace(/['"].+$/,""),e=b.fonts.getName(e),a(this).css("font-family",e));!1!==(e=a(this).getStylePropertyValue("font-size"))&&d.text_fontsize_object.classes["wysiwyg-font-size-"+e]&&(a(this).removeStyleProperty("font-size"),
a(this).addClass("wysiwyg-font-size-"+e))});b.editor.setValue(e.html())},ua=function(b){var d=a("<div>");d.append(b.editor.getValue());d.find("[class*=wysiwyg-color-]").each(function(d){var e=a(this);d=e.attr("class").split(/\s+/);a.each(d,function(a,d){if(a=d.match(/wysiwyg-color-(.+)$/))a=b.palette.nameToHex(a[1]),e.css("color",a),e.removeClass(d)})});d.find("[class*=wysiwyg-hilite-color-]").each(function(d){var e=a(this);d=e.attr("class").split(/\s+/);a.each(d,function(a,d){if(a=d.match(/wysiwyg-hilite-color-(.+)$/))a=
b.palette.nameToHex(a[1]),e.css("background-color",a),e.removeClass(d)})});d.find("[class*=wysiwyg-text-align-]").each(function(b){var d=a(this);b=d.attr("class").split(/\s+/);a.each(b,function(a,b){if(a=b.match(/wysiwyg-text-align-(.+)$/))d.css("text-align",a[1]),d.removeClass(b)})});d.find("[class*=wysiwyg-float-]").each(function(b){var d=a(this);b=d.attr("class").split(/\s+/);a.each(b,function(a,b){if(a=b.match(/wysiwyg-float-(.+)$/))"right"==a[1]?d.css({"float":"right",margin:"0 0 8px 8px"}):
d.css({"float":"left",margin:"0 8px 8px 0"}),d.removeClass(b)})});d.find("[class*=wysiwyg-clear-]").each(function(b){var d=a(this);b=d.attr("class").split(/\s+/);a.each(b,function(a,b){if(a=b.match(/wysiwyg-clear-(.+)$/))d.css("clear",a[1]),d.removeClass(b)})});d.find("[class*=wysiwyg-font-name-]").each(function(d){var e=a(this);d=e.attr("class").split(/\s+/);a.each(d,function(a,d){if(a=d.match(/wysiwyg-font-name-(.+)$/))a=b.fonts.getFamily(a[1]),e.css("font-family",a),e.removeClass(d)})});d.find("[style*='font-family:']").each(function(d){var e=
a(this);d=e.attr("style").split(/\s*;\s*/);a.each(d,function(a,d){if(a=d.match(/font-family:\s*(.+)$/))a=b.fonts.getFamily(a[1]),e.css("font-family",a)})});d.find("[class*=wysiwyg-font-size-]").each(function(b){var d=a(this);b=d.attr("class").split(/\s+/);a.each(b,function(a,b){if(a=b.match(/wysiwyg-font-size-(.+)$/))d.css("font-size",a[1]),d.removeClass(b)})});for(var e=d.find("blockquote");e.length;)e.each(function(b){b={depth:0,attributes:[],html:""};P(b,a(this));J(a(this),"blockquote",b);var d=
1.5*b.depth+"em";b=a("<p>").css("margin-left",d).append(b.html);a(this).replaceWith(b);return!1}),e=d.find("blockquote");for(e=d.find("span");e.length;)e.each(function(b){b={depth:0,attributes:[],html:""};P(b,a(this));J(a(this),"span",b);M(b);b=a("<var>").addClass("temporary-var").attr(b.attributes).append(b.html);a(this).replaceWith(b);return!1}),e=d.find("span");G("var.temporary-var","span",d);d.find(".temporary-var").removeAttr("class");return d.html().replace(/ class=""/g,"")},ea=function(){a(".modal").find(".modal-dialog").each(function(b){a(this).css({position:"absolute",
top:function(){return(a(window).height()-a(this).outerHeight(!0))/2+"px"},left:function(){return(a(window).width()-a(this).outerWidth(!0))/2+"px"}})})},va=function(a,b,d,e,f){f=f||function(){return!1};a.modal.find(".modal-title").text(b);"string"===typeof d?a.modal.find(".modal-body .body-content").html(d):a.modal.find(".modal-body .body-content").append(d.show());a.modal.find(".alert").hide();a.modal.find(".modal-ok, .modal-cancel").off("click");a.modal.find(".modal-cancel").on("click",function(b){e(!1);
a.modal.find(".modal-body .body-content").empty()});a.modal.find(".modal-ok").on("click",function(b){(b=f())?a.modal.find(".alert").addClass("alert-danger").text(b).show():(e(!0),a.modal.find(".modal-body .body-content").empty(),a.modal.modal("hide"))});a.modal.modal("show")};a("body").on("shown.bs.modal",ea);a(window).on("resize",function(){a(".modal:visible").each(ea)});b.prototype.VERSION="1.0.0";b.prototype.config=function(){return this.editor.config};b.prototype.namedColorToHex=function(a){return this.palette.nameToHex(a)};
b.prototype.hexColorToName=function(a){return this.palette.hexToName(a)};b.prototype.getFontName=function(a){return this.fonts.getName(a)};b.prototype.getFontLabel=function(a){return this.fonts.getLabel(a)};b.prototype.getFontFamily=function(a){return this.fonts.getFamily(a)};b.prototype.cleanUp=function(a){this.editor.cleanUp(a)};b.prototype.disable=function(){this.editor.disable()};b.prototype.enable=function(){this.editor.enable()};b.prototype.focus=function(){this.editor.focus()};b.prototype.getValue=
function(a){return this.editor.getValue("undefined"==typeof a?!0:a)};b.prototype.getHTML=function(a){a="undefined"==typeof a?!1:a;var b=ua(this);a&&(b=ma(b));return b};b.prototype.hasPlaceholderSet=function(){return this.editor.hasPlaceholderSet()};b.prototype.isCompatible=function(){return this.editor.isCompatible()};b.prototype.setValue=function(a,b){this.editor.setValue(a,b||!0)};b.prototype.destroy=function(){this.editor.destroy()};var na=a.fn.wysihtml;a.fn.wysihtml=function(d){if("string"==typeof d&&
1==a(this).length){var e=a(this).eq(0).data("bs.wysihtml");if(e)return"function"==typeof e[d]?e[d].apply(e,Array.prototype.slice.call(arguments,1)):e[d]}else return this.each(function(){var e=a(this),f=e.data("bs.wysihtml"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof d&&d);f||e.data("bs.wysihtml",f=new b(this,g));"string"==typeof d&&"function"==typeof f[d]&&f[d].apply(f,Array.prototype.slice.call(arguments,1))})};a.fn.wysihtml.Constructor=b;a.fn.wysihtml.noConflict=function(){a.fn.wysihtml=
na;return this}});wysihtml.commands.fontName=function(){var a=/wysiwyg-font-name-[0-9a-z\-]+/g;return{exec:function(e,b,g){wysihtml.commands.formatInline.exec(e,b,{className:"wysiwyg-font-name-"+g,classRegExp:a,toggle:!0})},state:function(a,b,g){return wysihtml.commands.formatInline.state(a,b,{className:"wysiwyg-font-name-"+g})}}}();
wysihtml.commands.fontNameStyle=function(){return{exec:function(a,e,b){/^\s*$/.test(b)||wysihtml.commands.formatInline.exec(a,e,{styleProperty:"font-family",styleValue:b,toggle:!1})},state:function(a,e,b){return wysihtml.commands.formatInline.state(a,e,{styleProperty:"font-family",styleValue:b||void 0})},remove:function(a,e){return wysihtml.commands.formatInline.remove(a,e,{styleProperty:"font-family"})},stateValue:function(a,e){(a=this.state(a,e))&&wysihtml.lang.object(a).isArray()&&(a=a[0]);return a&&
(a=a.getAttribute("style"))&&(a=stylesStr.match(/(^|\s|;)font-family\s*:\s*[^;$]+/gi))?(a=a[a.length-1].split(":")[1],a=a.replace(/^\s+/,"").replace(/\s+$/,"")):!1}}}();wysihtml.commands.hiliteColor=function(){var a=/wysiwyg-hilite-color-[0-9a-z]+/g;return{exec:function(e,b,g){wysihtml.commands.formatInline.exec(e,b,{className:"wysiwyg-hilite-color-"+g,classRegExp:a,toggle:!0})},state:function(a,b,g){return wysihtml.commands.formatInline.state(a,b,{className:"wysiwyg-hilite-color-"+g})}}}();
(function(a){a.fn.visible=function(e,b){if(1>this.length)return!1;b=b||a(this).parents("body");b.offset();b.offset();var g=b.outerWidth(),h=b.outerHeight(),f=a(this).get(0);b=f.offsetWidth*f.offsetHeight;f=f.getBoundingClientRect();var d=0<=f.top&&f.top<h,k=0<f.bottom&&f.bottom<=h,l=0<=f.left&&f.left<g,n=0<f.right&&f.right<=g;h=0>f.top&&f.bottom>h?!0:e?d||k:d&&k;e=0>f.left&&f.right>g?!0:e?l||n:l&&n;return b&&h&&e};a.fn.hasStyleProperty=function(e){var b=a(this).attr("style"),g=new RegExp("\\b"+e+
"\\s*:\\s*[^;]+;");return b&&e&&g.test(b)};a.fn.hasStylePropertyValue=function(e,b){var g=a(this).attr("style"),h=new RegExp("\\b"+e+"\\s*:\\s*"+b+"\\s*;");return g&&e&&b&&h.test(g)};a.fn.getStylePropertyValue=function(e){return(e=a(this).attr("style").match(new RegExp("\\b"+e+"\\s*:\\s*([^;]+);")))?a.trim(e[1]):!1};a.fn.removeStyleProperty=function(){for(var e=0;e<arguments.length;e++)a(this).css(arguments[e],"");(e=a(this).attr("style"))&&""==e&&a(this).removeAttr("style")}})(jQuery);
